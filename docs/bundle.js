!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var o=n(2),i=n(3);function c(e,t){return t.encode?t.strict?o(e):encodeURIComponent(e):e}t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,o){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===o[e]&&(o[e]={}),o[e][t[1]]=n):o[e]=n};case"bracket":return function(e,n,o){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==o[e]?o[e]=[].concat(o[e],n):o[e]=[n]:o[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=i({arrayFormat:"none"},t)),o=Object.create(null);return"string"!=typeof e?o:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),c=t.length>0?t.join("="):void 0;c=void 0===c?null:decodeURIComponent(c),n(decodeURIComponent(i),c,o)})),Object.keys(o).sort().reduce((function(e,t){var n=o[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))):o},t.stringify=function(e,t){var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,o){return null===n?[c(t,e),"[",o,"]"].join(""):[c(t,e),"[",c(o,e),"]=",c(n,e)].join("")};case"bracket":return function(t,n){return null===n?c(t,e):[c(t,e),"[]=",c(n,e)].join("")};default:return function(t,n){return null===n?c(t,e):[c(t,e),"=",c(n,e)].join("")}}}(t=i({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(o){var i=e[o];if(void 0===i)return"";if(null===i)return c(o,t);if(Array.isArray(i)){var r=[];return i.slice().forEach((function(e){void 0!==e&&r.push(n(o,e,r.length))})),r.join("&")}return c(o,t)+"="+c(i,t)})).filter((function(e){return e.length>0})).join("&"):""}},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(e){o[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,a=r(e),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))i.call(n,u)&&(a[u]=n[u]);if(o){s=o(n);for(var f=0;f<s.length;f++)c.call(n,s[f])&&(a[s[f]]=n[s[f]])}}return a}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";function o(){}n.r(t);function i(e,t,n,o,i){e.__svelte_meta={loc:{file:t,line:n,column:o,char:i}}}function c(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(c)}function a(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(e,t){if(!e||"function"!=typeof e.subscribe)throw new Error(`'${t}' is not a store with a 'subscribe' method`)}function f(e,t){const n=e.subscribe(t);return n.unsubscribe?()=>n.unsubscribe():n}function d(e,t,n){e.$$.on_destroy.push(f(t,n))}new Set;function p(e,t,n){e.insertBefore(t,n||null)}function m(e){e.parentNode.removeChild(e)}function h(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function v(e){return document.createTextNode(e)}function b(){return v(" ")}function $(){return v("")}function w(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e,t){(null!=t||e.value)&&(e.value=t)}function k(e,t,n){e.classList[n?"add":"remove"](t)}function S(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}let C;function x(e){C=e}function R(){if(!C)throw new Error("Function called outside component initialization");return C}function O(e){R().$$.on_mount.push(e)}function j(){const e=R();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const i=S(t,n);o.slice().forEach(t=>{t.call(e,i)})}}}const _=[],E=[],D=[],M=[],A=Promise.resolve();let B=!1;function N(){B||(B=!0,A.then(L))}function P(e){D.push(e)}function L(){const e=new Set;do{for(;_.length;){const e=_.shift();x(e),U(e.$$)}for(;E.length;)E.pop()();for(let t=0;t<D.length;t+=1){const n=D[t];e.has(n)||(n(),e.add(n))}D.length=0}while(_.length);for(;M.length;)M.pop()();B=!1}function U(e){null!==e.fragment&&(e.update(),s(e.before_update),e.fragment&&e.fragment.p(e.ctx,e.dirty),e.dirty=[-1],e.after_update.forEach(P))}const I=new Set;let T;function q(){T={r:0,c:[],p:T}}function F(){T.r||s(T.c),T=T.p}function J(e,t){e&&e.i&&(I.delete(e),e.i(t))}function V(e,t,n,o){if(e&&e.o){if(I.has(e))return;I.add(e),T.c.push(()=>{I.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}const H="undefined"!=typeof window?window:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let z;function W(e){e&&e.c()}function G(e,t,n){const{fragment:o,on_mount:i,on_destroy:r,after_update:l}=e.$$;o&&o.m(t,n),P(()=>{const t=i.map(c).filter(a);r?r.push(...t):s(t),e.$$.on_mount=[]}),l.forEach(P)}function K(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(e,t,n,i,c,a,l=[-1]){const u=C;x(e);const f=t.props||{},d=e.$$={fragment:null,ctx:null,props:a,update:o,not_equal:c,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:r(),dirty:l};let p=!1;var m;d.ctx=n?n(e,f,(t,n,o=n)=>(d.ctx&&c(d.ctx[t],d.ctx[t]=o)&&(d.bound[t]&&d.bound[t](o),p&&function(e,t){-1===e.$$.dirty[0]&&(_.push(e),N(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n)):[],d.update(),p=!0,s(d.before_update),d.fragment=!!i&&i(d.ctx),t.target&&(t.hydrate?d.fragment&&d.fragment.l((m=t.target,Array.from(m.childNodes))):d.fragment&&d.fragment.c(),t.intro&&J(e.$$.fragment),G(e,t.target,t.anchor),L()),x(u)}"function"==typeof HTMLElement&&(z=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){K(this,1),this.$destroy=o}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}});class X{$destroy(){K(this,1),this.$destroy=o}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function Y(e,t){document.dispatchEvent(S(e,t))}function Z(e,t){Y("SvelteDOMInsert",{target:e,node:t}),function(e,t){e.appendChild(t)}(e,t)}function ee(e,t,n){Y("SvelteDOMInsert",{target:e,node:t,anchor:n}),p(e,t,n)}function te(e){Y("SvelteDOMRemove",{node:e}),m(e)}function ne(e,t,n,o,i,c){const r=!0===o?["capture"]:o?Array.from(Object.keys(o)):[];i&&r.push("preventDefault"),c&&r.push("stopPropagation"),Y("SvelteDOMAddEventListener",{node:e,event:t,handler:n,modifiers:r});const s=function(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}(e,t,n,o);return()=>{Y("SvelteDOMRemoveEventListener",{node:e,event:t,handler:n,modifiers:r}),s()}}function oe(e,t,n){w(e,t,n),null==n?Y("SvelteDOMRemoveAttribute",{node:e,attribute:t}):Y("SvelteDOMSetAttribute",{node:e,attribute:t,value:n})}function ie(e,t){t=""+t,e.data!==t&&(Y("SvelteDOMSetData",{node:e,data:t}),e.data=t)}class ce extends X{constructor(e){if(!e||!e.target&&!e.$$inline)throw new Error("'target' is a required option");super()}$destroy(){super.$destroy(),this.$destroy=()=>{console.warn("Component was already destroyed")}}}const re=[];function se(e,t=o){let n;const i=[];function c(t){if(l(e,t)&&(e=t,n)){const t=!re.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),re.push(n,e)}if(t){for(let e=0;e<re.length;e+=2)re[e][0](re[e+1]);re.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(r,s=o){const a=[r,s];return i.push(a),1===i.length&&(n=t(c)||o),r(e),()=>{const e=i.indexOf(a);-1!==e&&i.splice(e,1),0===i.length&&(n(),n=null)}}}}function ae(e,t,n){const i=!Array.isArray(e),c=i?[e]:e,r=t.length<2;return{subscribe:se(n,e=>{let n=!1;const l=[];let u=0,f=o;const d=()=>{if(u)return;f();const n=t(i?l[0]:l,e);r?e(n):f=a(n)?n:o},p=c.map((e,t)=>e.subscribe(e=>{l[t]=e,u&=~(1<<t),n&&d()},()=>{u|=1<<t}));return n=!0,d(),function(){s(p),f()}}).subscribe}}var le=n(0),ue=n.n(le);const fe=se([]),de=e=>{try{return!0===JSON.parse(e)}catch{return!1}},pe=se((()=>{const e=ue.a.parse(location.search),t={role:e.role||"both",stream:e.stream||"both",manual:de(e.manual),remote:de(e.remote),hideDetails:de(e.hideDetails)};return Object.entries(t).map(([e,t])=>({key:e,value:t}))})()),me=ae(pe,e=>`${window.location.protocol}//${window.location.host}/?${ue.a.stringify(Object.fromEntries(e.map(({key:e,value:t})=>[e,t])))}`),he=ae(pe,e=>{const t=Object.fromEntries(e.map(({key:e,value:t})=>[e,t]));let{role:n,stream:o,manual:i,remote:c,hideDetails:r}=t;const s="recv"!==n,a="call"!==n&&"send"!==n||!1,l="down"!==o||!1,u="up"!==o||!1,f=i&&"no"!==i||!1,d=c&&"no"!==c||!1,p=s?"bob":"alice",m=a?"bob":"alice";return{...t,role:n,stream:o,manual:i,remote:c,hasCaller:s,hasReceiver:a,hasUpstream:l,hasDownstream:u,isManual:f,isRemote:d,hideDetails:r,to:p,from:m}}),ge=se({});const ve=e=>(t,n)=>(function(e,t,n){const o={name:e,short:t,event:n};fe.update(e=>[...e,o]),ge.update(n=>({...n,[e]:[...n[e]||[],t]}))})(e,t,n),be=se({}),$e=se({}),we=se({});function ye({from:e,offer:t}){be.update(n=>({...n,[e]:t}))}function ke({from:e,answer:t}){$e.update(n=>({...n,[e]:t}))}function Se({from:e,candidate:t}){we.update(n=>{const o=n[e]||[];return{...n,[e]:[...o,t]}})}function Ce({from:e}){we.update(t=>({...t,[e]:[]}))}n(4);const xe="src/Config.svelte";function Re(e,t,n){const o=e.slice();return o[6]=t[n].key,o[7]=t[n].value,o[8]=t,o[9]=n,o}function Oe(e){let t,n;function o(){e[5].call(t,e[7],e[8],e[9])}const c={c:function(){t=g("input"),oe(t,"type","text"),i(t,xe,33,12,774),n=ne(t,"input",o)},m:function(n,o){ee(n,t,o),y(t,e[7])},p:function(n,o){e=n,2&o&&t.value!==e[7]&&y(t,e[7])},d:function(e){e&&te(t),n()}};return Y("SvelteRegisterBlock",{block:c,id:Oe.name,type:"else",source:"(33:12) {:else}",ctx:e}),c}function je(e){let t,n;function o(){e[4].call(t,e[7],e[8],e[9])}const c={c:function(){t=g("input"),oe(t,"type","checkbox"),i(t,xe,31,12,696),n=ne(t,"change",o)},m:function(n,o){ee(n,t,o),t.checked=e[7]},p:function(n,o){e=n,2&o&&(t.checked=e[7])},d:function(e){e&&te(t),n()}};return Y("SvelteRegisterBlock",{block:c,id:je.name,type:"if",source:"(31:12) {#if typeof value === 'boolean'}",ctx:e}),c}function _e(e){let t,n,o,c,r,s,a=e[6]+"";function l(e,t){return"boolean"==typeof e[7]?je:Oe}let u=l(e),f=u(e);const d={c:function(){t=g("tr"),n=g("td"),o=v(a),c=b(),r=g("td"),f.c(),s=b(),i(n,xe,28,12,607),i(r,xe,29,12,634),i(t,xe,27,8,590)},m:function(e,i){ee(e,t,i),Z(t,n),Z(n,o),Z(t,c),Z(t,r),f.m(r,null),Z(t,s)},p:function(e,t){2&t&&a!==(a=e[6]+"")&&ie(o,a),u===(u=l(e))&&f?f.p(e,t):(f.d(1),f=u(e),f&&(f.c(),f.m(r,null)))},d:function(e){e&&te(t),f.d()}};return Y("SvelteRegisterBlock",{block:d,id:_e.name,type:"each",source:"(27:4) {#each $query as {key, value}",ctx:e}),d}function Ee(e){let t,n,c,r,s,a,l,u,f,d=e[1],p=[];for(let t=0;t<d.length;t+=1)p[t]=_e(Re(e,d,t));const m={c:function(){t=g("details"),n=g("summary"),n.textContent="config",c=b(),r=g("code"),s=g("pre"),a=g("a"),l=v(e[0]),u=b(),f=g("table");for(let e=0;e<p.length;e+=1)p[e].c();i(n,xe,20,4,428),oe(a,"href",e[0]),i(a,xe,22,4,474),i(s,xe,21,10,464),oe(r,"class","svelte-12ii7jf"),i(r,xe,21,4,458),i(f,xe,25,4,536),i(t,xe,19,0,414)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){ee(e,t,o),Z(t,n),Z(t,c),Z(t,r),Z(r,s),Z(s,a),Z(a,l),Z(t,u),Z(t,f);for(let e=0;e<p.length;e+=1)p[e].m(f,null)},p:function(e,[t]){if(1&t&&ie(l,e[0]),1&t&&oe(a,"href",e[0]),2&t){let n;for(d=e[1],n=0;n<d.length;n+=1){const o=Re(e,d,n);p[n]?p[n].p(o,t):(p[n]=_e(o),p[n].c(),p[n].m(f,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=d.length}},i:o,o:o,d:function(e){e&&te(t),h(p,e)}};return Y("SvelteRegisterBlock",{block:m,id:Ee.name,type:"component",source:"",ctx:e}),m}function De(e,t,n){let o,i;u(me,"configUrl"),d(e,me,e=>n(0,o=e)),u(pe,"query"),d(e,pe,e=>n(1,i=e));return e.$capture_state=()=>({}),e.$inject_state=e=>{"$configUrl"in e&&me.set(o=e.$configUrl),"$query"in e&&pe.set(i=e.$query)},[o,i,e=>{try{return"boolean"===JSON.parse(e)}catch{return!1}},({target:{value:e,name:t}})=>{he.update(n=>({...n,[t]:"on"===e}))},function(e,t,n){t[n].value=this.checked,pe.set(i)},function(e,t,n){t[n].value=this.value,pe.set(i)}]}var Me=class extends ce{constructor(e){super(e),Q(this,e,De,Ee,l,{}),Y("SvelteRegisterComponent",{component:this,tagName:"Config",options:e,id:Ee.name})}};class Ae{constructor({to:e,from:t}){this.to=e,this.from=t}connect({url:e}){this.url=e;const t=new WebSocket(e);t.onopen=()=>{this.socket=t,this.socket.onmessage=this.received.bind(this)}}received({data:e}){const t=JSON.parse(e),{[this.to]:n,type:o}=t;console.debug("its for me!",n);const i=this.to;switch(o){case"offer":ye({from:i,offer:n});break;case"answer":ke({from:i,answer:n});break;case"candidate":Se({from:i,candidate:new RTCIceCandidate(n)})}}sendOffer(e){if(e){const t={[this.from]:e,type:"offer"};this.send(t)}}sendAnswer(e){if(e){const t={[this.from]:e,type:"answer"};this.send(t)}}sendCandidate(e){if(e){const t={[this.from]:e,type:"candidate"};this.send(t)}}send(e){if(this.socket){const t=JSON.stringify(e);this.socket.send(t)}}toString(){return`[Signaling Server calling ${this.from} â†’ ${this.to}]`}}const Be=e=>"string"==typeof e?JSON.parse(e).sdp:"object"==typeof e?e.sdp:void 0,Ne=e=>{try{return JSON.parse(e)}catch(t){return""!==e&&console.warn({parseError:t}),[]}},Pe=e=>({type:"offer",sdp:e}),Le=e=>({type:"answer",sdp:e});n(5);const Ue="src/Upstream.svelte";function Ie(e){let t,n,c,r,a,l,u,f,d,p,m,h,$,w,y,k;const S={c:function(){t=g("label"),t.textContent="upstream",n=b(),c=g("video"),r=b(),a=g("nav"),l=g("button"),l.textContent="start upstream",u=b(),f=g("span"),d=g("label"),p=g("input"),m=v("\n            webcam"),h=b(),$=g("label"),w=g("input"),y=v("\n            noise"),oe(t,"for","upstream"),i(t,Ue,50,0,1442),oe(c,"id","upstream"),c.autoplay="true",oe(c,"width","400"),oe(c,"height","300"),oe(c,"class","svelte-v4j238"),i(c,Ue,51,0,1481),i(l,Ue,54,4,1583),oe(p,"type","radio"),p.__value=Te,p.value=p.__value,e[6][0].push(p),i(p,Ue,57,12,1679),i(d,Ue,56,8,1659),oe(w,"type","radio"),w.__value=qe,w.value=w.__value,e[6][0].push(w),i(w,Ue,62,12,1817),i($,Ue,61,8,1797),i(f,Ue,55,4,1644),oe(a,"class","svelte-v4j238"),i(a,Ue,52,0,1572),k=[ne(l,"click",e[2],!1,!1,!1),ne(p,"change",e[5]),ne(w,"change",e[7])]},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,i){ee(o,t,i),ee(o,n,i),ee(o,c,i),e[4](c),ee(o,r,i),ee(o,a,i),Z(a,l),Z(a,u),Z(a,f),Z(f,d),Z(d,p),p.checked=p.__value===e[0],Z(d,m),Z(f,h),Z(f,$),Z($,w),w.checked=w.__value===e[0],Z($,y)},p:function(e,[t]){1&t&&(p.checked=p.__value===e[0]),1&t&&(w.checked=w.__value===e[0])},i:o,o:o,d:function(o){o&&te(t),o&&te(n),o&&te(c),e[4](null),o&&te(r),o&&te(a),e[6][0].splice(e[6][0].indexOf(p),1),e[6][0].splice(e[6][0].indexOf(w),1),s(k)}};return Y("SvelteRegisterBlock",{block:S,id:Ie.name,type:"component",source:"",ctx:e}),S}async function Te(){return await navigator.mediaDevices.getUserMedia({video:!0})}function qe(){let e=Object.assign(document.createElement("canvas"),{width:400,height:300}),t=e.getContext("2d");t.fillRect(0,0,e.width,e.height);let n=t.getImageData(0,0,e.width,e.height);return requestAnimationFrame((function e(){for(var o=0;o<n.data.length;o++)n.data[o++]=n.data[o++]=n.data[o++]=255*Math.random();t.putImageData(n,0,0),requestAnimationFrame(e)})),e.captureStream(60)}function Fe(e,t,n){const o=j();let i,c=Te;O(()=>{});return e.$capture_state=()=>({}),e.$inject_state=e=>{"upstreamSource"in e&&n(0,c=e.upstreamSource),"upstreamVideo"in e&&n(1,i=e.upstreamVideo)},[c,i,async function(){const e=await c();console.debug({stream:e}),n(1,i.srcObject=e,i),o("stream",e)},o,function(e){E[e?"unshift":"push"](()=>{n(1,i=e)})},function(){c=this.__value,n(0,c)},[[]],function(){c=this.__value,n(0,c)}]}var Je=class extends ce{constructor(e){super(e),Q(this,e,Fe,Ie,l,{}),Y("SvelteRegisterComponent",{component:this,tagName:"Upstream",options:e,id:Ie.name})}};const Ve="src/RemoteBar.svelte";function He(e){let t,n,c,r,a,l;const u={c:function(){var o;t=g("form"),n=g("input"),c=b(),r=g("code"),a=v(e[0]),oe(n,"size","90"),oe(n,"placeholder","ws url"),i(n,Ve,18,4,498),i(t,Ve,17,0,451),i(r,Ve,21,0,576),l=[ne(n,"input",e[2]),ne(t,"submit",(o=ze,function(e){return e.preventDefault(),o.call(this,e)}),!1,!0,!1)]},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,i){ee(o,t,i),Z(t,n),y(n,e[1]),ee(o,c,i),ee(o,r,i),Z(r,a)},p:function(e,[t]){2&t&&n.value!==e[1]&&y(n,e[1]),1&t&&ie(a,e[0])},i:o,o:o,d:function(e){e&&te(t),e&&te(c),e&&te(r),s(l)}};return Y("SvelteRegisterBlock",{block:u,id:He.name,type:"component",source:"",ctx:e}),u}function ze(){}function We(e,t,n){let{signalingClient:o}=t;const i=["signalingClient"];let c;return Object.keys(t).forEach(e=>{~i.indexOf(e)||"$$"===e.slice(0,2)||console.warn(`<RemoteBar> was created with unknown prop '${e}'`)}),e.$set=e=>{"signalingClient"in e&&n(0,o=e.signalingClient)},e.$capture_state=()=>({signalingClient:o,signalingServer:c}),e.$inject_state=e=>{"signalingClient"in e&&n(0,o=e.signalingClient),"signalingServer"in e&&n(1,c=e.signalingServer)},e.$$.update=()=>{3&e.$$.dirty&&(o.connect({url:c}),window.client=o)},n(1,c=`wss://${window.location.host}/signaling/test`),[o,c,function(){c=this.value,n(1,c)}]}var Ge=class extends ce{constructor(e){super(e),Q(this,e,We,He,l,{signalingClient:0}),Y("SvelteRegisterComponent",{component:this,tagName:"RemoteBar",options:e,id:He.name});const{ctx:t}=this.$$,n=e.props||{};void 0!==t[0]||"signalingClient"in n||console.warn("<RemoteBar> was created without expected prop 'signalingClient'")}get signalingClient(){throw new Error("<RemoteBar>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set signalingClient(e){throw new Error("<RemoteBar>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};n(6);const{console:Ke}=H,Qe="src/Participant.svelte";function Xe(e){let t;const n=new Ge({props:{signalingClient:e[20]},$$inline:!0}),i={c:function(){W(n.$$.fragment)},m:function(e,o){G(n,e,o),t=!0},p:o,i:function(e){t||(J(n.$$.fragment,e),t=!0)},o:function(e){V(n.$$.fragment,e),t=!1},d:function(e){K(n,e)}};return Y("SvelteRegisterBlock",{block:i,id:Xe.name,type:"if",source:"(274:4) {#if $config.isRemote}",ctx:e}),i}function Ye(e){let t,n;const c=new Je({$$inline:!0});c.$on("stream",e[42]);const r={c:function(){t=g("div"),W(c.$$.fragment),oe(t,"id","upstream"),oe(t,"class","svelte-2kh684"),i(t,Qe,280,12,8288)},m:function(e,o){ee(e,t,o),G(c,t,null),n=!0},p:o,i:function(e){n||(J(c.$$.fragment,e),n=!0)},o:function(e){V(c.$$.fragment,e),n=!1},d:function(e){e&&te(t),K(c)}};return Y("SvelteRegisterBlock",{block:r,id:Ye.name,type:"if",source:"(280:8) {#if $config.hasUpstream}",ctx:e}),r}function Ze(e){let t,n,c,r;const s={c:function(){t=g("div"),n=g("label"),n.textContent="downstream",c=b(),r=g("video"),oe(n,"for","downstream"),i(n,Qe,287,16,8511),r.autoplay="true",oe(r,"width","400"),oe(r,"height","300"),oe(r,"class","svelte-2kh684"),i(r,Qe,288,16,8570),oe(t,"id","downstream"),oe(t,"class","svelte-2kh684"),i(t,Qe,286,12,8473)},m:function(o,i){ee(o,t,i),Z(t,n),Z(t,c),Z(t,r),e[43](r)},p:o,d:function(n){n&&te(t),e[43](null)}};return Y("SvelteRegisterBlock",{block:s,id:Ze.name,type:"if",source:"(286:8) {#if $config.hasDownstream}",ctx:e}),s}function et(e){let t,n,o=e[13].join(",")+"";const c={c:function(){t=g("small"),n=v(o),i(t,Qe,298,12,8966)},m:function(e,o){ee(e,t,o),Z(t,n)},p:function(e,t){8192&t[0]&&o!==(o=e[13].join(",")+"")&&ie(n,o)},d:function(e){e&&te(t)}};return Y("SvelteRegisterBlock",{block:c,id:et.name,type:"if",source:"(298:12) {#if !hideDetails}",ctx:e}),c}function tt(e){let t,n,o,c,r,s,a,l,u=e[8]&&nt(e),f=e[15]&&!e[18].isManual&&ot(e),d=e[18].isManual&&it(e);const p={c:function(){t=g("label"),n=v("1. "),o=g("button"),o.textContent="create offer",c=b(),u&&u.c(),r=b(),f&&f.c(),s=b(),d&&d.c(),a=$(),i(o,Qe,310,27,9467),i(t,Qe,310,16,9456),l=ne(o,"click",e[22],!1,!1,!1)},m:function(e,i){ee(e,t,i),Z(t,n),Z(t,o),ee(e,c,i),u&&u.m(e,i),ee(e,r,i),f&&f.m(e,i),ee(e,s,i),d&&d.m(e,i),ee(e,a,i)},p:function(e,t){e[8]?u?u.p(e,t):(u=nt(e),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null),e[15]&&!e[18].isManual?f?f.p(e,t):(f=ot(e),f.c(),f.m(s.parentNode,s)):f&&(f.d(1),f=null),e[18].isManual?d?d.p(e,t):(d=it(e),d.c(),d.m(a.parentNode,a)):d&&(d.d(1),d=null)},d:function(e){e&&te(t),e&&te(c),u&&u.d(e),e&&te(r),f&&f.d(e),e&&te(s),d&&d.d(e),e&&te(a),l()}};return Y("SvelteRegisterBlock",{block:p,id:tt.name,type:"if",source:"(310:12) {#if isCaller}",ctx:e}),p}function nt(e){let t,n,o,c,r,a,l,u,f,d,p;const m={c:function(){t=g("div"),n=g("textarea"),o=b(),c=g("br"),r=b(),a=g("label"),l=v("2.\n                            "),u=g("button"),u.textContent="setLocalDescription",f=b(),d=g("button"),d.textContent="send offer",oe(n,"cols","60"),oe(n,"rows","20"),oe(n,"class","svelte-2kh684"),k(n,"hideDetails",e[19]),i(n,Qe,314,24,9616),i(c,Qe,315,24,9718),i(u,Qe,318,28,9816),i(d,Qe,319,28,9935),i(a,Qe,316,24,9749),i(t,Qe,313,20,9586),p=[ne(n,"input",e[47]),ne(u,"click",e[48],!1,!1,!1),ne(d,"click",e[24],!1,!1,!1)]},m:function(i,s){ee(i,t,s),Z(t,n),y(n,e[8]),Z(t,o),Z(t,c),Z(t,r),Z(t,a),Z(a,l),Z(a,u),Z(a,f),Z(a,d)},p:function(e,t){256&t[0]&&y(n,e[8]),524288&t[0]&&k(n,"hideDetails",e[19])},d:function(e){e&&te(t),s(p)}};return Y("SvelteRegisterBlock",{block:m,id:nt.name,type:"if",source:"(313:16) {#if localOfferSdp}",ctx:e}),m}function ot(e){let t,n,o,c,r,a,l,u,f;const d={c:function(){t=g("div"),n=g("textarea"),o=b(),c=g("br"),r=b(),a=g("label"),l=v("5. "),u=g("button"),u.textContent="setRemoteDescription",oe(n,"cols","60"),oe(n,"rows","20"),oe(n,"class","svelte-2kh684"),k(n,"hideDetails",e[19]),i(n,Qe,325,24,10174),i(c,Qe,326,24,10277),i(u,Qe,328,31,10347),i(a,Qe,327,24,10308),i(t,Qe,324,20,10144),f=[ne(n,"input",e[49]),ne(u,"click",e[50],!1,!1,!1)]},m:function(i,s){ee(i,t,s),Z(t,n),y(n,e[15]),Z(t,o),Z(t,c),Z(t,r),Z(t,a),Z(a,l),Z(a,u)},p:function(e,t){32768&t[0]&&y(n,e[15]),524288&t[0]&&k(n,"hideDetails",e[19])},d:function(e){e&&te(t),s(f)}};return Y("SvelteRegisterBlock",{block:d,id:ot.name,type:"if",source:"(324:16) {#if receivedAnswer && !$config.isManual}",ctx:e}),d}function it(e){let t,n,o,c,r,a,l,u,f,d,p;const m={c:function(){t=g("div"),n=g("strong"),n.textContent="MANUAL ANSWER HERE",o=b(),c=g("textarea"),r=b(),a=g("br"),l=b(),u=g("label"),f=v("5. "),d=g("button"),d.textContent="setRemoteDescription",i(n,Qe,334,24,10607),oe(c,"cols","60"),oe(c,"rows","20"),oe(c,"class","svelte-2kh684"),i(c,Qe,335,24,10667),i(a,Qe,336,24,10752),i(d,Qe,338,31,10822),i(u,Qe,337,24,10783),i(t,Qe,333,20,10577),p=[ne(c,"input",e[51]),ne(d,"click",e[52],!1,!1,!1)]},m:function(i,s){ee(i,t,s),Z(t,n),Z(t,o),Z(t,c),y(c,e[11]),Z(t,r),Z(t,a),Z(t,l),Z(t,u),Z(u,f),Z(u,d)},p:function(e,t){2048&t[0]&&y(c,e[11])},d:function(e){e&&te(t),s(p)}};return Y("SvelteRegisterBlock",{block:m,id:it.name,type:"if",source:"(333:16) {#if $config.isManual}",ctx:e}),m}function ct(e){let t,n,o,i=e[14]&&!e[18].isManual&&rt(e),c=e[18].isManual&&st(e),r=e[9]&&e[14]&&at(e);const s={c:function(){i&&i.c(),t=b(),c&&c.c(),n=b(),r&&r.c(),o=$()},m:function(e,s){i&&i.m(e,s),ee(e,t,s),c&&c.m(e,s),ee(e,n,s),r&&r.m(e,s),ee(e,o,s)},p:function(e,s){e[14]&&!e[18].isManual?i?i.p(e,s):(i=rt(e),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),e[18].isManual?c?c.p(e,s):(c=st(e),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),e[9]&&e[14]?r?r.p(e,s):(r=at(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d:function(e){i&&i.d(e),e&&te(t),c&&c.d(e),e&&te(n),r&&r.d(e),e&&te(o)}};return Y("SvelteRegisterBlock",{block:s,id:ct.name,type:"if",source:"(345:12) {#if isReceiver}",ctx:e}),s}function rt(e){let t,n,o,c,r,a,l,u,f,d,p;const m={c:function(){t=g("div"),n=g("textarea"),o=b(),c=g("br"),r=b(),a=g("label"),l=v("3.\n                            "),u=g("button"),u.textContent="setRemoteDescription",f=b(),d=g("button"),d.textContent="create answer",oe(n,"cols","60"),oe(n,"rows","20"),oe(n,"class","svelte-2kh684"),k(n,"hideDetails",e[19]),i(n,Qe,347,24,11148),i(c,Qe,348,24,11250),i(u,Qe,351,28,11348),i(d,Qe,352,28,11463),i(a,Qe,349,24,11281),i(t,Qe,346,20,11118),p=[ne(n,"input",e[53]),ne(u,"click",e[54],!1,!1,!1),ne(d,"click",e[23],!1,!1,!1)]},m:function(i,s){ee(i,t,s),Z(t,n),y(n,e[14]),Z(t,o),Z(t,c),Z(t,r),Z(t,a),Z(a,l),Z(a,u),Z(a,f),Z(a,d)},p:function(e,t){16384&t[0]&&y(n,e[14]),524288&t[0]&&k(n,"hideDetails",e[19])},d:function(e){e&&te(t),s(p)}};return Y("SvelteRegisterBlock",{block:m,id:rt.name,type:"if",source:"(346:16) {#if receivedOffer && !$config.isManual}",ctx:e}),m}function st(e){let t,n,o,c,r,a,l,u,f,d,p,m,h;const $={c:function(){t=g("div"),n=g("strong"),n.textContent="MANUAL OFFER HERE",o=b(),c=g("textarea"),r=b(),a=g("br"),l=b(),u=g("label"),f=v("3.\n                            "),d=g("button"),d.textContent="setRemoteDescription",p=b(),m=g("button"),m.textContent="create answer",i(n,Qe,358,24,11689),oe(c,"cols","60"),oe(c,"rows","20"),oe(c,"class","svelte-2kh684"),i(c,Qe,359,24,11748),i(a,Qe,360,24,11832),i(d,Qe,363,28,11930),i(m,Qe,364,28,12045),i(u,Qe,361,24,11863),i(t,Qe,357,20,11659),h=[ne(c,"input",e[55]),ne(d,"click",e[56],!1,!1,!1),ne(m,"click",e[23],!1,!1,!1)]},m:function(i,s){ee(i,t,s),Z(t,n),Z(t,o),Z(t,c),y(c,e[10]),Z(t,r),Z(t,a),Z(t,l),Z(t,u),Z(u,f),Z(u,d),Z(u,p),Z(u,m)},p:function(e,t){1024&t[0]&&y(c,e[10])},d:function(e){e&&te(t),s(h)}};return Y("SvelteRegisterBlock",{block:$,id:st.name,type:"if",source:"(357:16) {#if $config.isManual}",ctx:e}),$}function at(e){let t,n,o,c,r,a,l,u,f,d,p;const m={c:function(){t=g("div"),n=g("textarea"),o=b(),c=g("br"),r=b(),a=g("label"),l=v("4.\n                            "),u=g("button"),u.textContent="setLocalDescription",f=b(),d=g("button"),d.textContent="send answer",oe(n,"cols","60"),oe(n,"rows","20"),oe(n,"class","svelte-2kh684"),k(n,"hideDetails",e[19]),i(n,Qe,370,24,12286),i(c,Qe,371,24,12390),i(u,Qe,374,28,12488),i(d,Qe,375,28,12609),i(a,Qe,372,24,12421),i(t,Qe,369,20,12256),p=[ne(n,"input",e[57]),ne(u,"click",e[58],!1,!1,!1),ne(d,"click",e[25],!1,!1,!1)]},m:function(i,s){ee(i,t,s),Z(t,n),y(n,e[9]),Z(t,o),Z(t,c),Z(t,r),Z(t,a),Z(a,l),Z(a,u),Z(a,f),Z(a,d)},p:function(e,t){512&t[0]&&y(n,e[9]),524288&t[0]&&k(n,"hideDetails",e[19])},d:function(e){e&&te(t),s(p)}};return Y("SvelteRegisterBlock",{block:m,id:at.name,type:"if",source:"(369:16) {#if localAnswerSdp && receivedOffer}",ctx:e}),m}function lt(e){let t,n;const o={c:function(){t=g("textarea"),oe(t,"cols","60"),oe(t,"rows","20"),oe(t,"class","svelte-2kh684"),k(t,"hideDetails",e[19]),i(t,Qe,382,16,12841),n=ne(t,"input",e[59])},m:function(n,o){ee(n,t,o),y(t,e[16])},p:function(e,n){65536&n[0]&&y(t,e[16]),524288&n[0]&&k(t,"hideDetails",e[19])},d:function(e){e&&te(t),n()}};return Y("SvelteRegisterBlock",{block:o,id:lt.name,type:"if",source:"(382:12) {#if readableCandidates.length || $config.isManual}",ctx:e}),o}function ut(e){let t,n,o,c,r,s,a,l=JSON.stringify(e[17],null,4)+"";const u={c:function(){t=g("label"),t.textContent="injected Candidates",n=b(),o=g("textarea"),c=b(),r=g("pre"),s=v(l),oe(t,"for","injectedCandidates"),i(t,Qe,386,16,12994),oe(o,"name","injectedCandidates"),oe(o,"cols","60"),oe(o,"rows","20"),oe(o,"class","svelte-2kh684"),i(o,Qe,387,16,13070),i(r,Qe,388,16,13177),a=ne(o,"input",e[60])},m:function(i,a){ee(i,t,a),ee(i,n,a),ee(i,o,a),y(o,e[12]),ee(i,c,a),ee(i,r,a),Z(r,s)},p:function(e,t){4096&t[0]&&y(o,e[12]),131072&t[0]&&l!==(l=JSON.stringify(e[17],null,4)+"")&&ie(s,l)},d:function(e){e&&te(t),e&&te(n),e&&te(o),e&&te(c),e&&te(r),a()}};return Y("SvelteRegisterBlock",{block:u,id:ut.name,type:"if",source:"(386:12) {#if $config.isManual}",ctx:e}),u}function ft(e){let t,n,o,c,r,a,l,u,f,d,p,m,h,$,w,y,k,S,C,x,R,O,j,_,E,D,M,A,B,N,P,L,U,I,T,H,z,W,G,K,Q,X,ce,re,se,ae,le,ue,fe=e[18].isRemote&&Xe(e),de=e[18].hasUpstream&&Ye(e),pe=e[18].hasDownstream&&Ze(e),me=!e[19]&&et(e),he=e[0]&&tt(e),ge=e[1]&&ct(e),ve=(e[16].length||e[18].isManual)&&lt(e),be=e[18].isManual&&ut(e);const $e={c:function(){t=g("section"),n=g("h3"),o=v(e[2]),c=b(),fe&&fe.c(),r=b(),a=g("small"),l=v("talking to "),u=v(e[3]),f=b(),d=g("div"),de&&de.c(),p=b(),pe&&pe.c(),m=b(),h=g("div"),$=g("label"),w=v("signaling: "),y=g("code"),k=v(e[5]),S=b(),C=g("label"),x=v("connection: "),R=g("code"),O=v(e[6]),j=b(),_=g("label"),E=v("ice: "),D=g("code"),M=v(e[7]),A=b(),me&&me.c(),B=b(),N=g("fieldset"),P=g("span"),L=g("label"),U=g("input"),I=v(" caller"),T=b(),H=g("label"),z=g("input"),W=v(" receiver"),G=b(),K=g("label"),Q=g("input"),X=v(" manual mode"),ce=b(),he&&he.c(),re=b(),ge&&ge.c(),se=b(),ve&&ve.c(),ae=b(),be&&be.c(),i(n,Qe,272,4,8088),i(a,Qe,276,4,8180),oe(y,"class","svelte-2kh684"),i(y,Qe,293,31,8743),i($,Qe,293,12,8724),oe(R,"class","svelte-2kh684"),i(R,Qe,294,32,8814),i(C,Qe,294,12,8794),oe(D,"class","svelte-2kh684"),i(D,Qe,295,25,8879),i(_,Qe,295,12,8866),oe(U,"type","checkbox"),i(U,Qe,303,28,9093),i(L,Qe,303,20,9085),oe(z,"type","checkbox"),i(z,Qe,304,28,9187),i(H,Qe,304,20,9179),oe(Q,"type","checkbox"),i(Q,Qe,305,28,9285),i(K,Qe,305,20,9277),oe(P,"class","svelte-2kh684"),i(P,Qe,302,16,9058),oe(N,"class","svelte-2kh684"),i(N,Qe,301,12,9031),oe(h,"id","signaling"),oe(h,"class","svelte-2kh684"),i(h,Qe,292,8,8691),oe(d,"id","streams"),oe(d,"class","svelte-2kh684"),i(d,Qe,277,4,8222),i(t,Qe,270,0,8073),ue=[ne(U,"change",e[44]),ne(z,"change",e[45]),ne(Q,"change",e[46])]},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,s){ee(i,t,s),Z(t,n),Z(n,o),Z(t,c),fe&&fe.m(t,null),Z(t,r),Z(t,a),Z(a,l),Z(a,u),Z(t,f),Z(t,d),de&&de.m(d,null),Z(d,p),pe&&pe.m(d,null),Z(d,m),Z(d,h),Z(h,$),Z($,w),Z($,y),Z(y,k),Z(h,S),Z(h,C),Z(C,x),Z(C,R),Z(R,O),Z(h,j),Z(h,_),Z(_,E),Z(_,D),Z(D,M),Z(h,A),me&&me.m(h,null),Z(h,B),Z(h,N),Z(N,P),Z(P,L),Z(L,U),U.checked=e[0],Z(L,I),Z(P,T),Z(P,H),Z(H,z),z.checked=e[1],Z(H,W),Z(P,G),Z(P,K),Z(K,Q),Q.checked=e[18].isManual,Z(K,X),Z(h,ce),he&&he.m(h,null),Z(h,re),ge&&ge.m(h,null),Z(h,se),ve&&ve.m(h,null),Z(h,ae),be&&be.m(h,null),le=!0},p:function(e,n){(!le||4&n[0])&&ie(o,e[2]),e[18].isRemote?fe?(fe.p(e,n),J(fe,1)):(fe=Xe(e),fe.c(),J(fe,1),fe.m(t,r)):fe&&(q(),V(fe,1,1,()=>{fe=null}),F()),(!le||8&n[0])&&ie(u,e[3]),e[18].hasUpstream?de?(de.p(e,n),J(de,1)):(de=Ye(e),de.c(),J(de,1),de.m(d,p)):de&&(q(),V(de,1,1,()=>{de=null}),F()),e[18].hasDownstream?pe?pe.p(e,n):(pe=Ze(e),pe.c(),pe.m(d,m)):pe&&(pe.d(1),pe=null),(!le||32&n[0])&&ie(k,e[5]),(!le||64&n[0])&&ie(O,e[6]),(!le||128&n[0])&&ie(M,e[7]),e[19]?me&&(me.d(1),me=null):me?me.p(e,n):(me=et(e),me.c(),me.m(h,B)),1&n[0]&&(U.checked=e[0]),2&n[0]&&(z.checked=e[1]),262144&n[0]&&(Q.checked=e[18].isManual),e[0]?he?he.p(e,n):(he=tt(e),he.c(),he.m(h,re)):he&&(he.d(1),he=null),e[1]?ge?ge.p(e,n):(ge=ct(e),ge.c(),ge.m(h,se)):ge&&(ge.d(1),ge=null),e[16].length||e[18].isManual?ve?ve.p(e,n):(ve=lt(e),ve.c(),ve.m(h,ae)):ve&&(ve.d(1),ve=null),e[18].isManual?be?be.p(e,n):(be=ut(e),be.c(),be.m(h,null)):be&&(be.d(1),be=null)},i:function(e){le||(J(fe),J(de),le=!0)},o:function(e){V(fe),V(de),le=!1},d:function(e){e&&te(t),fe&&fe.d(),de&&de.d(),pe&&pe.d(),me&&me.d(),he&&he.d(),ge&&ge.d(),ve&&ve.d(),be&&be.d(),s(ue)}};return Y("SvelteRegisterBlock",{block:$e,id:ft.name,type:"component",source:"",ctx:e}),$e}function dt(e,t,n){let o,i,c,r,s;u(ge,"eventLogByName"),d(e,ge,e=>n(32,o=e)),u(be,"offerStore"),d(e,be,e=>n(33,i=e)),u($e,"answerStore"),d(e,$e,e=>n(34,c=e)),u(he,"config"),d(e,he,e=>n(18,r=e)),u(we,"candidatesStore"),d(e,we,e=>n(35,s=e));let{isCaller:a=!1}=t,{isReceiver:l=!1}=t,{name:f="unnamed participant"}=t,{recipient:p=null}=t;const m=new Ae({from:f,to:p}),h=j(),g=ve(f);let v,b,$,w="",y="",k="",S="",C="",x="",R="",_=[],D="",M=(()=>"unified-plan"===new URL(document.location).searchParams.get("semantic")?{sdpSemantics:"unified-plan"}:{sdpSemantics:"plan-b"})();function A(){M.sdpSemantics;const e=new RTCPeerConnection(M);return e.ontrack=e=>{const{track:t,streams:o,transceiver:i}=e,c=o[0];n(4,v.srcObject=c,v),c.onaddtrack=()=>console.warn(`${f}track added to stream`,{track:t,stream:c}),"video"==t.kind&&(console.info(`${f}.ontrack`,{track:t,streams:o,kind:t.kind,transceiver:i}),t.onmute=e=>{console.info(`${f} track onmute`,{event:e}),n(4,v.srcObject=null,v)},t.onunmute=e=>{console.info(`${f} track onunmute`,{event:e}),n(4,v.srcObject=c,v)},t.onended=e=>{console.debug(`${f} track onended`,{event:e})})},e.onicecandidate=({candidate:e})=>{g("lc","create candidate"),n(31,_=[..._,e]),P(e)},e.onsignalingstatechange=t=>n(5,w=e.signalingState),e.onconnectionstatechange=t=>n(6,y=e.connectionState),e.oniceconnectionstatechange=t=>n(7,k=e.iceConnectionState),console.info(`setup RTCPeerConnection for ${f}`,M,e),e}function B(e){$?(g("rt","replace track"),console.info("replace track",{sender:$}),$.replaceTrack(e.getTracks()[0])):(g("at","add track"),console.info("add track"),$=b.addTrack(e.getTracks()[0],e))}async function N(){g("o","create offer");const e=await b.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!1});n(8,S=e.sdp)}function P(e){f&&e&&(Se({from:f,candidate:e}),r.isRemote&&m.sendCandidate(e))}async function L(e){g("l","setLocalDescription"),console.debug("localDescription ->",e);const t=e;Ce(f),b.setLocalDescription(t),I(),Ce(p)}function U(e){g("r","setRemoteDescription");const t=Pe(e);b.setRemoteDescription(t),I(),Ce(p)}function I(){r.isManual?(z||[]).forEach(e=>{e&&(g("ac","addIceCandidate"),b.addIceCandidate(e))}):(console.debug(s[p]),(s[p]||[]).forEach(e=>{e&&(g("ac","addIceCandidate"),b.addIceCandidate(e))}))}function T(e){g("r","setRemoteDescription");const t=Le(e);b.setRemoteDescription(t),Ce(f)}O(()=>{b=A(),we.subscribe(({[p]:e})=>{e&&g("rc")}),r.hasCaller&&N()});const q=["isCaller","isReceiver","name","recipient"];Object.keys(t).forEach(e=>{~q.indexOf(e)||"$$"===e.slice(0,2)||Ke.warn(`<Participant> was created with unknown prop '${e}'`)});let F,J,V,H,z,W;return e.$set=e=>{"isCaller"in e&&n(0,a=e.isCaller),"isReceiver"in e&&n(1,l=e.isReceiver),"name"in e&&n(2,f=e.name),"recipient"in e&&n(3,p=e.recipient)},e.$capture_state=()=>({isCaller:a,isReceiver:l,name:f,recipient:p,downstreamVideo:v,peerConnection:b,sender:$,signalingState:w,connectionState:y,iceConnectionState:k,localOfferSdp:S,localAnswerSdp:C,injectedOffer:x,injectedAnswer:R,rawCandidates:_,injectedCandidates:D,pcconfig:M,events:F,$eventLogByName:o,receivedOffer:J,$offerStore:i,receivedAnswer:V,$answerStore:c,readableCandidates:H,parsedInjectedCandidates:z,$config:r,$candidatesStore:s,hideDetails:W}),e.$inject_state=e=>{"isCaller"in e&&n(0,a=e.isCaller),"isReceiver"in e&&n(1,l=e.isReceiver),"name"in e&&n(2,f=e.name),"recipient"in e&&n(3,p=e.recipient),"downstreamVideo"in e&&n(4,v=e.downstreamVideo),"peerConnection"in e&&(b=e.peerConnection),"sender"in e&&($=e.sender),"signalingState"in e&&n(5,w=e.signalingState),"connectionState"in e&&n(6,y=e.connectionState),"iceConnectionState"in e&&n(7,k=e.iceConnectionState),"localOfferSdp"in e&&n(8,S=e.localOfferSdp),"localAnswerSdp"in e&&n(9,C=e.localAnswerSdp),"injectedOffer"in e&&n(10,x=e.injectedOffer),"injectedAnswer"in e&&n(11,R=e.injectedAnswer),"rawCandidates"in e&&n(31,_=e.rawCandidates),"injectedCandidates"in e&&n(12,D=e.injectedCandidates),"pcconfig"in e&&(M=e.pcconfig),"events"in e&&n(13,F=e.events),"$eventLogByName"in e&&ge.set(o=e.$eventLogByName),"receivedOffer"in e&&n(14,J=e.receivedOffer),"$offerStore"in e&&be.set(i=e.$offerStore),"receivedAnswer"in e&&n(15,V=e.receivedAnswer),"$answerStore"in e&&$e.set(c=e.$answerStore),"readableCandidates"in e&&n(16,H=e.readableCandidates),"parsedInjectedCandidates"in e&&n(17,z=e.parsedInjectedCandidates),"$config"in e&&he.set(r=e.$config),"$candidatesStore"in e&&we.set(s=e.$candidatesStore),"hideDetails"in e&&n(19,W=e.hideDetails)},e.$$.update=()=>{4&e.$$.dirty[0]|2&e.$$.dirty[1]&&n(13,F=o[f]||[]),8&e.$$.dirty[0]|4&e.$$.dirty[1]&&n(14,J=Be(i[p])),8&e.$$.dirty[0]|8&e.$$.dirty[1]&&n(15,V=Be(c[p])),1&e.$$.dirty[1]&&n(16,H=JSON.stringify(_)),4096&e.$$.dirty[0]&&n(17,z=Ne(D)),262144&e.$$.dirty[0]&&n(19,W=r.hideDetails)},[a,l,f,p,v,w,y,k,S,C,x,R,D,F,J,V,H,z,r,W,m,B,N,async function(){g("a","create answer");const e=await b.createAnswer();n(9,C=e.sdp)},function(){const e=Pe(S);ye({from:f,offer:e}),r.isRemote&&m.sendOffer(e)},function(){const e=Pe(C);ke({from:f,answer:e}),r.isRemote&&m.sendAnswer(e)},L,U,T,b,$,_,o,i,c,s,h,g,M,A,P,I,({detail:e})=>B(e),function(e){E[e?"unshift":"push"](()=>{n(4,v=e)})},function(){a=this.checked,n(0,a)},function(){l=this.checked,n(1,l)},function(){r.isManual=this.checked,he.set(r)},function(){S=this.value,n(8,S)},()=>L(Pe(S)),function(){V=this.value,n(15,V),n(34,c),n(3,p)},()=>T(V),function(){R=this.value,n(11,R)},()=>T(R),function(){J=this.value,n(14,J),n(33,i),n(3,p)},()=>U(J),function(){x=this.value,n(10,x)},()=>U(x),function(){C=this.value,n(9,C)},()=>L(Le(C)),function(){H=this.value,n(16,H),n(31,_)},function(){D=this.value,n(12,D)}]}var pt=class extends ce{constructor(e){super(e),Q(this,e,dt,ft,l,{isCaller:0,isReceiver:1,name:2,recipient:3},[-1,-1]),Y("SvelteRegisterComponent",{component:this,tagName:"Participant",options:e,id:ft.name})}get isCaller(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isCaller(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get isReceiver(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isReceiver(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get name(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set name(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get recipient(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set recipient(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const mt="src/EventLog.svelte";function ht(e,t,n){const o=e.slice();return o[1]=t[n].name,o[2]=t[n].event,o}function gt(e){let t,n,o,c,r=e[1]+"",s=e[2]+"";const a={c:function(){t=g("li"),n=v(r),o=v(": "),c=v(s),i(t,mt,6,8,146)},m:function(e,i){ee(e,t,i),Z(t,n),Z(t,o),Z(t,c)},p:function(e,t){1&t&&r!==(r=e[1]+"")&&ie(n,r),1&t&&s!==(s=e[2]+"")&&ie(c,s)},d:function(e){e&&te(t)}};return Y("SvelteRegisterBlock",{block:a,id:gt.name,type:"each",source:"(6:4) {#each $eventLog.filter(e => e.event) as { name, event }}",ctx:e}),a}function vt(e){let t,n,c,r,s,a=e[0].filter(bt),l=[];for(let t=0;t<a.length;t+=1)l[t]=gt(ht(e,a,t));const u={c:function(){t=g("ol");for(let e=0;e<l.length;e+=1)l[e].c();n=b(),c=g("em"),r=v("please open\n    "),s=g("code"),s.textContent="chrome://webrtc-internals",i(t,mt,4,0,71),i(s,mt,12,4,215),i(c,mt,10,0,190)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){ee(e,t,o);for(let e=0;e<l.length;e+=1)l[e].m(t,null);ee(e,n,o),ee(e,c,o),Z(c,r),Z(c,s)},p:function(e,[n]){if(1&n){let o;for(a=e[0].filter(bt),o=0;o<a.length;o+=1){const i=ht(e,a,o);l[o]?l[o].p(i,n):(l[o]=gt(i),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}},i:o,o:o,d:function(e){e&&te(t),h(l,e),e&&te(n),e&&te(c)}};return Y("SvelteRegisterBlock",{block:u,id:vt.name,type:"component",source:"",ctx:e}),u}const bt=e=>e.event;function $t(e,t,n){let o;return u(fe,"eventLog"),d(e,fe,e=>n(0,o=e)),e.$capture_state=()=>({}),e.$inject_state=e=>{"$eventLog"in e&&fe.set(o=e.$eventLog)},[o]}var wt=class extends ce{constructor(e){super(e),Q(this,e,$t,vt,l,{}),Y("SvelteRegisterComponent",{component:this,tagName:"EventLog",options:e,id:vt.name})}};n(7);const yt="src/Demo.svelte";function kt(e){let t;const n=new pt({props:{name:"alice",isCaller:"true",recipient:"bob"},$$inline:!0}),o={c:function(){W(n.$$.fragment)},m:function(e,o){G(n,e,o),t=!0},i:function(e){t||(J(n.$$.fragment,e),t=!0)},o:function(e){V(n.$$.fragment,e),t=!1},d:function(e){K(n,e)}};return Y("SvelteRegisterBlock",{block:o,id:kt.name,type:"if",source:"(37:8) {#if $config.hasCaller}",ctx:e}),o}function St(e){let t;const n=new pt({props:{name:"bob",isReceiver:"true",recipient:"alice"},$$inline:!0}),o={c:function(){W(n.$$.fragment)},m:function(e,o){G(n,e,o),t=!0},i:function(e){t||(J(n.$$.fragment,e),t=!0)},o:function(e){V(n.$$.fragment,e),t=!1},d:function(e){K(n,e)}};return Y("SvelteRegisterBlock",{block:o,id:St.name,type:"if",source:"(41:8) {#if $config.hasReceiver}",ctx:e}),o}function Ct(e){let t,n;const o=new wt({$$inline:!0}),c={c:function(){t=g("div"),W(o.$$.fragment),oe(t,"class","svelte-vvgboa"),i(t,yt,45,8,950)},m:function(e,i){ee(e,t,i),G(o,t,null),n=!0},i:function(e){n||(J(o.$$.fragment,e),n=!0)},o:function(e){V(o.$$.fragment,e),n=!1},d:function(e){e&&te(t),K(o)}};return Y("SvelteRegisterBlock",{block:c,id:Ct.name,type:"if",source:"(45:8) {#if !$config.hideDetails}",ctx:e}),c}function xt(e){let t,n,o,c,r,s,a;const l=new Me({$$inline:!0});let u=e[0].hasCaller&&kt(e),f=e[0].hasReceiver&&St(e),d=!e[0].hideDetails&&Ct(e);const p={c:function(){t=g("div"),n=g("aside"),W(l.$$.fragment),o=b(),c=g("section"),u&&u.c(),r=b(),f&&f.c(),s=b(),d&&d.c(),i(n,yt,30,4,618),oe(c,"class","svelte-vvgboa"),i(c,yt,34,4,662),oe(t,"class","svelte-vvgboa"),i(t,yt,29,0,608)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,i){ee(e,t,i),Z(t,n),G(l,n,null),Z(t,o),Z(t,c),u&&u.m(c,null),Z(c,r),f&&f.m(c,null),Z(c,s),d&&d.m(c,null),a=!0},p:function(e,[t]){e[0].hasCaller?u?J(u,1):(u=kt(e),u.c(),J(u,1),u.m(c,r)):u&&(q(),V(u,1,1,()=>{u=null}),F()),e[0].hasReceiver?f?J(f,1):(f=St(e),f.c(),J(f,1),f.m(c,s)):f&&(q(),V(f,1,1,()=>{f=null}),F()),e[0].hideDetails?d&&(q(),V(d,1,1,()=>{d=null}),F()):d?J(d,1):(d=Ct(e),d.c(),J(d,1),d.m(c,null))},i:function(e){a||(J(l.$$.fragment,e),J(u),J(f),J(d),a=!0)},o:function(e){V(l.$$.fragment,e),V(u),V(f),V(d),a=!1},d:function(e){e&&te(t),K(l),u&&u.d(),f&&f.d(),d&&d.d()}};return Y("SvelteRegisterBlock",{block:p,id:xt.name,type:"component",source:"",ctx:e}),p}function Rt(e,t,n){let o;return u(he,"config"),d(e,he,e=>n(0,o=e)),e.$capture_state=()=>({}),e.$inject_state=e=>{"$config"in e&&he.set(o=e.$config)},[o]}var Ot=class extends ce{constructor(e){super(e),Q(this,e,Rt,xt,l,{}),Y("SvelteRegisterComponent",{component:this,tagName:"Demo",options:e,id:xt.name})}};function jt(e){let t;const n=new Ot({$$inline:!0}),i={c:function(){W(n.$$.fragment)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){G(n,e,o),t=!0},p:o,i:function(e){t||(J(n.$$.fragment,e),t=!0)},o:function(e){V(n.$$.fragment,e),t=!1},d:function(e){K(n,e)}};return Y("SvelteRegisterBlock",{block:i,id:jt.name,type:"component",source:"",ctx:e}),i}const _t=new class extends ce{constructor(e){super(e),Q(this,e,null,jt,l,{}),Y("SvelteRegisterComponent",{component:this,tagName:"App",options:e,id:jt.name})}}({target:document.body,props:{}});window.app=_t;t.default=_t}]);