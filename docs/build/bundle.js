(()=>{"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t){return 0===Object.keys(t).length}function l(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function a(t,e,n){t.$$.on_destroy.push(l(e,n))}new Set;let s,u=!1;function d(t,e,n,r){for(;t<e;){const o=t+(e-t>>1);n(o)<=r?t=o+1:e=o}return t}function f(t,e){u?(function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let o=0;for(let t=0;t<e.length;t++){const i=d(1,o+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[i]+1;const c=i+1;n[c]=t,o=Math.max(c,o)}const i=[],c=[];let l=e.length-1;for(let t=n[o]+1;0!=t;t=r[t-1]){for(i.push(e[t-1]);l>=t;l--)c.push(e[l]);l--}for(;l>=0;l--)c.push(e[l]);i.reverse(),c.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<c.length;e++){for(;n<i.length&&c[e].claim_order>=i[n].claim_order;)n++;const r=n<i.length?i[n]:null;t.insertBefore(c[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function m(t,e,n){u&&!n?f(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function p(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function $(){return v(" ")}function b(){return v("")}function y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function k(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function C(t,e,n){t.classList[n?"add":"remove"](e)}function S(t){s=t}function T(){if(!s)throw new Error("Function called outside component initialization");return s}function E(t){T().$$.on_mount.push(t)}function _(){const t=T();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}new Set;const N=[],R=[],O=[],L=[],D=Promise.resolve();let M=!1;function A(){M||(M=!0,D.then(F))}function j(t){O.push(t)}function I(t){L.push(t)}let B=!1;const J=new Set;function F(){if(!B){B=!0;do{for(let t=0;t<N.length;t+=1){const e=N[t];S(e),P(e.$$)}for(S(null),N.length=0;R.length;)R.pop()();for(let t=0;t<O.length;t+=1){const e=O[t];J.has(e)||(J.add(e),e())}O.length=0}while(N.length);for(;L.length;)L.pop()();M=!1,B=!1,J.clear()}}function P(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const q=new Set;let H;function U(){H={r:0,c:[],p:H}}function W(){H.r||r(H.c),H=H.p}function z(t,e){t&&t.i&&(q.delete(t),t.i(e))}function V(t,e,n,r){if(t&&t.o){if(q.has(t))return;q.add(t),H.c.push((()=>{q.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const G="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;let X;function K(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function Q(t){t&&t.c()}function Y(t,n,i,c){const{fragment:l,on_mount:a,on_destroy:s,after_update:u}=t.$$;l&&l.m(n,i),c||j((()=>{const n=a.map(e).filter(o);s?s.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(j)}function Z(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function tt(e,o,i,c,l,a,d=[-1]){const f=s;S(e);const m=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:o.context||[]),callbacks:n(),dirty:d,skip_bound:!1};let h=!1;if(m.ctx=i?i(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return m.ctx&&l(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),h&&function(t,e){-1===t.$$.dirty[0]&&(N.push(t),A(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],m.update(),h=!0,r(m.before_update),m.fragment=!!c&&c(m.ctx),o.target){if(o.hydrate){u=!0;const t=(g=o.target,Array.from(g.childNodes));m.fragment&&m.fragment.l(t),t.forEach(p)}else m.fragment&&m.fragment.c();o.intro&&z(e.$$.fragment),Y(e,o.target,o.anchor,o.customElement),u=!1,F()}var g;S(f)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(X=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(o);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){r(this.$$.on_disconnect)}$destroy(){Z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class et{$destroy(){Z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const nt=[];function rt(e,n=t){let r;const o=[];function c(t){if(i(e,t)&&(e=t,r)){const t=!nt.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),nt.push(n,e)}if(t){for(let t=0;t<nt.length;t+=2)nt[t][0](nt[t+1]);nt.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(i,l=t){const a=[i,l];return o.push(a),1===o.length&&(r=n(c)||t),i(e),()=>{const t=o.indexOf(a);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}function ot(e,n,i){const c=!Array.isArray(e),a=c?[e]:e,s=n.length<2;return{subscribe:rt(i,(e=>{let i=!1;const u=[];let d=0,f=t;const m=()=>{if(d)return;f();const r=n(c?u[0]:u,e);s?e(r):f=o(r)?r:t},p=a.map(((t,e)=>l(t,(t=>{u[e]=t,d&=~(1<<e),i&&m()}),(()=>{d|=1<<e}))));return i=!0,m(),function(){r(p),f()}})).subscribe}}const it=rt([]),ct=t=>{try{return!0===JSON.parse(t)}catch{return!1}},lt=rt((()=>{const t=Object.fromEntries(new URLSearchParams(location.search).entries()),e={role:t.role||"both",stream:t.stream||"both",autoSignal:ct(t.autoSignal),audioVisOnly:ct(t.audioVisOnly),manual:ct(t.manual),remote:ct(t.remote),hideSignaling:ct(t.hideSignaling),hideEvents:ct(t.hideEvents),showCandidateEvents:ct(t.showCandidateEvents),showTransceivers:ct(t.showTransceivers??!0)};return Object.entries(e).map((([t,e])=>({key:t,value:e})))})()),at=ot(lt,(t=>`${window.origin}${window.location.pathname}?${(t=>{const e=new URLSearchParams;for(let[n,r]of t)e.set(n,r);return e.toString()})(t.map((({key:t,value:e})=>[t,e])))}`)),st=ot(lt,(t=>{const e=Object.fromEntries(t.map((({key:t,value:e})=>[t,e])));let{role:n,stream:r,manual:o,remote:i,hideSignaling:c,hideEvents:l,showTransceivers:a,autoSignal:s,showCandidateEvents:u}=e;const d="recv"!==n,f="call"!==n&&"send"!==n||!1,m="down"!==r||!1,p="up"!==r||!1,h=o&&"no"!==o||!1,g=i&&"no"!==i||!1,v=d?"bob":"alice",$=f?"bob":"alice";return{...e,role:n,stream:r,manual:o,remote:i,hasCaller:d,hasReceiver:f,hasUpstream:m,hasDownstream:p,autoSignal:s,isManual:h,isRemote:g,hideSignaling:c,hideEvents:l,showTransceivers:a,showCandidateEvents:u,to:v,from:$}})),ut=rt({});function dt(t,e,n){const r={name:t,short:e,event:n,timestamp:(new Date).toISOString().split("T")[1]};it.update((t=>[...t,r])),ut.update((n=>({...n,[t]:[...n[t]||[],e]})))}const ft=t=>(e,n)=>dt(t,e,n);function mt(t,e,n){const r=t.slice();return r[4]=e[n].key,r[5]=e[n].value,r[6]=e,r[7]=n,r}function pt(t){let e,n,r,o,i,c,l,a=t[4]+"";function s(){t[3].call(i,t[6],t[7])}return{c(){e=g("td"),n=v(a),r=$(),o=g("td"),i=g("input"),k(i,"type","text")},m(a,u){m(a,e,u),f(e,n),m(a,r,u),m(a,o,u),f(o,i),x(i,t[5]),c||(l=y(i,"input",s),c=!0)},p(e,r){t=e,1&r&&a!==(a=t[4]+"")&&w(n,a),1&r&&i.value!==t[5]&&x(i,t[5])},d(t){t&&p(e),t&&p(r),t&&p(o),c=!1,l()}}}function ht(t){let e,n,r,o,i,c,l,a,s,u=t[4]+"";function d(){t[2].call(r,t[6],t[7])}return{c(){e=g("td"),n=g("label"),r=g("input"),i=$(),c=v(u),k(r,"type","checkbox"),k(r,"id",o=t[4]),k(n,"for",l=t[4]),k(e,"colspan","2")},m(o,l){m(o,e,l),f(e,n),f(n,r),r.checked=t[5],f(n,i),f(n,c),a||(s=y(r,"change",d),a=!0)},p(e,i){t=e,1&i&&o!==(o=t[4])&&k(r,"id",o),1&i&&(r.checked=t[5]),1&i&&u!==(u=t[4]+"")&&w(c,u),1&i&&l!==(l=t[4])&&k(n,"for",l)},d(t){t&&p(e),a=!1,s()}}}function gt(t){let e,n;function r(t,e){return"boolean"==typeof t[5]?ht:pt}let o=r(t),i=o(t);return{c(){e=g("tr"),i.c(),n=$()},m(t,r){m(t,e,r),i.m(e,null),f(e,n)},p(t,c){o===(o=r(t))&&i?i.p(t,c):(i.d(1),i=o(t),i&&(i.c(),i.m(e,n)))},d(t){t&&p(e),i.d()}}}function vt(e){let n,r,o,i,c,l,a,s,u,d,b=e[0],y=[];for(let t=0;t<b.length;t+=1)y[t]=gt(mt(e,b,t));return{c(){n=g("details"),r=g("summary"),r.textContent="Config",o=$(),i=g("div"),c=g("table");for(let t=0;t<y.length;t+=1)y[t].c();l=$(),a=g("code"),s=g("pre"),u=g("a"),d=v(e[1]),k(r,"class","svelte-rc03x9"),k(u,"href",e[1]),k(n,"class","svelte-rc03x9")},m(t,e){m(t,n,e),f(n,r),f(n,o),f(n,i),f(i,c);for(let t=0;t<y.length;t+=1)y[t].m(c,null);f(i,l),f(i,a),f(a,s),f(s,u),f(u,d)},p(t,[e]){if(1&e){let n;for(b=t[0],n=0;n<b.length;n+=1){const r=mt(t,b,n);y[n]?y[n].p(r,e):(y[n]=gt(r),y[n].c(),y[n].m(c,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=b.length}2&e&&w(d,t[1]),2&e&&k(u,"href",t[1])},i:t,o:t,d(t){t&&p(n),h(y,t)}}}function $t(t,e,n){let r,o;return a(t,lt,(t=>n(0,r=t))),a(t,at,(t=>n(1,o=t))),[r,o,function(t,e){t[e].value=this.checked,lt.set(r)},function(t,e){t[e].value=this.value,lt.set(r)}]}const bt=class extends et{constructor(t){super(),tt(this,t,$t,vt,i,{})}},yt=rt({}),kt=rt({}),wt=rt({});function xt({from:t,offer:e}){yt.update((n=>({...n,[t]:e})))}function Ct({from:t,answer:e}){kt.update((n=>({...n,[t]:e})))}function St({from:t,candidate:e}){wt.update((n=>{const r=n[t]||[];return{...n,[t]:[...r,e]}}))}function Tt({from:t}){wt.update((e=>({...e,[t]:[]})))}const Et=new EventTarget;class _t{to;from;socket;constructor({to:t,from:e}){this.to=t,this.from=e}connect({url:t}){const e=new WebSocket(t);e.onopen=()=>{this.socket=e,this.socket.onmessage=this.received.bind(this)}}received({data:t}){const e=JSON.parse(t),{[this.to]:n,type:r}=e;console.debug("its for me!",n);const o=this.to;switch(r){case"offer":xt({from:o,offer:n});break;case"answer":Ct({from:o,answer:n});break;case"candidate":St({from:o,candidate:new RTCIceCandidate(n)})}}sendOffer(t){if(t){const e={[this.from]:t,type:"offer"};this.send(e)}}sendAnswer(t){if(t){const e={[this.from]:t,type:"answer"};this.send(e)}}sendCandidate(t){if(t){const e={[this.from]:t,type:"candidate"};this.send(e)}}send(t){if(this.socket){const e=JSON.stringify(t);this.socket.send(e)}}toString(){return`[Signaling Server calling ${this.from} → ${this.to}]`}}const Nt=t=>"string"==typeof t?JSON.parse(t).sdp:"object"==typeof t?t.sdp:void 0,Rt=t=>({type:"offer",sdp:t}),Ot=t=>({type:"answer",sdp:t});function Lt(t){let e,n,r=JSON.stringify(t[2],null,4)+"";return{c(){e=g("code"),n=v(r)},m(t,r){m(t,e,r),f(e,n)},p(t,e){4&e&&r!==(r=JSON.stringify(t[2],null,4)+"")&&w(n,r)},d(t){t&&p(e)}}}function Dt(t){let e,n=t[0]&&Mt(t);return{c(){e=g("strong"),n&&n.c()},m(t,r){m(t,e,r),n&&n.m(e,null)},p(t,r){t[0]?n?n.p(t,r):(n=Mt(t),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(t){t&&p(e),n&&n.d()}}}function Mt(t){let e,n=JSON.stringify(t[2]())+"";return{c(){e=v(n)},m(t,n){m(t,e,n)},p(t,r){4&r&&n!==(n=JSON.stringify(t[2]())+"")&&w(e,n)},d(t){t&&p(e)}}}function At(e){let n,r,o,i,c,l,a;function s(t,e){return"function"==typeof t[2]?Dt:Lt}let u=s(e),d=u(e);return{c(){n=g("details"),r=g("summary"),o=v(e[1]),i=$(),c=g("pre"),d.c()},m(t,s){m(t,n,s),f(n,r),f(r,o),f(n,i),f(n,c),d.m(c,null),n.open=e[3],l||(a=y(n,"toggle",e[4]),l=!0)},p(t,[e]){2&e&&w(o,t[1]),u===(u=s(t))&&d?d.p(t,e):(d.d(1),d=u(t),d&&(d.c(),d.m(c,null))),8&e&&(n.open=t[3])},i:t,o:t,d(t){t&&p(n),d.d(),l=!1,a()}}}function jt(t,e,n){let{open:r}=e,{summary:o="???"}=e,{data:i}=e,c=Boolean(i)&&r;return t.$$set=t=>{"open"in t&&n(0,r=t.open),"summary"in t&&n(1,o=t.summary),"data"in t&&n(2,i=t.data)},[r,o,i,c,function(){c=this.open,n(3,c)}]}const It=class extends et{constructor(t){super(),tt(this,t,jt,At,i,{open:0,summary:1,data:2})}};function Bt(t){let e,n,r,o,i,c,l,a,s,u,d,h,b,y,x,C,S,T,E,_,N=t[0].constructor.name+"",R=t[0].kind+"",O=t[0].readyState+"",L=t[0].muted?"muted":"unmuted",D=JSON.stringify({id:t[0].id,kind:t[0].kind,constraints:t[2]},null,4)+"",M=t[4]&&Jt(t);return S=new It({props:{data:t[1],summary:"settings",open:!0}}),E=new It({props:{data:t[3],summary:"capabilities",open:!0}}),{c(){e=g("details"),n=g("summary"),r=v(N),o=$(),i=g("strong"),c=v(R),l=$(),M&&M.c(),a=v("\n            | "),s=v(O),u=v("\n            | "),d=v(L),h=$(),b=g("pre"),y=v(D),x=$(),C=g("div"),Q(S.$$.fragment),T=$(),Q(E.$$.fragment),k(C,"class","indent svelte-1scnwrj")},m(t,p){m(t,e,p),f(e,n),f(n,r),f(n,o),f(n,i),f(i,c),f(n,l),M&&M.m(n,null),f(n,a),f(n,s),f(n,u),f(n,d),f(e,h),f(e,b),f(b,y),f(e,x),f(e,C),Y(S,C,null),f(C,T),Y(E,C,null),_=!0},p(t,e){(!_||1&e)&&N!==(N=t[0].constructor.name+"")&&w(r,N),(!_||1&e)&&R!==(R=t[0].kind+"")&&w(c,R),t[4]?M?M.p(t,e):(M=Jt(t),M.c(),M.m(n,a)):M&&(M.d(1),M=null),(!_||1&e)&&O!==(O=t[0].readyState+"")&&w(s,O),(!_||1&e)&&L!==(L=t[0].muted?"muted":"unmuted")&&w(d,L),(!_||5&e)&&D!==(D=JSON.stringify({id:t[0].id,kind:t[0].kind,constraints:t[2]},null,4)+"")&&w(y,D);const o={};2&e&&(o.data=t[1]),S.$set(o);const i={};8&e&&(i.data=t[3]),E.$set(i)},i(t){_||(z(S.$$.fragment,t),z(E.$$.fragment,t),_=!0)},o(t){V(S.$$.fragment,t),V(E.$$.fragment,t),_=!1},d(t){t&&p(e),M&&M.d(),Z(S),Z(E)}}}function Jt(t){let e,n,r,o;return{c(){e=v("| "),n=v(t[4]),r=v("x"),o=v(t[5])},m(t,i){m(t,e,i),m(t,n,i),m(t,r,i),m(t,o,i)},p(t,e){16&e&&w(n,t[4]),32&e&&w(o,t[5])},d(t){t&&p(e),t&&p(n),t&&p(r),t&&p(o)}}}function Ft(t){let e,n,r=t[0]&&Bt(t);return{c(){r&&r.c(),e=b()},m(t,o){r&&r.m(t,o),m(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&z(r,1)):(r=Bt(t),r.c(),z(r,1),r.m(e.parentNode,e)):r&&(U(),V(r,1,1,(()=>{r=null})),W())},i(t){n||(z(r),n=!0)},o(t){V(r),n=!1},d(t){r&&r.d(t),t&&p(e)}}}function Pt(t,e,n){let r,o,i,c,l,{track:a}=e;return E((()=>{const t=setInterval((()=>{var t,e,r;n(1,i=null===(t=null==a?void 0:a.getSettings)||void 0===t?void 0:t.call(a)),n(2,c=null===(e=null==a?void 0:a.getConstraints)||void 0===e?void 0:e.call(a)),n(3,l=null===(r=null==a?void 0:a.getCapabilities)||void 0===r?void 0:r.call(a))}),500);return()=>clearInterval(t)})),t.$$set=t=>{"track"in t&&n(0,a=t.track)},t.$$.update=()=>{1&t.$$.dirty&&n(4,r=null==a?void 0:a.getSettings().width),1&t.$$.dirty&&n(5,o=null==a?void 0:a.getSettings().height)},[a,i,c,l,r,o]}const qt=class extends et{constructor(t){super(),tt(this,t,Pt,Ft,i,{track:0})}};function Ht(t,e,n){const r=t.slice();return r[2]=e[n],r}function Ut(t){let e,n,r,o,i,c,l=t[0].constructor.name+"",a=t[1]?"active":"inactive",s=t[0].getTracks(),u=[];for(let e=0;e<s.length;e+=1)u[e]=Wt(Ht(t,s,e));const d=t=>V(u[t],1,1,(()=>{u[t]=null}));return{c(){e=v(l),n=v("\n    ("),r=v(a),o=v(")\n    ");for(let t=0;t<u.length;t+=1)u[t].c();i=b()},m(t,l){m(t,e,l),m(t,n,l),m(t,r,l),m(t,o,l);for(let e=0;e<u.length;e+=1)u[e].m(t,l);m(t,i,l),c=!0},p(t,n){if((!c||1&n)&&l!==(l=t[0].constructor.name+"")&&w(e,l),(!c||2&n)&&a!==(a=t[1]?"active":"inactive")&&w(r,a),1&n){let e;for(s=t[0].getTracks(),e=0;e<s.length;e+=1){const r=Ht(t,s,e);u[e]?(u[e].p(r,n),z(u[e],1)):(u[e]=Wt(r),u[e].c(),z(u[e],1),u[e].m(i.parentNode,i))}for(U(),e=s.length;e<u.length;e+=1)d(e);W()}},i(t){if(!c){for(let t=0;t<s.length;t+=1)z(u[t]);c=!0}},o(t){u=u.filter(Boolean);for(let t=0;t<u.length;t+=1)V(u[t]);c=!1},d(t){t&&p(e),t&&p(n),t&&p(r),t&&p(o),h(u,t),t&&p(i)}}}function Wt(t){let e,n;return e=new qt({props:{track:t[2]}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.track=t[2]),e.$set(r)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function zt(t){let e,n,r=t[0]&&Ut(t);return{c(){r&&r.c(),e=b()},m(t,o){r&&r.m(t,o),m(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&z(r,1)):(r=Ut(t),r.c(),z(r,1),r.m(e.parentNode,e)):r&&(U(),V(r,1,1,(()=>{r=null})),W())},i(t){n||(z(r),n=!0)},o(t){V(r),n=!1},d(t){r&&r.d(t),t&&p(e)}}}function Vt(t,e,n){let{stream:r}=e,o=null==r?void 0:r.active;return E((()=>{const t=setInterval((()=>{n(1,o=null==r?void 0:r.active)}),500);return()=>clearInterval(t)})),t.$$set=t=>{"stream"in t&&n(0,r=t.stream)},[r,o]}const Gt=class extends et{constructor(t){super(),tt(this,t,Vt,zt,i,{stream:0})}};function Xt(t,e,n){const r=t.slice();return r[27]=e[n],r}function Kt(t,e,n){const r=t.slice();return r[30]=e[n],r[32]=n,r}function Qt(t){let e,n,r,o,i,c=(t[30].label||`camera ${t[32]}`)+"";function l(){return t[14](t[30])}return{c(){e=g("button"),n=v(c),r=$(),k(e,"class","svelte-vk2oy1")},m(t,c){m(t,e,c),f(e,n),f(e,r),o||(i=y(e,"click",l),o=!0)},p(e,r){t=e,8&r[0]&&c!==(c=(t[30].label||`camera ${t[32]}`)+"")&&w(n,c)},d(t){t&&p(e),o=!1,i()}}}function Yt(t){let e;return{c(){e=v("✔️")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Zt(t){let e;return{c(){e=v("(canvas)")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function te(t){let e,n,o,i,c,l,a,s,u,d,h,b,x,C,S,T,E,_=t[27].name+"",N=t[5](t[27]),R=t[1]===t[27]&&Yt();function O(){return t[15](t[27])}function L(){return t[16](t[27])}function D(){return t[17](t[27])}let M=N&&Zt();return{c(){e=g("tr"),n=g("td"),R&&R.c(),o=$(),i=g("td"),c=g("button"),l=v(_),a=$(),s=g("td"),u=g("button"),u.textContent="stop",d=$(),h=g("td"),b=g("button"),b.textContent="X",x=$(),C=g("td"),M&&M.c(),S=$(),k(c,"class","svelte-vk2oy1"),k(u,"class","svelte-vk2oy1"),k(b,"class","svelte-vk2oy1")},m(t,r){m(t,e,r),f(e,n),R&&R.m(n,null),f(e,o),f(e,i),f(i,c),f(c,l),f(e,a),f(e,s),f(s,u),f(e,d),f(e,h),f(h,b),f(e,x),f(e,C),M&&M.m(C,null),f(e,S),T||(E=[y(c,"click",O),y(u,"click",L),y(b,"click",D)],T=!0)},p(e,r){(t=e)[1]===t[27]?R||(R=Yt(),R.c(),R.m(n,null)):R&&(R.d(1),R=null),16&r[0]&&_!==(_=t[27].name+"")&&w(l,_),16&r[0]&&(N=t[5](t[27])),N?M||(M=Zt(),M.c(),M.m(C,null)):M&&(M.d(1),M=null)},d(t){t&&p(e),R&&R.d(),M&&M.d(),T=!1,r(E)}}}function ee(t){let e,n,r,o;return r=new Gt({props:{stream:t[1]}}),{c(){e=g("h5"),e.textContent="current stream",n=$(),Q(r.$$.fragment)},m(t,i){m(t,e,i),m(t,n,i),Y(r,t,i),o=!0},p(t,e){const n={};2&e[0]&&(n.stream=t[1]),r.$set(n)},i(t){o||(z(r.$$.fragment,t),o=!0)},o(t){V(r.$$.fragment,t),o=!1},d(t){t&&p(e),t&&p(n),Z(r,t)}}}function ne(t){let e,n,o,i,c,l,a,s,u,d,v,b,w,x,C,S,T,E,_=t[3],N=[];for(let e=0;e<_.length;e+=1)N[e]=Qt(Kt(t,_,e));let R=t[4],O=[];for(let e=0;e<R.length;e+=1)O[e]=te(Xt(t,R,e));let L=t[1]&&ee(t);return{c(){e=g("details"),n=g("summary"),n.innerHTML="<h5>video</h5>",o=$(),i=g("video"),i.innerHTML='<track kind="captions"/>',c=$(),l=g("nav"),a=g("button"),a.textContent="default",s=$(),u=g("button"),u.textContent="noise",d=$(),v=g("br"),b=$();for(let t=0;t<N.length;t+=1)N[t].c();w=$(),x=g("table");for(let t=0;t<O.length;t+=1)O[t].c();C=$(),L&&L.c(),k(i,"id","upstream"),i.autoplay="true",k(i,"class","svelte-vk2oy1"),k(a,"class","svelte-vk2oy1"),k(u,"class","svelte-vk2oy1"),k(l,"class","svelte-vk2oy1")},m(r,p){m(r,e,p),f(e,n),f(e,o),f(e,i),t[11](i),f(e,c),f(e,l),f(l,a),f(l,s),f(l,u),f(l,d),f(l,v),f(l,b);for(let t=0;t<N.length;t+=1)N[t].m(l,null);f(e,w),f(e,x);for(let t=0;t<O.length;t+=1)O[t].m(x,null);f(e,C),L&&L.m(e,null),e.open=t[0],S=!0,T||(E=[y(a,"click",t[12]),y(u,"click",t[13]),y(e,"toggle",t[18])],T=!0)},p(t,n){if(136&n[0]){let e;for(_=t[3],e=0;e<_.length;e+=1){const r=Kt(t,_,e);N[e]?N[e].p(r,n):(N[e]=Qt(r),N[e].c(),N[e].m(l,null))}for(;e<N.length;e+=1)N[e].d(1);N.length=_.length}if(1842&n[0]){let e;for(R=t[4],e=0;e<R.length;e+=1){const r=Xt(t,R,e);O[e]?O[e].p(r,n):(O[e]=te(r),O[e].c(),O[e].m(x,null))}for(;e<O.length;e+=1)O[e].d(1);O.length=R.length}t[1]?L?(L.p(t,n),2&n[0]&&z(L,1)):(L=ee(t),L.c(),z(L,1),L.m(e,null)):L&&(U(),V(L,1,1,(()=>{L=null})),W()),1&n[0]&&(e.open=t[0])},i(t){S||(z(L),S=!0)},o(t){V(L),S=!1},d(n){n&&p(e),t[11](null),h(N,n),h(O,n),L&&L.d(),T=!1,r(E)}}}function re(t,e,n){let r,o,i;var c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function l(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}a((r=r.apply(t,e||[])).next())}))};let{open:l}=e;const a=_();let s,u,d=[],f=[];function m(){return c(this,void 0,void 0,(function*(){const t=yield function(){let t=Object.assign(document.createElement("canvas"),{width:400,height:300}),e=t.getContext("2d");e.fillRect(0,0,t.width,t.height);let n=e.getImageData(0,0,t.width,t.height);return requestAnimationFrame((function t(){for(var r=0;r<n.data.length;r++)n.data[r++]=n.data[r++]=n.data[r++]=255*Math.random();e.putImageData(n,0,0),requestAnimationFrame(t)})),t.captureStream(60)}();t.name="noise feed",h(t),n(4,f=[...f,t])}))}function p(t){return c(this,void 0,void 0,(function*(){const e=yield function(t){return c(this,void 0,void 0,(function*(){const e={video:!t||{deviceId:t}};return yield navigator.mediaDevices.getUserMedia(e)}))}(t);e.name=t?function(t){const e=t&&d.find((({deviceId:e})=>e===t));return e&&e.label}(t):"default webcam",h(e),n(4,f=[...f,e])}))}function h(t){n(1,u=t),n(2,s.srcObject=t,s),a("stream",t)}function g(t){t.getTracks().forEach((t=>t.stop())),a("stop",t)}function v(t){g(t),n(4,f=[...f.filter((e=>e!=t))]),u===t&&n(1,u=void 0)}function $(){return c(this,void 0,void 0,(function*(){const t=yield navigator.mediaDevices.enumerateDevices();n(3,d=t.filter((({kind:t})=>"videoinput"===t)))}))}return E((()=>{$();const t=()=>$();return navigator.mediaDevices.addEventListener("devicechange",t),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}})),t.$$set=t=>{"open"in t&&n(0,l=t.open)},t.$$.update=()=>{2&t.$$.dirty[0]&&(r=null==u?void 0:u.getTracks()[0]),2&t.$$.dirty[0]&&(o=null==u?void 0:u.constructor.name),2&t.$$.dirty[0]&&(i=null==u?void 0:u.getTracks()[0])},[l,u,s,d,f,t=>"CanvasCaptureMediaStream"===(null==t?void 0:t.constructor.name)||"CanvasCaptureMediaStreamTrack"===(null==t?void 0:t.getTracks()[0].constructor.name),m,p,h,g,v,function(t){R[t?"unshift":"push"]((()=>{s=t,n(2,s)}))},()=>p(),()=>m(),t=>p(t.deviceId),t=>h(t),t=>g(t),t=>v(t),function(){l=this.open,n(0,l)}]}const oe=class extends et{constructor(t){super(),tt(this,t,re,ne,i,{open:0},[-1,-1])}};function ie(t){let e,n;return e=new qt({props:{track:t[1]}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},p(t,n){const r={};2&n&&(r.track=t[1]),e.$set(r)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function ce(t){let e,n,r,o,i,c,l,a=t[1]&&ie(t);return{c(){e=g("h5"),e.textContent="downstream",n=$(),r=g("video"),r.innerHTML='<track kind="captions"/>',i=$(),a&&a.c(),c=b(),r.autoplay=o=!0},m(o,s){m(o,e,s),m(o,n,s),m(o,r,s),t[3](r),m(o,i,s),a&&a.m(o,s),m(o,c,s),l=!0},p(t,[e]){t[1]?a?(a.p(t,e),2&e&&z(a,1)):(a=ie(t),a.c(),z(a,1),a.m(c.parentNode,c)):a&&(U(),V(a,1,1,(()=>{a=null})),W())},i(t){l||(z(a),l=!0)},o(t){V(a),l=!1},d(o){o&&p(e),o&&p(n),o&&p(r),t[3](null),o&&p(i),a&&a.d(o),o&&p(c)}}}function le(t,e,n){let r,o,{stream:i}=e;return t.$$set=t=>{"stream"in t&&n(2,i=t.stream)},t.$$.update=()=>{4&t.$$.dirty&&n(1,r=i&&i.getTracks()[0]),5&t.$$.dirty&&o&&n(0,o.srcObject=i,o)},[o,r,i,function(t){R[t?"unshift":"push"]((()=>{o=t,n(0,o),n(2,i)}))}]}const ae=class extends et{constructor(t){super(),tt(this,t,le,ce,i,{stream:2})}};function se(e){let n,o,i,c,l,a,s;return{c(){n=g("form"),o=g("input"),i=$(),c=g("code"),l=v(e[0]),k(o,"size","90"),k(o,"placeholder","ws url")},m(t,r){var u;m(t,n,r),f(n,o),x(o,e[1]),m(t,i,r),m(t,c,r),f(c,l),a||(s=[y(o,"input",e[2]),y(n,"submit",(u=ue,function(t){return t.preventDefault(),u.call(this,t)}))],a=!0)},p(t,[e]){2&e&&o.value!==t[1]&&x(o,t[1]),1&e&&w(l,t[0])},i:t,o:t,d(t){t&&p(n),t&&p(i),t&&p(c),a=!1,r(s)}}}function ue(){}function de(t,e,n){let r,{signalingClient:o}=e;return t.$$set=t=>{"signalingClient"in t&&n(0,o=t.signalingClient)},t.$$.update=()=>{3&t.$$.dirty&&(o.connect({url:r}),window.client=o)},n(1,r=`wss://${window.location.host}/signaling/test`),[o,r,function(){r=this.value,n(1,r)}]}const fe=class extends et{constructor(t){super(),tt(this,t,de,se,i,{signalingClient:0})}};function me(t){let e,n,r,o,i,c=t[0].state+"";return o=new It({props:{summary:"iceTransport",open:!1,data:t[1]}}),{c(){e=v("state: "),n=v(c),r=$(),Q(o.$$.fragment)},m(t,c){m(t,e,c),m(t,n,c),m(t,r,c),Y(o,t,c),i=!0},p(t,e){(!i||1&e)&&c!==(c=t[0].state+"")&&w(n,c);const r={};1&e&&(r.data=t[1]),o.$set(r)},i(t){i||(z(o.$$.fragment,t),i=!0)},o(t){V(o.$$.fragment,t),i=!1},d(t){t&&p(e),t&&p(n),t&&p(r),Z(o,t)}}}function pe(t){let e,n,r=t[0]&&me(t);return{c(){r&&r.c(),e=b()},m(t,o){r&&r.m(t,o),m(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&z(r,1)):(r=me(t),r.c(),z(r,1),r.m(e.parentNode,e)):r&&(U(),V(r,1,1,(()=>{r=null})),W())},i(t){n||(z(r),n=!0)},o(t){V(r),n=!1},d(t){r&&r.d(t),t&&p(e)}}}function he(t,e,n){let{transport:r}=e;return t.$$set=t=>{"transport"in t&&n(0,r=t.transport)},[r,()=>({role:r.iceTransport.role,component:r.iceTransport.component,state:r.iceTransport.state,gatheringState:r.iceTransport.gatheringState})]}const ge=class extends et{constructor(t){super(),tt(this,t,he,pe,i,{transport:0})}};function ve(t){let e,n,r,o,i,c,l=t[0]&&$e(t);return{c(){e=g("details"),n=g("summary"),n.textContent="Receiver",r=$(),l&&l.c()},m(a,s){m(a,e,s),f(e,n),f(e,r),l&&l.m(e,null),e.open=t[0],o=!0,i||(c=y(e,"toggle",t[5]),i=!0)},p(t,n){t[0]?l?(l.p(t,n),1&n&&z(l,1)):(l=$e(t),l.c(),z(l,1),l.m(e,null)):l&&(U(),V(l,1,1,(()=>{l=null})),W()),1&n&&(e.open=t[0])},i(t){o||(z(l),o=!0)},o(t){V(l),o=!1},d(t){t&&p(e),l&&l.d(),i=!1,c()}}}function $e(t){let e,n,r,o,i,c,l,a,s,u,d,h,b,y,x,C,S,T,E,_,N,R,O,L,D,M,A,j,I,B,J,F,P,q=JSON.stringify(t[4])+"",H=JSON.stringify(t[3])+"";return c=new qt({props:{track:t[1].track}}),h=new It({props:{summary:"verbose",data:t[2],open:!1}}),T=new ge({props:{transport:t[1].transport}}),{c(){e=g("table"),n=g("tr"),r=g("th"),r.textContent="track",o=$(),i=g("td"),Q(c.$$.fragment),l=$(),a=g("tr"),s=g("th"),s.textContent="parameters",u=$(),d=g("td"),Q(h.$$.fragment),b=$(),y=g("tr"),x=g("th"),x.textContent="transport",C=$(),S=g("td"),Q(T.$$.fragment),E=$(),_=g("tr"),N=g("th"),N.textContent="ssrcs",R=$(),O=g("td"),L=g("code"),D=v(q),M=$(),A=g("tr"),j=g("th"),j.textContent="csrcs",I=$(),B=g("td"),J=g("code"),F=v(H),k(e,"class","vertical")},m(t,p){m(t,e,p),f(e,n),f(n,r),f(n,o),f(n,i),Y(c,i,null),f(e,l),f(e,a),f(a,s),f(a,u),f(a,d),Y(h,d,null),f(e,b),f(e,y),f(y,x),f(y,C),f(y,S),Y(T,S,null),f(e,E),f(e,_),f(_,N),f(_,R),f(_,O),f(O,L),f(L,D),f(e,M),f(e,A),f(A,j),f(A,I),f(A,B),f(B,J),f(J,F),P=!0},p(t,e){const n={};2&e&&(n.track=t[1].track),c.$set(n);const r={};4&e&&(r.data=t[2]),h.$set(r);const o={};2&e&&(o.transport=t[1].transport),T.$set(o),(!P||16&e)&&q!==(q=JSON.stringify(t[4])+"")&&w(D,q),(!P||8&e)&&H!==(H=JSON.stringify(t[3])+"")&&w(F,H)},i(t){P||(z(c.$$.fragment,t),z(h.$$.fragment,t),z(T.$$.fragment,t),P=!0)},o(t){V(c.$$.fragment,t),V(h.$$.fragment,t),V(T.$$.fragment,t),P=!1},d(t){t&&p(e),Z(c),Z(h),Z(T)}}}function be(t){let e,n,r=t[1]&&ve(t);return{c(){r&&r.c(),e=b()},m(t,o){r&&r.m(t,o),m(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&z(r,1)):(r=ve(t),r.c(),z(r,1),r.m(e.parentNode,e)):r&&(U(),V(r,1,1,(()=>{r=null})),W())},i(t){n||(z(r),n=!0)},o(t){V(r),n=!1},d(t){r&&r.d(t),t&&p(e)}}}function ye(t,e,n){let r,o,i,{receiver:c}=e,{open:l=!1}=e;return E((()=>{const t=setInterval((()=>{var t;n(2,r=null===(t=null==c?void 0:c.getParameters)||void 0===t?void 0:t.call(c)),n(3,o=c.getContributingSources()),n(4,i=c.getSynchronizationSources())}),500);return()=>clearInterval(t)})),t.$$set=t=>{"receiver"in t&&n(1,c=t.receiver),"open"in t&&n(0,l=t.open)},[l,c,r,o,i,function(){l=this.open,n(0,l)}]}const ke=class extends et{constructor(t){super(),tt(this,t,ye,be,i,{receiver:1,open:0})}};function we(t){let e,n,r,o,i,c,l=t[0]&&xe(t);return{c(){e=g("details"),n=g("summary"),n.textContent="Sender",r=$(),l&&l.c()},m(a,s){m(a,e,s),f(e,n),f(e,r),l&&l.m(e,null),e.open=t[0],o=!0,i||(c=y(e,"toggle",t[8]),i=!0)},p(t,n){t[0]?l?(l.p(t,n),1&n&&z(l,1)):(l=xe(t),l.c(),z(l,1),l.m(e,null)):l&&(U(),V(l,1,1,(()=>{l=null})),W()),1&n&&(e.open=t[0])},i(t){o||(z(l),o=!0)},o(t){V(l),o=!1},d(t){t&&p(e),l&&l.d(),i=!1,c()}}}function xe(t){let e,n,o,i,c,l,a,s,u,d,h,b,w,x,C,S,T,E,_,N,R,O,L,D,M,A,j,I;l=new qt({props:{track:t[1].track}}),b=new It({props:{summary:"verbose",data:t[4],open:!1}}),E=new ge({props:{transport:t[1].transport}});let B=t[4]&&Ce(t);return{c(){e=g("table"),n=g("tr"),o=g("th"),o.textContent="track",i=$(),c=g("td"),Q(l.$$.fragment),a=$(),s=g("tr"),u=g("th"),u.textContent="parameters",d=$(),h=g("td"),Q(b.$$.fragment),w=$(),x=g("tr"),C=g("th"),C.textContent="transport",S=$(),T=g("td"),Q(E.$$.fragment),_=$(),B&&B.c(),N=$(),R=g("button"),O=v("replaceTrack"),D=$(),M=g("button"),M.textContent="remove",k(e,"class","vertical"),k(R,"class","btn-small"),R.disabled=L=!Boolean(t[2]),k(M,"class","btn-small")},m(r,p){m(r,e,p),f(e,n),f(n,o),f(n,i),f(n,c),Y(l,c,null),f(e,a),f(e,s),f(s,u),f(s,d),f(s,h),Y(b,h,null),f(e,w),f(e,x),f(x,C),f(x,S),f(x,T),Y(E,T,null),f(e,_),B&&B.m(e,null),m(r,N,p),m(r,R,p),f(R,O),m(r,D,p),m(r,M,p),A=!0,j||(I=[y(R,"click",t[6]),y(M,"click",t[7])],j=!0)},p(t,n){const r={};2&n&&(r.track=t[1].track),l.$set(r);const o={};16&n&&(o.data=t[4]),b.$set(o);const i={};2&n&&(i.transport=t[1].transport),E.$set(i),t[4]?B?B.p(t,n):(B=Ce(t),B.c(),B.m(e,null)):B&&(B.d(1),B=null),(!A||4&n&&L!==(L=!Boolean(t[2])))&&(R.disabled=L)},i(t){A||(z(l.$$.fragment,t),z(b.$$.fragment,t),z(E.$$.fragment,t),A=!0)},o(t){V(l.$$.fragment,t),V(b.$$.fragment,t),V(E.$$.fragment,t),A=!1},d(t){t&&p(e),Z(l),Z(b),Z(E),B&&B.d(),t&&p(N),t&&p(R),t&&p(D),t&&p(M),j=!1,r(I)}}}function Ce(t){let e,n,r,o,i,c,l,a,s,u,d,h,b,y=JSON.stringify(t[4].rtcp)+"",k=JSON.stringify(t[4].encodings)+"";return{c(){e=g("tr"),n=g("th"),n.textContent="rtcp",r=$(),o=g("td"),i=g("code"),c=v(y),l=$(),a=g("tr"),s=g("th"),s.textContent="encodings",u=$(),d=g("td"),h=g("code"),b=v(k)},m(t,p){m(t,e,p),f(e,n),f(e,r),f(e,o),f(o,i),f(i,c),m(t,l,p),m(t,a,p),f(a,s),f(a,u),f(a,d),f(d,h),f(h,b)},p(t,e){16&e&&y!==(y=JSON.stringify(t[4].rtcp)+"")&&w(c,y),16&e&&k!==(k=JSON.stringify(t[4].encodings)+"")&&w(b,k)},d(t){t&&p(e),t&&p(l),t&&p(a)}}}function Se(t){let e,n,r=t[1]&&we(t);return{c(){r&&r.c(),e=b()},m(t,o){r&&r.m(t,o),m(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&z(r,1)):(r=we(t),r.c(),z(r,1),r.m(e.parentNode,e)):r&&(U(),V(r,1,1,(()=>{r=null})),W())},i(t){n||(z(r),n=!0)},o(t){V(r),n=!1},d(t){r&&r.d(t),t&&p(e)}}}function Te(t,e,n){let r,{sender:o}=e,{open:i=!1}=e,{mediaStream:c}=e,{onRemove:l=(()=>console.warn("no callback"))}=e;function a(t,e){dt("rts","replace track per sender"),console.info("replace track",{sender:e}),e.replaceTrack(t.getTracks()[0])}return E((()=>{const t=setInterval((()=>{var t;n(4,r=null===(t=null==o?void 0:o.getParameters)||void 0===t?void 0:t.call(o))}),500);return()=>clearInterval(t)})),t.$$set=t=>{"sender"in t&&n(1,o=t.sender),"open"in t&&n(0,i=t.open),"mediaStream"in t&&n(2,c=t.mediaStream),"onRemove"in t&&n(3,l=t.onRemove)},[i,o,c,l,r,a,()=>a(c,o),()=>l(o),function(){i=this.open,n(0,i)}]}const Ee=class extends et{constructor(t){super(),tt(this,t,Te,Se,i,{sender:1,open:0,mediaStream:2,onRemove:3})}},{Boolean:_e}=G;function Ne(t,e,n){const r=t.slice();return r[17]=e[n],r[18]=e,r[19]=n,r}function Re(t,e,n){const r=t.slice();return r[20]=e[n],r}function Oe(t){let e,n,r=t[1],o=[];for(let e=0;e<r.length;e+=1)o[e]=je(Ne(t,r,e));const i=t=>V(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=b()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);m(t,e,r),n=!0},p(t,n){if(59&n){let c;for(r=t[1],c=0;c<r.length;c+=1){const i=Ne(t,r,c);o[c]?(o[c].p(i,n),z(o[c],1)):(o[c]=je(i),o[c].c(),z(o[c],1),o[c].m(e.parentNode,e))}for(U(),c=r.length;c<o.length;c+=1)i(c);W()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)z(o[t]);n=!0}},o(t){o=o.filter(_e);for(let t=0;t<o.length;t+=1)V(o[t]);n=!1},d(t){h(o,t),t&&p(e)}}}function Le(t){let e,n,i,c,l,a,s,u,d,b,x,C,S,T,E,_,N,R,O,L,D,M,A,j,I,B,J,F,P,q,H,G,X,K,tt,et,nt,rt,ot,it,ct,lt=t[17].mid+"",at=t[17].currentDirection+"",st=t[4].has(t[17]),ut=t[4].has(t[17]),dt=["sendrecv","sendonly","recvonly","inactive"],ft=[];for(let e=0;e<4;e+=1)ft[e]=De(Re(t,dt,e));function mt(...e){return t[9](t[17],t[18],t[19],...e)}let pt=st&&Me(t);function ht(){return t[10](t[17])}j=new Ee({props:{sender:t[17].sender}}),F=new ke({props:{receiver:t[17].receiver}});let gt=ut&&Ae(t);function vt(){return t[12](t[17])}function $t(){return t[13](t[17])}return{c(){e=g("div"),n=g("table"),i=g("tr"),c=g("th"),c.textContent="mid",l=$(),a=g("td"),s=g("code"),u=v(lt),d=$(),b=g("tr"),x=g("th"),x.textContent="direction",C=$(),S=g("td"),T=g("select");for(let t=0;t<4;t+=1)ft[t].c();E=$(),_=g("strong"),N=v("→ "),R=g("code"),O=v(at),L=$(),pt&&pt.c(),D=$(),M=g("hr"),A=$(),Q(j.$$.fragment),I=$(),B=g("hr"),J=$(),Q(F.$$.fragment),P=$(),q=g("div"),H=g("button"),H.textContent="replaceTrack",G=$(),X=g("button"),X.textContent="replaceTrack(null)",K=$(),gt&&gt.c(),tt=$(),et=g("button"),et.textContent="stop",nt=$(),rt=g("button"),rt.textContent="removeTrack",k(c,"class","svelte-5ps5s4"),k(x,"class","svelte-5ps5s4"),k(n,"class","vertical"),k(H,"class","btn-small"),k(X,"class","btn-small"),k(et,"class","btn-small"),k(rt,"class","btn-small")},m(r,p){m(r,e,p),f(e,n),f(n,i),f(i,c),f(i,l),f(i,a),f(a,s),f(s,u),f(n,d),f(n,b),f(b,x),f(b,C),f(b,S),f(S,T);for(let t=0;t<4;t+=1)ft[t].m(T,null);f(S,E),f(S,_),f(_,N),f(_,R),f(R,O),f(n,L),pt&&pt.m(n,null),f(e,D),f(e,M),f(e,A),Y(j,e,null),f(e,I),f(e,B),f(e,J),Y(F,e,null),m(r,P,p),m(r,q,p),f(q,H),f(q,G),f(q,X),f(q,K),gt&&gt.m(q,null),f(q,tt),f(q,et),f(q,nt),f(q,rt),ot=!0,it||(ct=[y(T,"change",mt),y(H,"click",(function(){o(t[5](t[17].sender))&&t[5](t[17].sender).apply(this,arguments)})),y(X,"click",ht),y(et,"click",vt),y(rt,"click",$t)],it=!0)},p(e,r){if(t=e,(!ot||2&r)&&lt!==(lt=t[17].mid+"")&&w(u,lt),2&r){let e;for(dt=["sendrecv","sendonly","recvonly","inactive"],e=0;e<4;e+=1){const n=Re(t,dt,e);ft[e]?ft[e].p(n,r):(ft[e]=De(n),ft[e].c(),ft[e].m(T,null))}for(;e<4;e+=1)ft[e].d(1)}(!ot||2&r)&&at!==(at=t[17].currentDirection+"")&&w(O,at),2&r&&(st=t[4].has(t[17])),st?pt?(pt.p(t,r),2&r&&z(pt,1)):(pt=Me(t),pt.c(),z(pt,1),pt.m(n,null)):pt&&(U(),V(pt,1,1,(()=>{pt=null})),W());const o={};2&r&&(o.sender=t[17].sender),j.$set(o);const i={};2&r&&(i.receiver=t[17].receiver),F.$set(i),2&r&&(ut=t[4].has(t[17])),ut?gt?gt.p(t,r):(gt=Ae(t),gt.c(),gt.m(q,tt)):gt&&(gt.d(1),gt=null)},i(t){ot||(z(pt),z(j.$$.fragment,t),z(F.$$.fragment,t),ot=!0)},o(t){V(pt),V(j.$$.fragment,t),V(F.$$.fragment,t),ot=!1},d(t){t&&p(e),h(ft,t),pt&&pt.d(),Z(j),Z(F),t&&p(P),t&&p(q),gt&&gt.d(),it=!1,r(ct)}}}function De(t){let e,n,r,o;return{c(){e=g("option"),n=v(t[20]),e.__value=r=t[20],e.value=e.__value,e.selected=o=t[20]===t[17].currentDirection||"inactive"===t[20]&&null===t[17].currentDirection},m(t,r){m(t,e,r),f(e,n)},p(t,n){2&n&&o!==(o=t[20]===t[17].currentDirection||"inactive"===t[20]&&null===t[17].currentDirection)&&(e.selected=o)},d(t){t&&p(e)}}}function Me(t){let e,n,r,o,i,c;return i=new qt({props:{track:t[4].get(t[17])}}),{c(){e=g("tr"),n=g("th"),n.textContent="track",r=$(),o=g("td"),Q(i.$$.fragment),k(n,"class","svelte-5ps5s4")},m(t,l){m(t,e,l),f(e,n),f(e,r),f(e,o),Y(i,o,null),c=!0},p(t,e){const n={};2&e&&(n.track=t[4].get(t[17])),i.$set(n)},i(t){c||(z(i.$$.fragment,t),c=!0)},o(t){V(i.$$.fragment,t),c=!1},d(t){t&&p(e),Z(i)}}}function Ae(t){let e,n,r;function o(){return t[11](t[17])}return{c(){e=g("button"),e.textContent="display track",k(e,"class","btn-small")},m(t,i){m(t,e,i),n||(r=y(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&p(e),n=!1,r()}}}function je(t){let e,n,r,o=(null!==t[17].mid||t[17].track,Le(t));return{c(){e=g("div"),o&&o.c(),n=$(),k(e,"class","grid box svelte-5ps5s4")},m(t,i){m(t,e,i),o&&o.m(e,null),f(e,n),r=!0},p(t,r){null!==t[17].mid||t[17].track,o?(o.p(t,r),2&r&&z(o,1)):(o=Le(t),o.c(),z(o,1),o.m(e,n))},i(t){r||(z(o),r=!0)},o(t){V(o),r=!1},d(t){t&&p(e),o&&o.d()}}}function Ie(t){let e,n,o,i,c,l,a,s,u,d,h,v=t[1]&&Oe(t);return{c(){e=g("details"),n=g("summary"),n.innerHTML="<h5>transceivers</h5>",o=$(),v&&v.c(),i=$(),c=g("button"),c.textContent="add video transceiver",l=$(),a=g("button"),a.textContent="update",k(a,"class","btn-small"),e.open=s=Boolean(t[2].showTransceivers)},m(r,s){m(r,e,s),f(e,n),f(e,o),v&&v.m(e,null),f(e,i),f(e,c),f(e,l),f(e,a),u=!0,d||(h=[y(c,"click",t[6]),y(a,"click",t[7])],d=!0)},p(t,[n]){t[1]?v?(v.p(t,n),2&n&&z(v,1)):(v=Oe(t),v.c(),z(v,1),v.m(e,i)):v&&(U(),V(v,1,1,(()=>{v=null})),W()),(!u||4&n&&s!==(s=Boolean(t[2].showTransceivers)))&&(e.open=s)},i(t){u||(z(v),u=!0)},o(t){V(v),u=!1},d(t){t&&p(e),v&&v.d(),d=!1,r(h)}}}function Be(t,e,n){let r,o;a(t,st,(t=>n(2,o=t)));var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function l(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}a((r=r.apply(t,e||[])).next())}))};let{peerconnection:c}=e,{streamSource:l}=e;const s=_();let u;const d=new Map;function f(){n(1,u=c&&c.getTransceivers())}return E((()=>i(void 0,void 0,void 0,(function*(){const t=setInterval((()=>{r&&f()}),1e3);return yield(A(),D),c.addEventListener("track",(({track:t,transceiver:e,streams:n})=>{n[0]||new MediaStream([t]),d.set(e,t),f()})),()=>clearInterval(t)})))),t.$$set=t=>{"peerconnection"in t&&n(0,c=t.peerconnection),"streamSource"in t&&n(8,l=t.streamSource)},t.$$.update=()=>{1&t.$$.dirty&&(r=c&&c.getTransceivers())},[c,u,o,s,d,function(t){return()=>{const e=l().getTracks()[0];e&&t.replaceTrack(e)}},function(){c.addTransceiver("video"),r=c.getTransceivers(),f()},f,l,(t,e,r,{target:o})=>n(1,e[r].direction=o.value,u),t=>t.sender.replaceTrack(null),t=>s("track",d.get(t)),t=>t.stop(),t=>c.removeTrack(t.sender)]}const Je=class extends et{constructor(t){super(),tt(this,t,Be,Ie,i,{peerconnection:0,streamSource:8})}};function Fe(t){let e,n,r,o,i,c,l,a,s,u,d,h,b,S,T,E,_,N,R,O=t[4].join(", ")+"";return{c(){e=g("textarea"),n=$(),r=g("div"),o=g("table"),i=g("tr"),c=g("th"),c.textContent="mlines",l=$(),a=g("td"),s=g("code"),u=v(t[5]),d=$(),h=g("tr"),b=g("th"),b.textContent="directions",S=$(),T=g("td"),E=g("code"),_=v(O),k(e,"rows",t[1]),k(e,"name",t[2]),k(e,"class","svelte-1n5wbpe"),C(e,"hideSignaling",t[3]),k(o,"class","vertical"),k(r,"class","box")},m(p,g){m(p,e,g),x(e,t[0]),m(p,n,g),m(p,r,g),f(r,o),f(o,i),f(i,c),f(i,l),f(i,a),f(a,s),f(s,u),f(o,d),f(o,h),f(h,b),f(h,S),f(h,T),f(T,E),f(E,_),N||(R=y(e,"input",t[7]),N=!0)},p(t,n){2&n&&k(e,"rows",t[1]),4&n&&k(e,"name",t[2]),1&n&&x(e,t[0]),8&n&&C(e,"hideSignaling",t[3]),32&n&&w(u,t[5]),16&n&&O!==(O=t[4].join(", ")+"")&&w(_,O)},d(t){t&&p(e),t&&p(n),t&&p(r),N=!1,R()}}}function Pe(e){let n,r=!e[3]&&Fe(e);return{c(){n=g("div"),r&&r.c()},m(t,e){m(t,n,e),r&&r.m(n,null)},p(t,[e]){t[3]?r&&(r.d(1),r=null):r?r.p(t,e):(r=Fe(t),r.c(),r.m(n,null))},i:t,o:t,d(t){t&&p(n),r&&r.d()}}}function qe(t,e,n){let r,o,i,{value:c}=e,{rows:l}=e,{name:a}=e,{hideSignaling:s}=e;return t.$$set=t=>{"value"in t&&n(0,c=t.value),"rows"in t&&n(1,l=t.rows),"name"in t&&n(2,a=t.name),"hideSignaling"in t&&n(3,s=t.hideSignaling)},t.$$.update=()=>{1&t.$$.dirty&&n(6,r=c.split("\n")),64&t.$$.dirty&&n(5,o=r.filter((t=>t.startsWith("m="))).length),64&t.$$.dirty&&n(4,i=Array.from(r.filter((t=>t.startsWith("a=sendrecv")||t.startsWith("a=sendonly")||t.startsWith("a=recvonly")||t.startsWith("a=inactive"))),(t=>null==t?void 0:t.slice(2))))},[c,l,a,s,i,o,r,function(){c=this.value,n(0,c)}]}const He=class extends et{constructor(t){super(),tt(this,t,qe,Pe,i,{value:0,rows:1,name:2,hideSignaling:3})}};function Ue(t,e,n){const r=t.slice();return r[35]=e[n],r}function We(t,e,n){const r=t.slice();return r[38]=e[n],r[40]=n,r}function ze(t){let e,n,r,o,i=(t[38].label||`micorophone ${t[40]}`)+"";function c(){return t[14](t[38])}return{c(){e=g("button"),n=v(i),k(e,"class","svelte-2jsuhx")},m(t,i){m(t,e,i),f(e,n),r||(o=y(e,"click",c),r=!0)},p(e,r){t=e,8&r[0]&&i!==(i=(t[38].label||`micorophone ${t[40]}`)+"")&&w(n,i)},d(t){t&&p(e),r=!1,o()}}}function Ve(t){let e;return{c(){e=v("✔️")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Ge(t){let e,n,o,i,c,l,a,s,u,d,h,b,x,C,S,T=t[35].name+"",E=t[2]===t[35]&&Ve();function _(){return t[19](t[35])}function N(){return t[20](t[35])}function R(){return t[21](t[35])}return{c(){e=g("tr"),n=g("td"),E&&E.c(),o=$(),i=g("td"),c=g("button"),l=v(T),a=$(),s=g("td"),u=g("button"),u.textContent="stop",d=$(),h=g("td"),b=g("button"),b.textContent="X",x=$(),k(c,"class","svelte-2jsuhx"),k(u,"class","svelte-2jsuhx"),k(b,"class","svelte-2jsuhx")},m(t,r){m(t,e,r),f(e,n),E&&E.m(n,null),f(e,o),f(e,i),f(i,c),f(c,l),f(e,a),f(e,s),f(s,u),f(e,d),f(e,h),f(h,b),f(e,x),C||(S=[y(c,"click",_),y(u,"click",N),y(b,"click",R)],C=!0)},p(e,r){(t=e)[2]===t[35]?E||(E=Ve(),E.c(),E.m(n,null)):E&&(E.d(1),E=null),16&r[0]&&T!==(T=t[35].name+"")&&w(l,T)},d(t){t&&p(e),E&&E.d(),C=!1,r(S)}}}function Xe(e){let n,o,i,c,l,a,s,u,d,v,b,w,x,C,S,T,E,_,N,R,O,L=e[3],D=[];for(let t=0;t<L.length;t+=1)D[t]=ze(We(e,L,t));let M=e[4],A=[];for(let t=0;t<M.length;t+=1)A[t]=Ge(Ue(e,M,t));return{c(){n=g("details"),o=g("summary"),o.innerHTML="<h5>audio</h5>",i=$(),c=g("canvas"),l=$(),a=g("nav");for(let t=0;t<D.length;t+=1)D[t].c();s=$(),u=g("audio"),d=g("track"),w=$(),x=g("button"),x.textContent="bars",C=$(),S=g("button"),S.textContent="waveform",T=$(),E=g("button"),E.textContent="volume",_=$(),N=g("table");for(let t=0;t<A.length;t+=1)A[t].c();k(d,"kind","captions"),k(u,"id","upstream"),u.autoplay=v=!1,u.controls=b=Boolean(e[2]),k(a,"class","svelte-2jsuhx"),k(x,"class","svelte-2jsuhx"),k(S,"class","svelte-2jsuhx"),k(E,"class","svelte-2jsuhx")},m(t,r){m(t,n,r),f(n,o),f(n,i),f(n,c),e[13](c),f(n,l),f(n,a);for(let t=0;t<D.length;t+=1)D[t].m(a,null);f(a,s),f(a,u),f(u,d),e[15](u),f(n,w),f(n,x),f(n,C),f(n,S),f(n,T),f(n,E),f(n,_),f(n,N);for(let t=0;t<A.length;t+=1)A[t].m(N,null);n.open=e[0],R||(O=[y(x,"click",e[16]),y(S,"click",e[17]),y(E,"click",e[18]),y(n,"toggle",e[22])],R=!0)},p(t,e){if(520&e[0]){let n;for(L=t[3],n=0;n<L.length;n+=1){const r=We(t,L,n);D[n]?D[n].p(r,e):(D[n]=ze(r),D[n].c(),D[n].m(a,s))}for(;n<D.length;n+=1)D[n].d(1);D.length=L.length}if(4&e[0]&&b!==(b=Boolean(t[2]))&&(u.controls=b),7188&e[0]){let n;for(M=t[4],n=0;n<M.length;n+=1){const r=Ue(t,M,n);A[n]?A[n].p(r,e):(A[n]=Ge(r),A[n].c(),A[n].m(N,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=M.length}1&e[0]&&(n.open=t[0])},i:t,o:t,d(t){t&&p(n),e[13](null),h(D,t),e[15](null),h(A,t),R=!1,r(O)}}}function Ke(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function l(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}a((r=r.apply(t,e||[])).next())}))};let{open:o}=e;const i=_();let c,l,a,s,u,d,f,m=[],p=[];function h(){d&&d.stop(),d=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Uint8Array(r);let i;function c(){t.getByteTimeDomainData(o),n.fillStyle="rgb(0, 0, 0)",n.fillRect(0,0,e.width,e.height),n.lineWidth=2,n.strokeStyle="rgb(255, 255, 255)",n.beginPath();let l=1*e.width/r,a=0;for(let t=0;t<r;t++){const r=o[t]/128*e.height/2;0===t?n.moveTo(a,r):n.lineTo(a,r),a+=l}n.lineTo(e.width,e.height/2),n.stroke(),i=requestAnimationFrame(c)}return{start(){void 0===i&&c()},stop(){cancelAnimationFrame(i),i=void 0}}}({analyser:u,canvas:a}),d.start()}function g(){d&&d.stop(),d=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Float32Array(r);let i;const{width:c,height:l}=e;function a(){t.getFloatFrequencyData(o),n.fillStyle="rgb(0, 0, 0)",n.fillRect(0,0,c,l);for(var e,s=c/r*2.5,u=0,d=0;d<r;d++)e=2*(o[d]+140),n.fillStyle="rgb("+Math.floor(e+100)+",50,50)",n.fillRect(u,l-e/2,s,e/2),u+=s+1;i=requestAnimationFrame(a)}return{start(){void 0===i&&a()},stop(){cancelAnimationFrame(i),i=void 0}}}({analyser:u,canvas:a}),d.start()}function v(){d&&d.stop(),d=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Uint8Array(r);let i;function c(){t.getByteTimeDomainData(o),n.fillStyle="rgba(0, 0, 0, 0.1)",n.fillRect(0,0,e.width,e.height),n.font="15px sans-serif",n.strokeStyle="rgb(255, 255, 255)";let l=0;n.lineWidth=5;for(let t=0;t<r;t++){const n=o[t]/128*e.height/2;n>l&&(l=n)}let a=2*(l-75),s=e.height-a;n.beginPath(),n.moveTo(0,s),n.lineTo(e.width,s),n.stroke(),n.fillStyle="rgb(100,255,100)",n.fillRect(0,e.height,e.width,-e.height+s),n.fillStyle="rgb(0,0,0)",n.fillText(String(a),e.width-40,e.height-10),i=requestAnimationFrame(c)}return{start(){void 0===i&&c()},stop(){cancelAnimationFrame(i),i=void 0}}}({analyser:u,canvas:a}),d.start()}function $(){return r(this,void 0,void 0,(function*(){const t=yield navigator.mediaDevices.enumerateDevices();n(3,m=t.filter((({kind:t})=>"audioinput"===t)))}))}function b(t){return r(this,void 0,void 0,(function*(){const e=yield function(t){return r(this,void 0,void 0,(function*(){const e={audio:!t||{deviceId:t}};return yield navigator.mediaDevices.getUserMedia(e)}))}(t);e.name=function(t){const e=t&&m.find((({deviceId:e})=>e===t));return e&&e.label}(t),y(e),n(4,p=[...p,e])}))}function y(t){n(2,l=t),n(1,c.srcObject=t,c),function(t){console.debug("disconnecting",f),null==f||f.disconnect(u),f=void 0;const e=s.createMediaStreamSource(t);e.connect(u),f=e}(t),i("stream",t)}function k(t){t.getTracks().forEach((t=>t.stop())),i("stop",t)}function w(t){k(t),n(4,p=[...p.filter((e=>e!=t))]),l===t&&n(2,l=void 0)}return E((()=>{$();const t=()=>$();return navigator.mediaDevices.addEventListener("devicechange",t),s||(s=new AudioContext,u=s.createAnalyser(),u.fftSize=2048),v(),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}})),t.$$set=t=>{"open"in t&&n(0,o=t.open)},[o,c,l,m,p,a,h,g,v,b,y,k,w,function(t){R[t?"unshift":"push"]((()=>{a=t,n(5,a)}))},t=>b(t.deviceId),function(t){R[t?"unshift":"push"]((()=>{c=t,n(1,c)}))},()=>g(),()=>h(),()=>v(),t=>y(t),t=>k(t),t=>w(t),function(){o=this.open,n(0,o)}]}const Qe=class extends et{constructor(t){super(),tt(this,t,Ke,Xe,i,{open:0},[-1,-1])}},{Boolean:Ye}=G;function Ze(t,e,n){const r=t.slice();return r[87]=e[n],r}function tn(t,e,n){const r=t.slice();return r[90]=e[n],r}function en(e){let n,r;return n=new fe({props:{signalingClient:e[29]}}),{c(){Q(n.$$.fragment)},m(t,e){Y(n,t,e),r=!0},p:t,i(t){r||(z(n.$$.fragment,t),r=!0)},o(t){V(n.$$.fragment,t),r=!1},d(t){Z(n,t)}}}function nn(e){let n,r,o,i,c;return r=new oe({props:{open:!0}}),r.$on("stream",e[49]),r.$on("stop",e[50]),i=new Qe({props:{open:!1}}),i.$on("stream",e[51]),i.$on("stop",e[52]),{c(){n=g("article"),Q(r.$$.fragment),o=$(),Q(i.$$.fragment),k(n,"id","upstream"),k(n,"class","box")},m(t,e){m(t,n,e),Y(r,n,null),f(n,o),Y(i,n,null),c=!0},p:t,i(t){c||(z(r.$$.fragment,t),z(i.$$.fragment,t),c=!0)},o(t){V(r.$$.fragment,t),V(i.$$.fragment,t),c=!1},d(t){t&&p(n),Z(r),Z(i)}}}function rn(t){let e,n,r;return n=new ae({props:{stream:void 0}}),t[53](n),{c(){e=g("article"),Q(n.$$.fragment),k(e,"id","downstream"),k(e,"class","box")},m(t,o){m(t,e,o),Y(n,e,null),r=!0},p(t,e){n.$set({})},i(t){r||(z(n.$$.fragment,t),r=!0)},o(t){V(n.$$.fragment,t),r=!1},d(r){r&&p(e),t[53](null),Z(n)}}}function on(t){let e,n;return e=new Gt({props:{stream:t[12]}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},p(t,n){const r={};4096&n[0]&&(r.stream=t[12]),e.$set(r)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function cn(t){let e,n;return e=new Ee({props:{sender:t[90],open:!0,mediaStream:t[12],onRemove:t[54]}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},p(t,n){const r={};512&n[0]&&(r.sender=t[90]),4096&n[0]&&(r.mediaStream=t[12]),128&n[0]&&(r.onRemove=t[54]),e.$set(r)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function ln(t){let e,n;return e=new ke({props:{receiver:t[87],open:!0}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},p(t,n){const r={};1024&n[0]&&(r.receiver=t[87]),e.$set(r)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function an(t){let e,n,o,i,c,l,a,s,u,d,h,b,k;return{c(){e=g("button"),n=v("replaceTrack"),i=$(),c=g("button"),l=g("strike"),l.textContent="removeStream",s=$(),u=g("button"),d=v("removeTrack"),e.disabled=o=!Boolean(t[12]),c.disabled=a=!Boolean(t[12]),u.disabled=h=!Boolean(t[12])},m(r,o){m(r,e,o),f(e,n),m(r,i,o),m(r,c,o),f(c,l),m(r,s,o),m(r,u,o),f(u,d),b||(k=[y(e,"click",t[56]),y(c,"click",t[57]),y(u,"click",t[58])],b=!0)},p(t,n){4096&n[0]&&o!==(o=!Boolean(t[12]))&&(e.disabled=o),4096&n[0]&&a!==(a=!Boolean(t[12]))&&(c.disabled=a),4096&n[0]&&h!==(h=!Boolean(t[12]))&&(u.disabled=h)},d(t){t&&p(e),t&&p(i),t&&p(c),t&&p(s),t&&p(u),b=!1,r(k)}}}function sn(t){let e,n,r,o,i,c,l,a=t[22].join(" ")+"";return{c(){e=g("tr"),n=g("th"),n.textContent="events:",r=$(),o=g("td"),i=g("code"),c=g("small"),l=v(a)},m(t,a){m(t,e,a),f(e,n),f(e,r),f(e,o),f(o,i),f(i,c),f(c,l)},p(t,e){4194304&e[0]&&a!==(a=t[22].join(" ")+"")&&w(l,a)},d(t){t&&p(e)}}}function un(t){let e,n,r,o,i,c,l,a,s,u,d,h,k=t[21]&&dn(t),w=t[17]&&fn(t),x=t[24]&&!t[5].isManual&&mn(t),C=t[5].isManual&&pn(t);return{c(){k&&k.c(),e=$(),n=g("label"),r=v("1.\n                    "),o=g("button"),i=v("create offer"),c=$(),w&&w.c(),l=$(),x&&x.c(),a=$(),C&&C.c(),s=b(),o.disabled=t[21]},m(p,g){k&&k.m(p,g),m(p,e,g),m(p,n,g),f(n,r),f(n,o),f(o,i),m(p,c,g),w&&w.m(p,g),m(p,l,g),x&&x.m(p,g),m(p,a,g),C&&C.m(p,g),m(p,s,g),u=!0,d||(h=y(o,"click",t[37]),d=!0)},p(t,n){t[21]?k?k.p(t,n):(k=dn(t),k.c(),k.m(e.parentNode,e)):k&&(k.d(1),k=null),(!u||2097152&n[0])&&(o.disabled=t[21]),t[17]?w?(w.p(t,n),131072&n[0]&&z(w,1)):(w=fn(t),w.c(),z(w,1),w.m(l.parentNode,l)):w&&(U(),V(w,1,1,(()=>{w=null})),W()),t[24]&&!t[5].isManual?x?(x.p(t,n),16777248&n[0]&&z(x,1)):(x=mn(t),x.c(),z(x,1),x.m(a.parentNode,a)):x&&(U(),V(x,1,1,(()=>{x=null})),W()),t[5].isManual?C?(C.p(t,n),32&n[0]&&z(C,1)):(C=pn(t),C.c(),z(C,1),C.m(s.parentNode,s)):C&&(U(),V(C,1,1,(()=>{C=null})),W())},i(t){u||(z(w),z(x),z(C),u=!0)},o(t){V(w),V(x),V(C),u=!1},d(t){k&&k.d(t),t&&p(e),t&&p(n),t&&p(c),w&&w.d(t),t&&p(l),x&&x.d(t),t&&p(a),C&&C.d(t),t&&p(s),d=!1,h()}}}function dn(e){let n,r,o,i,c;return{c(){n=g("label"),r=v("0.\n                        "),o=g("button"),o.textContent="start call"},m(t,l){m(t,n,l),f(n,r),f(n,o),i||(c=y(o,"click",e[36]),i=!0)},p:t,d(t){t&&p(n),i=!1,c()}}}function fn(t){let e,n,o,i,c,l,a,s,u,d,h,b,k,w,x,C;function S(e){t[65](e)}let T={hideSignaling:t[27],rows:20};return void 0!==t[17]&&(T.value=t[17]),n=new He({props:T}),R.push((()=>K(n,"value",S))),{c(){e=g("div"),Q(n.$$.fragment),i=$(),c=g("br"),l=$(),a=g("label"),s=v("2.\n                            "),u=g("button"),d=v("setLocalDescription"),h=$(),b=g("button"),k=v("send offer"),u.disabled=t[21],b.disabled=t[21]},m(r,o){m(r,e,o),Y(n,e,null),f(e,i),f(e,c),f(e,l),f(e,a),f(a,s),f(a,u),f(u,d),f(a,h),f(a,b),f(b,k),w=!0,x||(C=[y(u,"click",t[66]),y(b,"click",t[39])],x=!0)},p(t,e){const r={};134217728&e[0]&&(r.hideSignaling=t[27]),!o&&131072&e[0]&&(o=!0,r.value=t[17],I((()=>o=!1))),n.$set(r),(!w||2097152&e[0])&&(u.disabled=t[21]),(!w||2097152&e[0])&&(b.disabled=t[21])},i(t){w||(z(n.$$.fragment,t),w=!0)},o(t){V(n.$$.fragment,t),w=!1},d(t){t&&p(e),Z(n),x=!1,r(C)}}}function mn(t){let e,n,r,o,i,c,l,a,s,u,d,h,b;function k(e){t[67](e)}let w={hideSignaling:t[27],rows:20};return void 0!==t[24]&&(w.value=t[24]),n=new He({props:w}),R.push((()=>K(n,"value",k))),{c(){e=g("div"),Q(n.$$.fragment),o=$(),i=g("br"),c=$(),l=g("label"),a=v("5.\n                            "),s=g("button"),u=v("setRemoteDescription"),s.disabled=t[21]},m(r,p){m(r,e,p),Y(n,e,null),f(e,o),f(e,i),f(e,c),f(e,l),f(l,a),f(l,s),f(s,u),d=!0,h||(b=y(s,"click",t[68]),h=!0)},p(t,e){const o={};134217728&e[0]&&(o.hideSignaling=t[27]),!r&&16777216&e[0]&&(r=!0,o.value=t[24],I((()=>r=!1))),n.$set(o),(!d||2097152&e[0])&&(s.disabled=t[21])},i(t){d||(z(n.$$.fragment,t),d=!0)},o(t){V(n.$$.fragment,t),d=!1},d(t){t&&p(e),Z(n),h=!1,b()}}}function pn(t){let e,n,r,o,i,c,l,a,s,u,d,h,b,k,w;function x(e){t[69](e)}let C={hideSignaling:t[27],rows:20};return void 0!==t[20]&&(C.value=t[20]),o=new He({props:C}),R.push((()=>K(o,"value",x))),{c(){e=g("div"),n=g("strong"),n.textContent="MANUAL ANSWER HERE",r=$(),Q(o.$$.fragment),c=$(),l=g("br"),a=$(),s=g("label"),u=v("5.\n                            "),d=g("button"),h=v("setRemoteDescription"),d.disabled=t[21]},m(i,p){m(i,e,p),f(e,n),f(e,r),Y(o,e,null),f(e,c),f(e,l),f(e,a),f(e,s),f(s,u),f(s,d),f(d,h),b=!0,k||(w=y(d,"click",t[70]),k=!0)},p(t,e){const n={};134217728&e[0]&&(n.hideSignaling=t[27]),!i&&1048576&e[0]&&(i=!0,n.value=t[20],I((()=>i=!1))),o.$set(n),(!b||2097152&e[0])&&(d.disabled=t[21])},i(t){b||(z(o.$$.fragment,t),b=!0)},o(t){V(o.$$.fragment,t),b=!1},d(t){t&&p(e),Z(o),k=!1,w()}}}function hn(t){let e,n,r,o,i=t[23]&&!t[5].isManual&&gn(t),c=t[5].isManual&&vn(t),l=t[18]&&t[23]&&$n(t);return{c(){i&&i.c(),e=$(),c&&c.c(),n=$(),l&&l.c(),r=b()},m(t,a){i&&i.m(t,a),m(t,e,a),c&&c.m(t,a),m(t,n,a),l&&l.m(t,a),m(t,r,a),o=!0},p(t,o){t[23]&&!t[5].isManual?i?(i.p(t,o),8388640&o[0]&&z(i,1)):(i=gn(t),i.c(),z(i,1),i.m(e.parentNode,e)):i&&(U(),V(i,1,1,(()=>{i=null})),W()),t[5].isManual?c?(c.p(t,o),32&o[0]&&z(c,1)):(c=vn(t),c.c(),z(c,1),c.m(n.parentNode,n)):c&&(U(),V(c,1,1,(()=>{c=null})),W()),t[18]&&t[23]?l?(l.p(t,o),8650752&o[0]&&z(l,1)):(l=$n(t),l.c(),z(l,1),l.m(r.parentNode,r)):l&&(U(),V(l,1,1,(()=>{l=null})),W())},i(t){o||(z(i),z(c),z(l),o=!0)},o(t){V(i),V(c),V(l),o=!1},d(t){i&&i.d(t),t&&p(e),c&&c.d(t),t&&p(n),l&&l.d(t),t&&p(r)}}}function gn(t){let e,n,o,i,c,l,a,s,u,d,h,b,k,w,x,C;function S(e){t[71](e)}let T={hideSignaling:t[27],rows:20};return void 0!==t[23]&&(T.value=t[23]),n=new He({props:T}),R.push((()=>K(n,"value",S))),{c(){e=g("div"),Q(n.$$.fragment),i=$(),c=g("br"),l=$(),a=g("label"),s=v("3.\n                            "),u=g("button"),d=v("setRemoteDescription"),h=$(),b=g("button"),k=v("create answer"),u.disabled=t[21],b.disabled=t[21]},m(r,o){m(r,e,o),Y(n,e,null),f(e,i),f(e,c),f(e,l),f(e,a),f(a,s),f(a,u),f(u,d),f(a,h),f(a,b),f(b,k),w=!0,x||(C=[y(u,"click",t[72]),y(b,"click",t[38])],x=!0)},p(t,e){const r={};134217728&e[0]&&(r.hideSignaling=t[27]),!o&&8388608&e[0]&&(o=!0,r.value=t[23],I((()=>o=!1))),n.$set(r),(!w||2097152&e[0])&&(u.disabled=t[21]),(!w||2097152&e[0])&&(b.disabled=t[21])},i(t){w||(z(n.$$.fragment,t),w=!0)},o(t){V(n.$$.fragment,t),w=!1},d(t){t&&p(e),Z(n),x=!1,r(C)}}}function vn(t){let e,n,o,i,c,l,a,s,u,d,h,b,k,w,x,C,S,T;function E(e){t[73](e)}let _={hideSignaling:t[27],rows:20};return void 0!==t[19]&&(_.value=t[19]),i=new He({props:_}),R.push((()=>K(i,"value",E))),{c(){e=g("div"),n=g("strong"),n.textContent="MANUAL OFFER HERE",o=$(),Q(i.$$.fragment),l=$(),a=g("br"),s=$(),u=g("label"),d=v("3.\n                            "),h=g("button"),b=v("setRemoteDescription"),k=$(),w=g("button"),x=v("create answer"),h.disabled=t[21],w.disabled=t[21]},m(r,c){m(r,e,c),f(e,n),f(e,o),Y(i,e,null),f(e,l),f(e,a),f(e,s),f(e,u),f(u,d),f(u,h),f(h,b),f(u,k),f(u,w),f(w,x),C=!0,S||(T=[y(h,"click",t[74]),y(w,"click",t[38])],S=!0)},p(t,e){const n={};134217728&e[0]&&(n.hideSignaling=t[27]),!c&&524288&e[0]&&(c=!0,n.value=t[19],I((()=>c=!1))),i.$set(n),(!C||2097152&e[0])&&(h.disabled=t[21]),(!C||2097152&e[0])&&(w.disabled=t[21])},i(t){C||(z(i.$$.fragment,t),C=!0)},o(t){V(i.$$.fragment,t),C=!1},d(t){t&&p(e),Z(i),S=!1,r(T)}}}function $n(t){let e,n,o,i,c,l,a,s,u,d,h,b,k,w,x,C;function S(e){t[75](e)}let T={hideSignaling:t[27],rows:20};return void 0!==t[18]&&(T.value=t[18]),n=new He({props:T}),R.push((()=>K(n,"value",S))),{c(){e=g("div"),Q(n.$$.fragment),i=$(),c=g("br"),l=$(),a=g("label"),s=v("4.\n                            "),u=g("button"),d=v("setLocalDescription"),h=$(),b=g("button"),k=v("send answer"),u.disabled=t[21],b.disabled=t[21]},m(r,o){m(r,e,o),Y(n,e,null),f(e,i),f(e,c),f(e,l),f(e,a),f(a,s),f(a,u),f(u,d),f(a,h),f(a,b),f(b,k),w=!0,x||(C=[y(u,"click",t[76]),y(b,"click",t[40])],x=!0)},p(t,e){const r={};134217728&e[0]&&(r.hideSignaling=t[27]),!o&&262144&e[0]&&(o=!0,r.value=t[18],I((()=>o=!1))),n.$set(r),(!w||2097152&e[0])&&(u.disabled=t[21]),(!w||2097152&e[0])&&(b.disabled=t[21])},i(t){w||(z(n.$$.fragment,t),w=!0)},o(t){V(n.$$.fragment,t),w=!1},d(t){t&&p(e),Z(n),x=!1,r(C)}}}function bn(t){let e,n,r;return{c(){e=g("textarea"),k(e,"rows","10"),k(e,"class","svelte-5zgp1y"),C(e,"hideSignaling",t[27])},m(o,i){m(o,e,i),x(e,t[25]),n||(r=y(e,"input",t[77]),n=!0)},p(t,n){33554432&n[0]&&x(e,t[25]),134217728&n[0]&&C(e,"hideSignaling",t[27])},d(t){t&&p(e),n=!1,r()}}}function yn(t){let e,n,r,o,i,c,l,a,s=JSON.stringify(t[26],null,4)+"";return{c(){e=g("label"),e.textContent="injected Candidates",n=$(),r=g("textarea"),o=$(),i=g("pre"),c=v(s),k(e,"for","injectedCandidates"),k(r,"name","injectedCandidates"),k(r,"rows","20"),k(r,"class","svelte-5zgp1y")},m(s,u){m(s,e,u),m(s,n,u),m(s,r,u),x(r,t[4]),m(s,o,u),m(s,i,u),f(i,c),l||(a=y(r,"input",t[78]),l=!0)},p(t,e){16&e[0]&&x(r,t[4]),67108864&e[0]&&s!==(s=JSON.stringify(t[26],null,4)+"")&&w(c,s)},d(t){t&&p(e),t&&p(n),t&&p(r),t&&p(o),t&&p(i),l=!1,a()}}}function kn(t){let e,n,o,i,c,l,a,s,u,d,b,x,C,S,T,E,_,N,R,O,L,D,M,A,j,I,B,J,F,P,q,H,G,X,K,tt,et,nt,rt,ot,it,ct,lt,at,st,ut,dt,ft,mt,pt,ht,gt,vt,$t,bt,yt,kt,wt,xt,Ct,St,Tt,Et,_t,Nt,Rt,Ot,Lt,Dt,Mt,At,jt,It,Bt,Jt,Ft,Pt,qt,Ht,Ut,Wt,zt,Vt,Gt,Xt,Kt,Qt,Yt,Zt,te,ee,ne,re=t[5].isRemote&&en(t),oe=t[5].hasUpstream&&nn(t),ie=t[5].hasDownstream&&rn(t),ce=t[12]&&on(t),le="plan-b"===t[31].sdpSemantics&&function(t){let e;return{c(){e=g("span"),e.textContent="plan-b",k(e,"class","warning svelte-5zgp1y")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}(),ae=t[9],se=[];for(let e=0;e<ae.length;e+=1)se[e]=cn(tn(t,ae,e));const ue=t=>V(se[t],1,1,(()=>{se[t]=null}));let de=t[10],fe=[];for(let e=0;e<de.length;e+=1)fe[e]=ln(Ze(t,de,e));const me=t=>V(fe[t],1,1,(()=>{fe[t]=null}));let pe=t[8]&&an(t),he="unified-plan"===t[30]&&function(t){let e,n;return e=new Je({props:{peerconnection:t[7],streamSource:t[60]}}),e.$on("track",t[61]),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},p(t,n){const r={};128&n[0]&&(r.peerconnection=t[7]),4096&n[0]&&(r.streamSource=t[60]),e.$set(r)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}(t),ge=!t[28]&&sn(t),ve=t[0]&&un(t),$e=t[1]&&hn(t),be=(t[25].length||t[5].isManual)&&bn(t),ye=t[5].isManual&&yn(t);return{c(){e=g("section"),n=g("h3"),o=v(t[2]),i=$(),c=g("small"),l=v("talking to "),a=v(t[3]),s=$(),re&&re.c(),u=$(),oe&&oe.c(),d=$(),ie&&ie.c(),b=$(),x=g("article"),C=g("small"),S=g("strong"),S.textContent="selected upstream",T=$(),ce&&ce.c(),E=$(),_=g("hr"),N=$(),R=g("details"),O=g("summary"),L=g("h4"),D=g("abbr"),M=v("peerconnection"),j=$(),le&&le.c(),I=$();for(let t=0;t<se.length;t+=1)se[t].c();B=$();for(let t=0;t<fe.length;t+=1)fe[t].c();F=$(),P=g("button"),q=v("addTrack"),G=$(),pe&&pe.c(),X=$(),K=g("button"),K.textContent="close",tt=$(),he&&he.c(),et=$(),nt=g("article"),rt=g("details"),ot=g("summary"),ot.innerHTML="<h4>signaling</h4>",it=$(),ct=g("div"),lt=g("table"),at=g("tr"),st=g("th"),st.textContent="signaling:",ut=$(),dt=g("td"),ft=g("code"),mt=v(t[13]),pt=$(),ht=g("tr"),gt=g("th"),gt.textContent="connection:",vt=$(),$t=g("td"),bt=g("code"),yt=v(t[14]),kt=$(),wt=g("tr"),xt=g("th"),xt.textContent="iceGathering:",Ct=$(),St=g("td"),Tt=g("code"),Et=v(t[16]),_t=$(),Nt=g("tr"),Rt=g("th"),Rt.textContent="iceConnection:",Ot=$(),Lt=g("td"),Dt=g("code"),Mt=v(t[15]),At=$(),ge&&ge.c(),jt=$(),It=g("div"),Bt=g("span"),Jt=g("label"),Ft=g("input"),Pt=v("\n                        caller"),qt=$(),Ht=g("label"),Ut=g("input"),Wt=v("\n                        receiver"),zt=$(),Vt=g("label"),Gt=g("input"),Xt=v("\n                        auto"),Kt=$(),ve&&ve.c(),Qt=$(),$e&&$e.c(),Yt=$(),be&&be.c(),Zt=$(),ye&&ye.c(),k(D,"title",A=JSON.stringify(t[11],null,4)),R.open=J="plan-b"==t[30],P.disabled=H=!Boolean(t[12]),k(K,"class","btn-small"),k(x,"class","box"),k(lt,"class","vertical"),k(ct,"class","box"),k(Ft,"type","checkbox"),k(Ut,"type","checkbox"),k(Gt,"type","checkbox"),k(It,"class","box"),rt.open="true",k(nt,"class","box")},m(r,p){m(r,e,p),f(e,n),f(n,o),f(n,i),f(n,c),f(c,l),f(c,a),f(e,s),re&&re.m(e,null),f(e,u),oe&&oe.m(e,null),f(e,d),ie&&ie.m(e,null),f(e,b),f(e,x),f(x,C),f(C,S),f(C,T),ce&&ce.m(C,null),f(x,E),f(x,_),f(x,N),f(x,R),f(R,O),f(O,L),f(L,D),f(D,M),f(O,j),le&&le.m(O,null),f(R,I);for(let t=0;t<se.length;t+=1)se[t].m(R,null);f(R,B);for(let t=0;t<fe.length;t+=1)fe[t].m(R,null);f(x,F),f(x,P),f(P,q),f(x,G),pe&&pe.m(x,null),f(x,X),f(x,K),f(x,tt),he&&he.m(x,null),f(e,et),f(e,nt),f(nt,rt),f(rt,ot),f(rt,it),f(rt,ct),f(ct,lt),f(lt,at),f(at,st),f(at,ut),f(at,dt),f(dt,ft),f(ft,mt),f(lt,pt),f(lt,ht),f(ht,gt),f(ht,vt),f(ht,$t),f($t,bt),f(bt,yt),f(lt,kt),f(lt,wt),f(wt,xt),f(wt,Ct),f(wt,St),f(St,Tt),f(Tt,Et),f(lt,_t),f(lt,Nt),f(Nt,Rt),f(Nt,Ot),f(Nt,Lt),f(Lt,Dt),f(Dt,Mt),f(lt,At),ge&&ge.m(lt,null),f(rt,jt),f(rt,It),f(It,Bt),f(Bt,Jt),f(Jt,Ft),Ft.checked=t[0],f(Jt,Pt),f(Bt,qt),f(Bt,Ht),f(Ht,Ut),Ut.checked=t[1],f(Ht,Wt),f(Bt,zt),f(Bt,Vt),f(Vt,Gt),Gt.checked=t[21],f(Vt,Xt),f(rt,Kt),ve&&ve.m(rt,null),f(rt,Qt),$e&&$e.m(rt,null),f(rt,Yt),be&&be.m(rt,null),f(rt,Zt),ye&&ye.m(rt,null),te=!0,ee||(ne=[y(P,"click",t[55]),y(K,"click",t[59]),y(Ft,"change",t[62]),y(Ut,"change",t[63]),y(Gt,"change",t[64])],ee=!0)},p(t,n){if((!te||4&n[0])&&w(o,t[2]),(!te||8&n[0])&&w(a,t[3]),t[5].isRemote?re?(re.p(t,n),32&n[0]&&z(re,1)):(re=en(t),re.c(),z(re,1),re.m(e,u)):re&&(U(),V(re,1,1,(()=>{re=null})),W()),t[5].hasUpstream?oe?(oe.p(t,n),32&n[0]&&z(oe,1)):(oe=nn(t),oe.c(),z(oe,1),oe.m(e,d)):oe&&(U(),V(oe,1,1,(()=>{oe=null})),W()),t[5].hasDownstream?ie?(ie.p(t,n),32&n[0]&&z(ie,1)):(ie=rn(t),ie.c(),z(ie,1),ie.m(e,b)):ie&&(U(),V(ie,1,1,(()=>{ie=null})),W()),t[12]?ce?(ce.p(t,n),4096&n[0]&&z(ce,1)):(ce=on(t),ce.c(),z(ce,1),ce.m(C,null)):ce&&(U(),V(ce,1,1,(()=>{ce=null})),W()),(!te||2048&n[0]&&A!==(A=JSON.stringify(t[11],null,4)))&&k(D,"title",A),4736&n[0]){let e;for(ae=t[9],e=0;e<ae.length;e+=1){const r=tn(t,ae,e);se[e]?(se[e].p(r,n),z(se[e],1)):(se[e]=cn(r),se[e].c(),z(se[e],1),se[e].m(R,B))}for(U(),e=ae.length;e<se.length;e+=1)ue(e);W()}if(1024&n[0]){let e;for(de=t[10],e=0;e<de.length;e+=1){const r=Ze(t,de,e);fe[e]?(fe[e].p(r,n),z(fe[e],1)):(fe[e]=ln(r),fe[e].c(),z(fe[e],1),fe[e].m(R,null))}for(U(),e=de.length;e<fe.length;e+=1)me(e);W()}(!te||4096&n[0]&&H!==(H=!Boolean(t[12])))&&(P.disabled=H),t[8]?pe?pe.p(t,n):(pe=an(t),pe.c(),pe.m(x,X)):pe&&(pe.d(1),pe=null),"unified-plan"===t[30]&&he.p(t,n),(!te||8192&n[0])&&w(mt,t[13]),(!te||16384&n[0])&&w(yt,t[14]),(!te||65536&n[0])&&w(Et,t[16]),(!te||32768&n[0])&&w(Mt,t[15]),t[28]?ge&&(ge.d(1),ge=null):ge?ge.p(t,n):(ge=sn(t),ge.c(),ge.m(lt,null)),1&n[0]&&(Ft.checked=t[0]),2&n[0]&&(Ut.checked=t[1]),2097152&n[0]&&(Gt.checked=t[21]),t[0]?ve?(ve.p(t,n),1&n[0]&&z(ve,1)):(ve=un(t),ve.c(),z(ve,1),ve.m(rt,Qt)):ve&&(U(),V(ve,1,1,(()=>{ve=null})),W()),t[1]?$e?($e.p(t,n),2&n[0]&&z($e,1)):($e=hn(t),$e.c(),z($e,1),$e.m(rt,Yt)):$e&&(U(),V($e,1,1,(()=>{$e=null})),W()),t[25].length||t[5].isManual?be?be.p(t,n):(be=bn(t),be.c(),be.m(rt,Zt)):be&&(be.d(1),be=null),t[5].isManual?ye?ye.p(t,n):(ye=yn(t),ye.c(),ye.m(rt,null)):ye&&(ye.d(1),ye=null)},i(t){if(!te){z(re),z(oe),z(ie),z(ce);for(let t=0;t<ae.length;t+=1)z(se[t]);for(let t=0;t<de.length;t+=1)z(fe[t]);z(he),z(ve),z($e),te=!0}},o(t){V(re),V(oe),V(ie),V(ce),se=se.filter(Ye);for(let t=0;t<se.length;t+=1)V(se[t]);fe=fe.filter(Ye);for(let t=0;t<fe.length;t+=1)V(fe[t]);V(he),V(ve),V($e),te=!1},d(t){t&&p(e),re&&re.d(),oe&&oe.d(),ie&&ie.d(),ce&&ce.d(),le&&le.d(),h(se,t),h(fe,t),pe&&pe.d(),he&&he.d(),ge&&ge.d(),ve&&ve.d(),$e&&$e.d(),be&&be.d(),ye&&ye.d(),ee=!1,r(ne)}}}function wn(t,e,n){let r,o,i,c,l,s,u,d,f,m,p,h,g;a(t,st,(t=>n(5,f=t))),a(t,ut,(t=>n(46,m=t))),a(t,yt,(t=>n(47,p=t))),a(t,kt,(t=>n(48,h=t))),a(t,wt,(t=>n(80,g=t)));var v,$=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function l(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}a((r=r.apply(t,e||[])).next())}))};let{isCaller:b=!1}=e,{isReceiver:y=!1}=e,{name:k="unnamed participant"}=e,{recipient:w=null}=e;const x=new _t({from:k,to:w}),C=ft(k);let S,T,_,N,O,L=[],D=[],M="",A="",j="",I="",B="";Et.addEventListener(`OfferTo:${k}`,(({detail:t})=>$(void 0,void 0,void 0,(function*(){r&&(et(Nt(t)),yield Q(),tt(Ot(J)),Z())})))),Et.addEventListener(`AnswerTo:${k}`,(({detail:t})=>$(void 0,void 0,void 0,(function*(){r&&rt(Nt(t))})))),Et.addEventListener(`CandidateTo:${k}`,(({detail:t})=>$(void 0,void 0,void 0,(function*(){r&&(yield function(t){return $(this,void 0,void 0,(function*(){f.showCandidateEvents&&C("ac","addIceCandidate"),yield T.addIceCandidate(t)}))}(t))}))));let J="",F="",P="",q=[],H="";const U=null!==(v=new URL(document.location.toString()).searchParams.get("sdpSemantics"))&&void 0!==v?v:"unified-plan",W={sdpSemantics:U};function z(t){C("at","add track"),console.info("add track"),n(8,_=T.addTrack(t.getTracks()[0],t))}function V(t,e){C("rt","replace track"),console.info("replace track",{sender:e}),e.replaceTrack(t.getTracks()[0])}function G(){T.removeStream(O),n(8,_=void 0)}function X(){T.removeTrack(_),n(8,_=void 0)}function K(){return $(this,void 0,void 0,(function*(){C("o","create offer");const t=yield T.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!1});n(17,B=t.sdp)}))}function Q(){return $(this,void 0,void 0,(function*(){C("a","create answer");const t=yield T.createAnswer();n(18,J=t.sdp)}))}function Y(){const t=Rt(B);xt({from:k,offer:t}),f.isRemote&&x.sendOffer(t),Et.dispatchEvent(new CustomEvent(`OfferTo:${w}`,{detail:t}))}function Z(){const t=Rt(J);Ct({from:k,answer:t}),f.isRemote&&x.sendAnswer(t),Et.dispatchEvent(new CustomEvent(`AnswerTo:${w}`,{detail:t}))}function tt(t){return $(this,void 0,void 0,(function*(){C("l","setLocalDescription"),console.debug("localDescription ->",t);const e=t;Tt({from:k}),T.setLocalDescription(e),nt(),Tt({from:w})}))}function et(t){C("r","setRemoteDescription");const e=Rt(t);T.setRemoteDescription(e),nt(),Tt({from:w})}function nt(){f.isManual?(s||[]).forEach((t=>{t&&f.showCandidateEvents&&(C("ac","addIceCandidate"),T.addIceCandidate(t))})):(console.debug(g[w]),(g[w]||[]).forEach((t=>{t&&f.showCandidateEvents&&(C("ac","addIceCandidate"),T.addIceCandidate(t))})))}function rt(t){C("r","setRemoteDescription");const e=Ot(t);T.setRemoteDescription(e),Tt({from:k})}function ot(t){if(t.stream)S.$set({stream:t.stream});else if(t.track){const e=new MediaStream([t.track]);S.$set({stream:e})}else console.error("can't use stream or track, nothing there",t)}return E((()=>{n(7,T=function(){const t=new RTCPeerConnection(W);return t.addEventListener("track",(t=>{C("pct","pc ontrack");const{track:e,streams:n,transceiver:r}=t,o=n[0]||new MediaStream([e]);console.info(`${k}.ontrack`,{track:e,streams:n,kind:e.kind,transceiver:r}),ot({stream:o,track:e}),e.addEventListener("ended",(()=>{C("te","track ended"),console.info(`${k} track ended`,{event:t})})),e.addEventListener("mute",(()=>{C("🔇","track muted"),console.info(`${k} track muted`,{event:t})})),e.addEventListener("unmute",(()=>{C("🔈","track unmuted"),console.info(`${k} track unmuted`,{event:t})})),o.addEventListener("addtrack",(()=>{C("add","stream track added")})),o.addEventListener("removetrack",(()=>{C("rem","stream track removed")}))})),t.addEventListener("icecandidate",(({candidate:t})=>{f.showCandidateEvents&&C("lc","create candidate"),n(45,q=[...q,t]),function(t){k&&t&&(St({from:k,candidate:t}),f.isRemote&&x.sendCandidate(t),Et.dispatchEvent(new CustomEvent(`CandidateTo:${w}`,{detail:t})))}(t)})),t.addEventListener("signalingstatechange",(()=>n(13,M=t.signalingState))),t.addEventListener("connectionstatechange",(()=>n(14,A=t.connectionState))),t.addEventListener("iceconnectionstatechange",(()=>n(15,j=t.iceConnectionState))),t.addEventListener("icegatheringstatechange",(({target:{iceGatheringState:t}})=>n(16,I=t))),t.addEventListener("negotiationneeded",(()=>C("nn","negotiation needed"))),t.addEventListener("addstream",(t=>{C("as","addstream"),console.warn("addstream",t)})),t.addEventListener("removestream",(t=>{C("rs","removestream"),console.warn("removestream",t)})),console.info(`setup RTCPeerConnection for ${k}`,W,t),t}()),wt.subscribe((({[w]:t})=>{t&&f.showCandidateEvents&&C("rc")})),f.hasCaller&&K();const t=()=>{n(9,L=T.getSenders()),n(10,D=T.getReceivers()),n(11,N=T.getConfiguration())};t();const e=setInterval((()=>{t()}),500);return()=>clearInterval(e)})),t.$$set=t=>{"isCaller"in t&&n(0,b=t.isCaller),"isReceiver"in t&&n(1,y=t.isReceiver),"name"in t&&n(2,k=t.name),"recipient"in t&&n(3,w=t.recipient)},t.$$.update=()=>{32&t.$$.dirty[0]&&n(21,r=f.autoSignal),4&t.$$.dirty[0]|32768&t.$$.dirty[1]&&n(22,o=m[k]||[]),8&t.$$.dirty[0]|65536&t.$$.dirty[1]&&n(23,i=Nt(p[w])),8&t.$$.dirty[0]|131072&t.$$.dirty[1]&&n(24,c=Nt(h[w])),16384&t.$$.dirty[1]&&n(25,l=JSON.stringify(q)),16&t.$$.dirty[0]&&n(26,s=(t=>{try{return JSON.parse(t)}catch(e){return""!==t&&console.warn({parseError:e}),[]}})(H)),32&t.$$.dirty[0]&&n(27,u=f.hideSignaling),32&t.$$.dirty[0]&&n(28,d=f.hideEvents)},[b,y,k,w,H,f,S,T,_,L,D,N,O,M,A,j,I,B,J,F,P,r,o,i,c,l,s,u,d,x,U,W,z,V,G,X,function(){return $(this,void 0,void 0,(function*(){yield K(),tt(Rt(B)),Y()}))},K,Q,Y,Z,tt,et,rt,ot,q,m,p,h,({detail:t})=>n(12,O=t),()=>n(12,O=void 0),({detail:t})=>n(12,O=t),()=>n(12,O=void 0),function(t){R[t?"unshift":"push"]((()=>{S=t,n(6,S)}))},t=>T.removeTrack(t),()=>z(O),()=>V(O,_),()=>G(),()=>X(),()=>T.close(),()=>O,({detail:t})=>ot({track:t}),function(){b=this.checked,n(0,b)},function(){y=this.checked,n(1,y)},function(){r=this.checked,n(21,r),n(5,f)},function(t){B=t,n(17,B)},()=>tt(Rt(B)),function(t){c=t,n(24,c),n(48,h),n(3,w)},()=>rt(c),function(t){P=t,n(20,P)},()=>rt(P),function(t){i=t,n(23,i),n(47,p),n(3,w)},()=>et(i),function(t){F=t,n(19,F)},()=>et(F),function(t){J=t,n(18,J)},()=>tt(Ot(J)),function(){l=this.value,n(25,l),n(45,q)},function(){H=this.value,n(4,H)}]}const xn=class extends et{constructor(t){super(),tt(this,t,wn,kn,i,{isCaller:0,isReceiver:1,name:2,recipient:3},[-1,-1,-1])}};function Cn(t,e,n){const r=t.slice();return r[6]=e[n].name,r[7]=e[n].event,r[8]=e[n].timestamp,r}function Sn(t){let e,n,r,o,i,c,l,a,s,u,d,h,b,y=t[8]+"",x=t[6]+"",C=t[7]+"";return{c(){e=g("tr"),n=g("td"),r=g("code"),o=v(y),i=$(),c=g("th"),l=v(x),a=v(":"),s=$(),u=g("td"),d=g("code"),h=v(C),b=$(),k(r,"class","timestamp svelte-m6pkof")},m(t,p){m(t,e,p),f(e,n),f(n,r),f(r,o),f(e,i),f(e,c),f(c,l),f(c,a),f(e,s),f(e,u),f(u,d),f(d,h),f(e,b)},p(t,e){4&e&&y!==(y=t[8]+"")&&w(o,y),4&e&&x!==(x=t[6]+"")&&w(l,x),4&e&&C!==(C=t[7]+"")&&w(h,C)},d(t){t&&p(e)}}}function Tn(e){let n,r,o,i,c,l,a,s,u,d,v=e[2],b=[];for(let t=0;t<v.length;t+=1)b[t]=Sn(Cn(e,v,t));return{c(){n=g("section"),r=g("h3"),r.innerHTML="Event Log <small>please open\n            <code>about://webrtc-internals</code></small>",o=$(),i=g("div"),c=g("table");for(let t=0;t<b.length;t+=1)b[t].c();l=$(),a=g("label"),s=g("input"),k(c,"class","vertical svelte-m6pkof"),k(i,"class","box svelte-m6pkof"),k(s,"type","text"),k(s,"name","filterTerm"),k(s,"id","filterTerm"),k(s,"placeholder","filter"),k(s,"class","svelte-m6pkof"),k(a,"for","filterTerm"),k(n,"id","EventLog")},m(t,p){m(t,n,p),f(n,r),f(n,o),f(n,i),f(i,c);for(let t=0;t<b.length;t+=1)b[t].m(c,null);e[4](i),f(n,l),f(n,a),f(a,s),x(s,e[0]),u||(d=y(s,"input",e[5]),u=!0)},p(t,[e]){if(4&e){let n;for(v=t[2],n=0;n<v.length;n+=1){const r=Cn(t,v,n);b[n]?b[n].p(r,e):(b[n]=Sn(r),b[n].c(),b[n].m(c,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=v.length}1&e&&s.value!==t[0]&&x(s,t[0])},i:t,o:t,d(t){t&&p(n),h(b,t),e[4](null),u=!1,d()}}}function En(t,e,n){let r,o,i;a(t,it,(t=>n(3,o=t)));let c="";return E((()=>{it.subscribe((()=>{n(1,i.scrollTop=i.scrollHeight,i)}))})),t.$$.update=()=>{9&t.$$.dirty&&n(2,r=c&&c.length?o.filter((({event:t,short:e,name:n})=>(null==t?void 0:t.match(c))||(null==n?void 0:n.match(c))||(null==e?void 0:e.includes(c)))):o)},[c,i,r,o,function(t){R[t?"unshift":"push"]((()=>{i=t,n(1,i)}))},function(){c=this.value,n(0,c)}]}const _n=class extends et{constructor(t){super(),tt(this,t,En,Tn,i,{})}};function Nn(t){let e,n;return e=new xn({props:{name:"alice",isCaller:"true",recipient:"bob"}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function Rn(t){let e,n;return e=new xn({props:{name:"bob",isReceiver:"true",recipient:"alice"}}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function On(t){let e,n;return e=new _n({}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function Ln(t){let e,n,r,o,i,c,l,a,s,u;i=new bt({});let d=t[0].hasCaller&&Nn(),h=t[0].hasReceiver&&Rn(),v=!t[0].hideEvents&&On();return{c(){e=g("div"),n=g("h1"),n.textContent="WebRTC Demo",r=$(),o=g("aside"),Q(i.$$.fragment),c=$(),l=g("main"),d&&d.c(),a=$(),h&&h.c(),s=$(),v&&v.c(),k(o,"class","svelte-if8jgd"),k(l,"class","svelte-if8jgd"),k(e,"class","svelte-if8jgd")},m(t,p){m(t,e,p),f(e,n),f(e,r),f(e,o),Y(i,o,null),f(e,c),f(e,l),d&&d.m(l,null),f(l,a),h&&h.m(l,null),f(l,s),v&&v.m(l,null),u=!0},p(t,[e]){t[0].hasCaller?d?1&e&&z(d,1):(d=Nn(),d.c(),z(d,1),d.m(l,a)):d&&(U(),V(d,1,1,(()=>{d=null})),W()),t[0].hasReceiver?h?1&e&&z(h,1):(h=Rn(),h.c(),z(h,1),h.m(l,s)):h&&(U(),V(h,1,1,(()=>{h=null})),W()),t[0].hideEvents?v&&(U(),V(v,1,1,(()=>{v=null})),W()):v?1&e&&z(v,1):(v=On(),v.c(),z(v,1),v.m(l,null))},i(t){u||(z(i.$$.fragment,t),z(d),z(h),z(v),u=!0)},o(t){V(i.$$.fragment,t),V(d),V(h),V(v),u=!1},d(t){t&&p(e),Z(i),d&&d.d(),h&&h.d(),v&&v.d()}}}function Dn(t,e,n){let r;return a(t,st,(t=>n(0,r=t))),[r]}const Mn=class extends et{constructor(t){super(),tt(this,t,Dn,Ln,i,{})}};function An(t){let e,n;return e=new Mn({}),{c(){Q(e.$$.fragment)},m(t,r){Y(e,t,r),n=!0},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function jn(t){let e,n,r,o,i,c,l;return r=new Qe({}),c=new oe({}),{c(){e=g("section"),n=g("article"),Q(r.$$.fragment),o=$(),i=g("article"),Q(c.$$.fragment),k(n,"class","box"),k(i,"class","box")},m(t,a){m(t,e,a),f(e,n),Y(r,n,null),f(e,o),f(e,i),Y(c,i,null),l=!0},i(t){l||(z(r.$$.fragment,t),z(c.$$.fragment,t),l=!0)},o(t){V(r.$$.fragment,t),V(c.$$.fragment,t),l=!1},d(t){t&&p(e),Z(r),Z(c)}}}function In(t){let e,n,r,o;const i=[jn,An],c=[];function l(t,e){return t[0].audioVisOnly?0:1}return e=l(t),n=c[e]=i[e](t),{c(){n.c(),r=b()},m(t,n){c[e].m(t,n),m(t,r,n),o=!0},p(t,[o]){let a=e;e=l(t),e!==a&&(U(),V(c[a],1,1,(()=>{c[a]=null})),W(),n=c[e],n||(n=c[e]=i[e](t),n.c()),z(n,1),n.m(r.parentNode,r))},i(t){o||(z(n),o=!0)},o(t){V(n),o=!1},d(t){c[e].d(t),t&&p(r)}}}function Bn(t,e,n){let r;return a(t,st,(t=>n(0,r=t))),[r]}const Jn=new class extends et{constructor(t){super(),tt(this,t,Bn,In,i,{})}}({target:document.body,props:{}});window.app=Jn})();