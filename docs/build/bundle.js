(()=>{"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t){return 0===Object.keys(t).length}function a(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function s(t,e,n){t.$$.on_destroy.push(a(e,n))}new Set;let l,u=!1;function d(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function $(){return h(" ")}function v(){return h("")}function b(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function k(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function C(t,e,n){t.classList[n?"add":"remove"](e)}function x(t){l=t}function S(){if(!l)throw new Error("Function called outside component initialization");return l}function T(t){S().$$.on_mount.push(t)}function E(){const t=S();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}new Set;const R=[],N=[],L=[],O=[],D=Promise.resolve();let M=!1;function A(){M||(M=!0,D.then(J))}function j(t){L.push(t)}function _(t){O.push(t)}const I=new Set;let B=0;function J(){const t=l;do{for(;B<R.length;){const t=R[B];B++,x(t),F(t.$$)}for(x(null),R.length=0,B=0;N.length;)N.pop()();for(let t=0;t<L.length;t+=1){const e=L[t];I.has(e)||(I.add(e),e())}L.length=0}while(R.length);for(;O.length;)O.pop()();M=!1,I.clear(),x(t)}function F(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const q=new Set;let H;function U(){H={r:0,c:[],p:H}}function P(){H.r||r(H.c),H=H.p}function W(t,e){t&&t.i&&(q.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(q.has(t))return;q.add(t),H.c.push((()=>{q.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const V="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;let G;function X(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function K(t){t&&t.c()}function Q(t,n,c,i){const{fragment:a,on_mount:s,on_destroy:l,after_update:u}=t.$$;a&&a.m(n,c),i||j((()=>{const n=s.map(e).filter(o);l?l.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(j)}function Y(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,o,c,i,a,s,d,f=[-1]){const p=l;x(e);const g=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(p?p.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:o.target||p.$$.root};d&&d(g.root);let h=!1;if(g.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return g.ctx&&a(g.ctx[t],g.ctx[t]=o)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](o),h&&function(t,e){-1===t.$$.dirty[0]&&(R.push(t),A(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],g.update(),h=!0,r(g.before_update),g.fragment=!!i&&i(g.ctx),o.target){if(o.hydrate){u=!0;const t=($=o.target,Array.from($.childNodes));g.fragment&&g.fragment.l(t),t.forEach(m)}else g.fragment&&g.fragment.c();o.intro&&W(e.$$.fragment),Q(e,o.target,o.anchor,o.customElement),u=!1,J()}var $;x(p)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(G=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(o);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){r(this.$$.on_disconnect)}$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!i(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class tt{$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!i(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function nt(e,n=t){let r;const o=new Set;function i(t){if(c(e,t)&&(e=t,r)){const t=!et.length;for(const t of o)t[1](),et.push(t,e);if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(c,a=t){const s=[c,a];return o.add(s),1===o.size&&(r=n(i)||t),c(e),()=>{o.delete(s),0===o.size&&(r(),r=null)}}}}function rt(e,n,c){const i=!Array.isArray(e),s=i?[e]:e,l=n.length<2;return{subscribe:nt(c,(e=>{let c=!1;const u=[];let d=0,f=t;const m=()=>{if(d)return;f();const r=n(i?u[0]:u,e);l?e(r):f=o(r)?r:t},p=s.map(((t,e)=>a(t,(t=>{u[e]=t,d&=~(1<<e),c&&m()}),(()=>{d|=1<<e}))));return c=!0,m(),function(){r(p),f()}})).subscribe}}const ot=nt([]),ct=t=>{try{return!0===JSON.parse(t)}catch{return!1}},it=nt((()=>{const t=Object.fromEntries(new URLSearchParams(location.search).entries()),e={role:t.role||"both",stream:t.stream||"both",autoSignal:ct(t.autoSignal),audioVisOnly:ct(t.audioVisOnly),manual:ct(t.manual),remote:ct(t.remote),hideSignaling:ct(t.hideSignaling),hideEvents:ct(t.hideEvents),showCandidateEvents:ct(t.showCandidateEvents),showTransceivers:ct(t.showTransceivers??!0)};return Object.entries(e).map((([t,e])=>({key:t,value:e})))})()),at=rt(it,(t=>`${window.origin}${window.location.pathname}?${(t=>{const e=new URLSearchParams;for(let[n,r]of t)e.set(n,r);return e.toString()})(t.map((({key:t,value:e})=>[t,e])))}`)),st=rt(it,(t=>{const e=Object.fromEntries(t.map((({key:t,value:e})=>[t,e])));let{role:n,stream:r,manual:o,remote:c,hideSignaling:i,hideEvents:a,showTransceivers:s,autoSignal:l,showCandidateEvents:u}=e;const d="recv"!==n,f="call"!==n&&"send"!==n||!1,m="down"!==r||!1,p="up"!==r||!1,g=o&&"no"!==o||!1,h=c&&"no"!==c||!1,$=d?"bob":"alice",v=f?"bob":"alice";return{...e,role:n,stream:r,manual:o,remote:c,hasCaller:d,hasReceiver:f,hasUpstream:m,hasDownstream:p,autoSignal:l,isManual:g,isRemote:h,hideSignaling:i,hideEvents:a,showTransceivers:s,showCandidateEvents:u,to:$,from:v}})),lt=nt({});function ut(t,e,n){const r={name:t,short:e,event:n,timestamp:(new Date).toISOString().split("T")[1]};ot.update((t=>[...t,r])),lt.update((n=>({...n,[t]:[...n[t]||[],e]})))}const dt=t=>(e,n)=>ut(t,e,n);function ft(t,e,n){const r=t.slice();return r[4]=e[n].key,r[5]=e[n].value,r[6]=e,r[7]=n,r}function mt(t){let e,n,r,o,c,i,a,s=t[4]+"";function l(){t[3].call(c,t[6],t[7])}return{c(){e=g("td"),n=h(s),r=$(),o=g("td"),c=g("input"),k(c,"type","text")},m(s,u){f(s,e,u),d(e,n),f(s,r,u),f(s,o,u),d(o,c),w(c,t[5]),i||(a=b(c,"input",l),i=!0)},p(e,r){t=e,1&r&&s!==(s=t[4]+"")&&y(n,s),1&r&&c.value!==t[5]&&w(c,t[5])},d(t){t&&m(e),t&&m(r),t&&m(o),i=!1,a()}}}function pt(t){let e,n,r,o,c,i,a,s,l,u=t[4]+"";function p(){t[2].call(r,t[6],t[7])}return{c(){e=g("td"),n=g("label"),r=g("input"),c=$(),i=h(u),k(r,"type","checkbox"),k(r,"id",o=t[4]),k(n,"for",a=t[4]),k(e,"colspan","2")},m(o,a){f(o,e,a),d(e,n),d(n,r),r.checked=t[5],d(n,c),d(n,i),s||(l=b(r,"change",p),s=!0)},p(e,c){t=e,1&c&&o!==(o=t[4])&&k(r,"id",o),1&c&&(r.checked=t[5]),1&c&&u!==(u=t[4]+"")&&y(i,u),1&c&&a!==(a=t[4])&&k(n,"for",a)},d(t){t&&m(e),s=!1,l()}}}function gt(t){let e,n;function r(t,e){return"boolean"==typeof t[5]?pt:mt}let o=r(t),c=o(t);return{c(){e=g("tr"),c.c(),n=$()},m(t,r){f(t,e,r),c.m(e,null),d(e,n)},p(t,i){o===(o=r(t))&&c?c.p(t,i):(c.d(1),c=o(t),c&&(c.c(),c.m(e,n)))},d(t){t&&m(e),c.d()}}}function ht(e){let n,r,o,c,i,a,s,l,u,v,b=e[0],w=[];for(let t=0;t<b.length;t+=1)w[t]=gt(ft(e,b,t));return{c(){n=g("details"),r=g("summary"),r.textContent="Config",o=$(),c=g("div"),i=g("table");for(let t=0;t<w.length;t+=1)w[t].c();a=$(),s=g("code"),l=g("pre"),u=g("a"),v=h(e[1]),k(r,"class","svelte-rc03x9"),k(u,"href",e[1]),k(n,"class","svelte-rc03x9")},m(t,e){f(t,n,e),d(n,r),d(n,o),d(n,c),d(c,i);for(let t=0;t<w.length;t+=1)w[t].m(i,null);d(c,a),d(c,s),d(s,l),d(l,u),d(u,v)},p(t,[e]){if(1&e){let n;for(b=t[0],n=0;n<b.length;n+=1){const r=ft(t,b,n);w[n]?w[n].p(r,e):(w[n]=gt(r),w[n].c(),w[n].m(i,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=b.length}2&e&&y(v,t[1]),2&e&&k(u,"href",t[1])},i:t,o:t,d(t){t&&m(n),p(w,t)}}}function $t(t,e,n){let r,o;return s(t,it,(t=>n(0,r=t))),s(t,at,(t=>n(1,o=t))),[r,o,function(t,e){t[e].value=this.checked,it.set(r)},function(t,e){t[e].value=this.value,it.set(r)}]}const vt=class extends tt{constructor(t){super(),Z(this,t,$t,ht,c,{})}},bt=nt({}),kt=nt({}),yt=nt({});function wt({from:t,offer:e}){bt.update((n=>({...n,[t]:e})))}function Ct({from:t,answer:e}){kt.update((n=>({...n,[t]:e})))}function xt({from:t,candidate:e}){yt.update((n=>{const r=n[t]||[];return{...n,[t]:[...r,e]}}))}function St({from:t}){yt.update((e=>({...e,[t]:[]})))}const Tt=new EventTarget;class Et{to;from;socket;constructor({to:t,from:e}){this.to=t,this.from=e}connect({url:t}){const e=new WebSocket(t);e.onopen=()=>{this.socket=e,this.socket.onmessage=this.received.bind(this)}}received({data:t}){const e=JSON.parse(t),{[this.to]:n,type:r}=e;console.debug("its for me!",n);const o=this.to;switch(r){case"offer":wt({from:o,offer:n});break;case"answer":Ct({from:o,answer:n});break;case"candidate":xt({from:o,candidate:new RTCIceCandidate(n)})}}sendOffer(t){if(t){const e={[this.from]:t,type:"offer"};this.send(e)}}sendAnswer(t){if(t){const e={[this.from]:t,type:"answer"};this.send(e)}}sendCandidate(t){if(t){const e={[this.from]:t,type:"candidate"};this.send(e)}}send(t){if(this.socket){const e=JSON.stringify(t);this.socket.send(e)}}toString(){return`[Signaling Server calling ${this.from} → ${this.to}]`}}const Rt=t=>"string"==typeof t?JSON.parse(t).sdp:"object"==typeof t?t.sdp:void 0,Nt=t=>({type:"offer",sdp:t}),Lt=t=>({type:"answer",sdp:t});function Ot(t){let e,n,r=JSON.stringify(t[2],null,4)+"";return{c(){e=g("code"),n=h(r)},m(t,r){f(t,e,r),d(e,n)},p(t,e){4&e&&r!==(r=JSON.stringify(t[2],null,4)+"")&&y(n,r)},d(t){t&&m(e)}}}function Dt(t){let e,n=t[0]&&Mt(t);return{c(){e=g("strong"),n&&n.c()},m(t,r){f(t,e,r),n&&n.m(e,null)},p(t,r){t[0]?n?n.p(t,r):(n=Mt(t),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(t){t&&m(e),n&&n.d()}}}function Mt(t){let e,n=JSON.stringify(t[2]())+"";return{c(){e=h(n)},m(t,n){f(t,e,n)},p(t,r){4&r&&n!==(n=JSON.stringify(t[2]())+"")&&y(e,n)},d(t){t&&m(e)}}}function At(e){let n,r,o,c,i,a,s;function l(t,e){return"function"==typeof t[2]?Dt:Ot}let u=l(e),p=u(e);return{c(){n=g("details"),r=g("summary"),o=h(e[1]),c=$(),i=g("pre"),p.c()},m(t,l){f(t,n,l),d(n,r),d(r,o),d(n,c),d(n,i),p.m(i,null),n.open=e[3],a||(s=b(n,"toggle",e[4]),a=!0)},p(t,[e]){2&e&&y(o,t[1]),u===(u=l(t))&&p?p.p(t,e):(p.d(1),p=u(t),p&&(p.c(),p.m(i,null))),8&e&&(n.open=t[3])},i:t,o:t,d(t){t&&m(n),p.d(),a=!1,s()}}}function jt(t,e,n){let{open:r}=e,{summary:o="???"}=e,{data:c}=e,i=Boolean(c)&&r;return t.$$set=t=>{"open"in t&&n(0,r=t.open),"summary"in t&&n(1,o=t.summary),"data"in t&&n(2,c=t.data)},[r,o,c,i,function(){i=this.open,n(3,i)}]}const _t=class extends tt{constructor(t){super(),Z(this,t,jt,At,c,{open:0,summary:1,data:2})}};function It(t){let e,n,r,o,c,i,a,s,l,u,p,v,b,w,C,x,S,T,E,R,N=t[0].constructor.name+"",L=t[0].kind+"",O=t[0].readyState+"",D=t[0].muted?"muted":"unmuted",M=JSON.stringify({id:t[0].id,kind:t[0].kind,constraints:t[2]},null,4)+"",A=t[5]&&Bt(t);return S=new _t({props:{data:t[1],summary:"settings",open:!0}}),E=new _t({props:{data:t[3],summary:"capabilities",open:!0}}),{c(){e=g("details"),n=g("summary"),r=h(N),o=$(),c=g("strong"),i=h(L),a=$(),A&&A.c(),s=h("\n            | "),l=h(O),u=h("\n            | "),p=h(D),v=$(),b=g("pre"),w=h(M),C=$(),x=g("div"),K(S.$$.fragment),T=$(),K(E.$$.fragment),k(x,"class","indent svelte-1scnwrj")},m(t,m){f(t,e,m),d(e,n),d(n,r),d(n,o),d(n,c),d(c,i),d(n,a),A&&A.m(n,null),d(n,s),d(n,l),d(n,u),d(n,p),d(e,v),d(e,b),d(b,w),d(e,C),d(e,x),Q(S,x,null),d(x,T),Q(E,x,null),R=!0},p(t,e){(!R||1&e)&&N!==(N=t[0].constructor.name+"")&&y(r,N),(!R||1&e)&&L!==(L=t[0].kind+"")&&y(i,L),t[5]?A?A.p(t,e):(A=Bt(t),A.c(),A.m(n,s)):A&&(A.d(1),A=null),(!R||1&e)&&O!==(O=t[0].readyState+"")&&y(l,O),(!R||1&e)&&D!==(D=t[0].muted?"muted":"unmuted")&&y(p,D),(!R||5&e)&&M!==(M=JSON.stringify({id:t[0].id,kind:t[0].kind,constraints:t[2]},null,4)+"")&&y(w,M);const o={};2&e&&(o.data=t[1]),S.$set(o);const c={};8&e&&(c.data=t[3]),E.$set(c)},i(t){R||(W(S.$$.fragment,t),W(E.$$.fragment,t),R=!0)},o(t){z(S.$$.fragment,t),z(E.$$.fragment,t),R=!1},d(t){t&&m(e),A&&A.d(),Y(S),Y(E)}}}function Bt(t){let e,n,r,o;return{c(){e=h("| "),n=h(t[5]),r=h("x"),o=h(t[4])},m(t,c){f(t,e,c),f(t,n,c),f(t,r,c),f(t,o,c)},p(t,e){32&e&&y(n,t[5]),16&e&&y(o,t[4])},d(t){t&&m(e),t&&m(n),t&&m(r),t&&m(o)}}}function Jt(t){let e,n,r=t[0]&&It(t);return{c(){r&&r.c(),e=v()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&W(r,1)):(r=It(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),P())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function Ft(t,e,n){let r,o,c,i,a,{track:s}=e;return T((()=>{const t=setInterval((()=>{n(1,c=s?.getSettings?.()),n(2,i=s?.getConstraints?.()),n(3,a=s?.getCapabilities?.())}),500);return()=>clearInterval(t)})),t.$$set=t=>{"track"in t&&n(0,s=t.track)},t.$$.update=()=>{1&t.$$.dirty&&n(5,r=s?.getSettings().width),1&t.$$.dirty&&n(4,o=s?.getSettings().height)},[s,c,i,a,o,r]}const qt=class extends tt{constructor(t){super(),Z(this,t,Ft,Jt,c,{track:0})}};function Ht(t,e,n){const r=t.slice();return r[2]=e[n],r}function Ut(t){let e,n,r,o,c,i,a=t[0].constructor.name+"",s=t[1]?"active":"inactive",l=t[0].getTracks(),u=[];for(let e=0;e<l.length;e+=1)u[e]=Pt(Ht(t,l,e));const d=t=>z(u[t],1,1,(()=>{u[t]=null}));return{c(){e=h(a),n=h("\n    ("),r=h(s),o=h(")\n    ");for(let t=0;t<u.length;t+=1)u[t].c();c=v()},m(t,a){f(t,e,a),f(t,n,a),f(t,r,a),f(t,o,a);for(let e=0;e<u.length;e+=1)u[e].m(t,a);f(t,c,a),i=!0},p(t,n){if((!i||1&n)&&a!==(a=t[0].constructor.name+"")&&y(e,a),(!i||2&n)&&s!==(s=t[1]?"active":"inactive")&&y(r,s),1&n){let e;for(l=t[0].getTracks(),e=0;e<l.length;e+=1){const r=Ht(t,l,e);u[e]?(u[e].p(r,n),W(u[e],1)):(u[e]=Pt(r),u[e].c(),W(u[e],1),u[e].m(c.parentNode,c))}for(U(),e=l.length;e<u.length;e+=1)d(e);P()}},i(t){if(!i){for(let t=0;t<l.length;t+=1)W(u[t]);i=!0}},o(t){u=u.filter(Boolean);for(let t=0;t<u.length;t+=1)z(u[t]);i=!1},d(t){t&&m(e),t&&m(n),t&&m(r),t&&m(o),p(u,t),t&&m(c)}}}function Pt(t){let e,n;return e=new qt({props:{track:t[2]}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.track=t[2]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Wt(t){let e,n,r=t[0]&&Ut(t);return{c(){r&&r.c(),e=v()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&W(r,1)):(r=Ut(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),P())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function zt(t,e,n){let{stream:r}=e,o=r?.active;return T((()=>{const t=setInterval((()=>{n(1,o=r?.active)}),500);return()=>clearInterval(t)})),t.$$set=t=>{"stream"in t&&n(0,r=t.stream)},[r,o]}const Vt=class extends tt{constructor(t){super(),Z(this,t,zt,Wt,c,{stream:0})}};function Gt(t,e,n){const r=t.slice();return r[22]=e[n],r}function Xt(t,e,n){const r=t.slice();return r[25]=e[n],r[27]=n,r}function Kt(t){let e,n,r,o,c,i=(t[25].label||`camera ${t[27]}`)+"";function a(){return t[14](t[25])}return{c(){e=g("button"),n=h(i),r=$(),k(e,"class","svelte-vk2oy1")},m(t,i){f(t,e,i),d(e,n),d(e,r),o||(c=b(e,"click",a),o=!0)},p(e,r){t=e,8&r&&i!==(i=(t[25].label||`camera ${t[27]}`)+"")&&y(n,i)},d(t){t&&m(e),o=!1,c()}}}function Qt(t){let e;return{c(){e=h("✔️")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}function Yt(t){let e;return{c(){e=h("(canvas)")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}function Zt(t){let e,n,o,c,i,a,s,l,u,p,v,w,C,x,S,T,E,R=t[22].name+"",N=t[5](t[22]),L=t[2]===t[22]&&Qt();function O(){return t[15](t[22])}function D(){return t[16](t[22])}function M(){return t[17](t[22])}let A=N&&Yt();return{c(){e=g("tr"),n=g("td"),L&&L.c(),o=$(),c=g("td"),i=g("button"),a=h(R),s=$(),l=g("td"),u=g("button"),u.textContent="stop",p=$(),v=g("td"),w=g("button"),w.textContent="X",C=$(),x=g("td"),A&&A.c(),S=$(),k(i,"class","svelte-vk2oy1"),k(u,"class","svelte-vk2oy1"),k(w,"class","svelte-vk2oy1")},m(t,r){f(t,e,r),d(e,n),L&&L.m(n,null),d(e,o),d(e,c),d(c,i),d(i,a),d(e,s),d(e,l),d(l,u),d(e,p),d(e,v),d(v,w),d(e,C),d(e,x),A&&A.m(x,null),d(e,S),T||(E=[b(i,"click",O),b(u,"click",D),b(w,"click",M)],T=!0)},p(e,r){(t=e)[2]===t[22]?L||(L=Qt(),L.c(),L.m(n,null)):L&&(L.d(1),L=null),16&r&&R!==(R=t[22].name+"")&&y(a,R),16&r&&(N=t[5](t[22])),N?A||(A=Yt(),A.c(),A.m(x,null)):A&&(A.d(1),A=null)},d(t){t&&m(e),L&&L.d(),A&&A.d(),T=!1,r(E)}}}function te(t){let e,n,r,o;return r=new Vt({props:{stream:t[2]}}),{c(){e=g("h5"),e.textContent="current stream",n=$(),K(r.$$.fragment)},m(t,c){f(t,e,c),f(t,n,c),Q(r,t,c),o=!0},p(t,e){const n={};4&e&&(n.stream=t[2]),r.$set(n)},i(t){o||(W(r.$$.fragment,t),o=!0)},o(t){z(r.$$.fragment,t),o=!1},d(t){t&&m(e),t&&m(n),Y(r,t)}}}function ee(t){let e,n,o,c,i,a,s,l,u,h,v,y,w,C,x,S,T,E,R,N=t[3],L=[];for(let e=0;e<N.length;e+=1)L[e]=Kt(Xt(t,N,e));let O=t[4],D=[];for(let e=0;e<O.length;e+=1)D[e]=Zt(Gt(t,O,e));let M=t[2]&&te(t);return{c(){e=g("details"),n=g("summary"),n.innerHTML="<h5>video</h5>",o=$(),c=g("video"),c.innerHTML='<track kind="captions"/>',a=$(),s=g("nav"),l=g("button"),l.textContent="default",u=$(),h=g("button"),h.textContent="noise",v=$(),y=g("br"),w=$();for(let t=0;t<L.length;t+=1)L[t].c();C=$(),x=g("table");for(let t=0;t<D.length;t+=1)D[t].c();S=$(),M&&M.c(),k(c,"id","upstream"),c.autoplay=i=!0,k(c,"class","svelte-vk2oy1"),k(l,"class","svelte-vk2oy1"),k(h,"class","svelte-vk2oy1"),k(s,"class","svelte-vk2oy1")},m(r,i){f(r,e,i),d(e,n),d(e,o),d(e,c),t[11](c),d(e,a),d(e,s),d(s,l),d(s,u),d(s,h),d(s,v),d(s,y),d(s,w);for(let t=0;t<L.length;t+=1)L[t].m(s,null);d(e,C),d(e,x);for(let t=0;t<D.length;t+=1)D[t].m(x,null);d(e,S),M&&M.m(e,null),e.open=t[0],T=!0,E||(R=[b(l,"click",t[12]),b(h,"click",t[13]),b(e,"toggle",t[18])],E=!0)},p(t,[n]){if(136&n){let e;for(N=t[3],e=0;e<N.length;e+=1){const r=Xt(t,N,e);L[e]?L[e].p(r,n):(L[e]=Kt(r),L[e].c(),L[e].m(s,null))}for(;e<L.length;e+=1)L[e].d(1);L.length=N.length}if(1844&n){let e;for(O=t[4],e=0;e<O.length;e+=1){const r=Gt(t,O,e);D[e]?D[e].p(r,n):(D[e]=Zt(r),D[e].c(),D[e].m(x,null))}for(;e<D.length;e+=1)D[e].d(1);D.length=O.length}t[2]?M?(M.p(t,n),4&n&&W(M,1)):(M=te(t),M.c(),W(M,1),M.m(e,null)):M&&(U(),z(M,1,1,(()=>{M=null})),P()),1&n&&(e.open=t[0])},i(t){T||(W(M),T=!0)},o(t){z(M),T=!1},d(n){n&&m(e),t[11](null),p(L,n),p(D,n),M&&M.d(),E=!1,r(R)}}}function ne(t,e,n){let{open:r}=e;const o=E();let c,i,a=[],s=[];async function l(){const t=function(){let t=Object.assign(document.createElement("canvas"),{width:400,height:300}),e=t.getContext("2d");e.fillRect(0,0,t.width,t.height);let n=e.getImageData(0,0,t.width,t.height);return requestAnimationFrame((function t(){for(var r=0;r<n.data.length;r++)n.data[r++]=n.data[r++]=n.data[r++]=255*Math.random();e.putImageData(n,0,0),requestAnimationFrame(t)})),t.captureStream(60)}();t.name="noise feed",d(t),n(4,s=[...s,t])}async function u(t){const e=await async function(t){const e={video:!t||{deviceId:t}};return await navigator.mediaDevices.getUserMedia(e)}(t);e.name=t?function(t){const e=t&&a.find((({deviceId:e})=>e===t));return e&&e.label}(t):"default webcam",d(e),n(4,s=[...s,e])}function d(t){n(2,i=t),n(1,c.srcObject=t,c),o("stream",t)}function f(t){t.getTracks().forEach((t=>t.stop())),o("stop",t)}function m(t){f(t),n(4,s=[...s.filter((e=>e!=t))]),i===t&&n(2,i=void 0)}async function p(){const t=await navigator.mediaDevices.enumerateDevices();n(3,a=t.filter((({kind:t})=>"videoinput"===t)))}return T((()=>{p();const t=()=>p();return navigator.mediaDevices.addEventListener("devicechange",t),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}})),t.$$set=t=>{"open"in t&&n(0,r=t.open)},[r,c,i,a,s,t=>"CanvasCaptureMediaStream"===t?.constructor.name||"CanvasCaptureMediaStreamTrack"===t?.getTracks()[0].constructor.name,l,u,d,f,m,function(t){N[t?"unshift":"push"]((()=>{c=t,n(1,c)}))},()=>u(),()=>l(),t=>u(t.deviceId),t=>d(t),t=>f(t),t=>m(t),function(){r=this.open,n(0,r)}]}const re=class extends tt{constructor(t){super(),Z(this,t,ne,ee,c,{open:0})}};function oe(t){let e,n;return e=new qt({props:{track:t[1]}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};2&n&&(r.track=t[1]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function ce(t){let e,n,r,o,c,i,a,s=t[1]&&oe(t);return{c(){e=g("h5"),e.textContent="downstream",n=$(),r=g("video"),r.innerHTML='<track kind="captions"/>',c=$(),s&&s.c(),i=v(),r.autoplay=o=!0},m(o,l){f(o,e,l),f(o,n,l),f(o,r,l),t[3](r),f(o,c,l),s&&s.m(o,l),f(o,i,l),a=!0},p(t,[e]){t[1]?s?(s.p(t,e),2&e&&W(s,1)):(s=oe(t),s.c(),W(s,1),s.m(i.parentNode,i)):s&&(U(),z(s,1,1,(()=>{s=null})),P())},i(t){a||(W(s),a=!0)},o(t){z(s),a=!1},d(o){o&&m(e),o&&m(n),o&&m(r),t[3](null),o&&m(c),s&&s.d(o),o&&m(i)}}}function ie(t,e,n){let r,o,{stream:c}=e;return t.$$set=t=>{"stream"in t&&n(2,c=t.stream)},t.$$.update=()=>{4&t.$$.dirty&&n(1,r=c&&c.getTracks()[0]),5&t.$$.dirty&&o&&n(0,o.srcObject=c,o)},[o,r,c,function(t){N[t?"unshift":"push"]((()=>{o=t,n(0,o),n(2,c)}))}]}const ae=class extends tt{constructor(t){super(),Z(this,t,ie,ce,c,{stream:2})}};function se(e){let n,o,c,i,a,s,l;return{c(){n=g("form"),o=g("input"),c=$(),i=g("code"),a=h(e[0]),k(o,"size","90"),k(o,"placeholder","ws url")},m(t,r){var u;f(t,n,r),d(n,o),w(o,e[1]),f(t,c,r),f(t,i,r),d(i,a),s||(l=[b(o,"input",e[2]),b(n,"submit",(u=le,function(t){return t.preventDefault(),u.call(this,t)}))],s=!0)},p(t,[e]){2&e&&o.value!==t[1]&&w(o,t[1]),1&e&&y(a,t[0])},i:t,o:t,d(t){t&&m(n),t&&m(c),t&&m(i),s=!1,r(l)}}}function le(){}function ue(t,e,n){let r,{signalingClient:o}=e;return t.$$set=t=>{"signalingClient"in t&&n(0,o=t.signalingClient)},t.$$.update=()=>{3&t.$$.dirty&&(o.connect({url:r}),window.client=o)},n(1,r=`wss://${window.location.host}/signaling/test`),[o,r,function(){r=this.value,n(1,r)}]}const de=class extends tt{constructor(t){super(),Z(this,t,ue,se,c,{signalingClient:0})}};function fe(t){let e,n,r,o,c,i=t[0].state+"";return o=new _t({props:{summary:"iceTransport",open:!1,data:t[1]}}),{c(){e=h("state: "),n=h(i),r=$(),K(o.$$.fragment)},m(t,i){f(t,e,i),f(t,n,i),f(t,r,i),Q(o,t,i),c=!0},p(t,e){(!c||1&e)&&i!==(i=t[0].state+"")&&y(n,i);const r={};1&e&&(r.data=t[1]),o.$set(r)},i(t){c||(W(o.$$.fragment,t),c=!0)},o(t){z(o.$$.fragment,t),c=!1},d(t){t&&m(e),t&&m(n),t&&m(r),Y(o,t)}}}function me(t){let e,n,r=t[0]&&fe(t);return{c(){r&&r.c(),e=v()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&W(r,1)):(r=fe(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),P())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function pe(t,e,n){let{transport:r}=e;return t.$$set=t=>{"transport"in t&&n(0,r=t.transport)},[r,()=>({role:r.iceTransport.role,component:r.iceTransport.component,state:r.iceTransport.state,gatheringState:r.iceTransport.gatheringState})]}const ge=class extends tt{constructor(t){super(),Z(this,t,pe,me,c,{transport:0})}};function he(t){let e,n,r,o,c,i,a=t[0]&&$e(t);return{c(){e=g("details"),n=g("summary"),n.textContent="Receiver",r=$(),a&&a.c()},m(s,l){f(s,e,l),d(e,n),d(e,r),a&&a.m(e,null),e.open=t[0],o=!0,c||(i=b(e,"toggle",t[5]),c=!0)},p(t,n){t[0]?a?(a.p(t,n),1&n&&W(a,1)):(a=$e(t),a.c(),W(a,1),a.m(e,null)):a&&(U(),z(a,1,1,(()=>{a=null})),P()),1&n&&(e.open=t[0])},i(t){o||(W(a),o=!0)},o(t){z(a),o=!1},d(t){t&&m(e),a&&a.d(),c=!1,i()}}}function $e(t){let e,n,r,o,c,i,a,s,l,u,p,v,b,w,C,x,S,T,E,R,N,L,O,D,M,A,j,_,I,B,J,F,q,H=JSON.stringify(t[4])+"",U=JSON.stringify(t[3])+"";return i=new qt({props:{track:t[1].track}}),v=new _t({props:{summary:"verbose",data:t[2],open:!1}}),T=new ge({props:{transport:t[1].transport}}),{c(){e=g("table"),n=g("tr"),r=g("th"),r.textContent="track",o=$(),c=g("td"),K(i.$$.fragment),a=$(),s=g("tr"),l=g("th"),l.textContent="parameters",u=$(),p=g("td"),K(v.$$.fragment),b=$(),w=g("tr"),C=g("th"),C.textContent="transport",x=$(),S=g("td"),K(T.$$.fragment),E=$(),R=g("tr"),N=g("th"),N.textContent="ssrcs",L=$(),O=g("td"),D=g("code"),M=h(H),A=$(),j=g("tr"),_=g("th"),_.textContent="csrcs",I=$(),B=g("td"),J=g("code"),F=h(U),k(e,"class","vertical")},m(t,m){f(t,e,m),d(e,n),d(n,r),d(n,o),d(n,c),Q(i,c,null),d(e,a),d(e,s),d(s,l),d(s,u),d(s,p),Q(v,p,null),d(e,b),d(e,w),d(w,C),d(w,x),d(w,S),Q(T,S,null),d(e,E),d(e,R),d(R,N),d(R,L),d(R,O),d(O,D),d(D,M),d(e,A),d(e,j),d(j,_),d(j,I),d(j,B),d(B,J),d(J,F),q=!0},p(t,e){const n={};2&e&&(n.track=t[1].track),i.$set(n);const r={};4&e&&(r.data=t[2]),v.$set(r);const o={};2&e&&(o.transport=t[1].transport),T.$set(o),(!q||16&e)&&H!==(H=JSON.stringify(t[4])+"")&&y(M,H),(!q||8&e)&&U!==(U=JSON.stringify(t[3])+"")&&y(F,U)},i(t){q||(W(i.$$.fragment,t),W(v.$$.fragment,t),W(T.$$.fragment,t),q=!0)},o(t){z(i.$$.fragment,t),z(v.$$.fragment,t),z(T.$$.fragment,t),q=!1},d(t){t&&m(e),Y(i),Y(v),Y(T)}}}function ve(t){let e,n,r=t[1]&&he(t);return{c(){r&&r.c(),e=v()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&W(r,1)):(r=he(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),P())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function be(t,e,n){let r,o,c,{receiver:i}=e,{open:a=!1}=e;return T((()=>{const t=setInterval((()=>{n(2,r=i?.getParameters?.()),n(3,o=i.getContributingSources()),n(4,c=i.getSynchronizationSources())}),500);return()=>clearInterval(t)})),t.$$set=t=>{"receiver"in t&&n(1,i=t.receiver),"open"in t&&n(0,a=t.open)},[a,i,r,o,c,function(){a=this.open,n(0,a)}]}const ke=class extends tt{constructor(t){super(),Z(this,t,be,ve,c,{receiver:1,open:0})}};function ye(t){let e,n,r,o,c,i,a=t[0]&&we(t);return{c(){e=g("details"),n=g("summary"),n.textContent="Sender",r=$(),a&&a.c()},m(s,l){f(s,e,l),d(e,n),d(e,r),a&&a.m(e,null),e.open=t[0],o=!0,c||(i=b(e,"toggle",t[8]),c=!0)},p(t,n){t[0]?a?(a.p(t,n),1&n&&W(a,1)):(a=we(t),a.c(),W(a,1),a.m(e,null)):a&&(U(),z(a,1,1,(()=>{a=null})),P()),1&n&&(e.open=t[0])},i(t){o||(W(a),o=!0)},o(t){z(a),o=!1},d(t){t&&m(e),a&&a.d(),c=!1,i()}}}function we(t){let e,n,o,c,i,a,s,l,u,p,v,y,w,C,x,S,T,E,R,N,L,O,D,M,A,j,_,I;a=new qt({props:{track:t[1].track}}),y=new _t({props:{summary:"verbose",data:t[4],open:!1}}),E=new ge({props:{transport:t[1].transport}});let B=t[4]&&Ce(t);return{c(){e=g("table"),n=g("tr"),o=g("th"),o.textContent="track",c=$(),i=g("td"),K(a.$$.fragment),s=$(),l=g("tr"),u=g("th"),u.textContent="parameters",p=$(),v=g("td"),K(y.$$.fragment),w=$(),C=g("tr"),x=g("th"),x.textContent="transport",S=$(),T=g("td"),K(E.$$.fragment),R=$(),B&&B.c(),N=$(),L=g("button"),O=h("replaceTrack"),M=$(),A=g("button"),A.textContent="remove",k(e,"class","vertical"),k(L,"class","btn-small"),L.disabled=D=!Boolean(t[2]),k(A,"class","btn-small")},m(r,m){f(r,e,m),d(e,n),d(n,o),d(n,c),d(n,i),Q(a,i,null),d(e,s),d(e,l),d(l,u),d(l,p),d(l,v),Q(y,v,null),d(e,w),d(e,C),d(C,x),d(C,S),d(C,T),Q(E,T,null),d(e,R),B&&B.m(e,null),f(r,N,m),f(r,L,m),d(L,O),f(r,M,m),f(r,A,m),j=!0,_||(I=[b(L,"click",t[6]),b(A,"click",t[7])],_=!0)},p(t,n){const r={};2&n&&(r.track=t[1].track),a.$set(r);const o={};16&n&&(o.data=t[4]),y.$set(o);const c={};2&n&&(c.transport=t[1].transport),E.$set(c),t[4]?B?B.p(t,n):(B=Ce(t),B.c(),B.m(e,null)):B&&(B.d(1),B=null),(!j||4&n&&D!==(D=!Boolean(t[2])))&&(L.disabled=D)},i(t){j||(W(a.$$.fragment,t),W(y.$$.fragment,t),W(E.$$.fragment,t),j=!0)},o(t){z(a.$$.fragment,t),z(y.$$.fragment,t),z(E.$$.fragment,t),j=!1},d(t){t&&m(e),Y(a),Y(y),Y(E),B&&B.d(),t&&m(N),t&&m(L),t&&m(M),t&&m(A),_=!1,r(I)}}}function Ce(t){let e,n,r,o,c,i,a,s,l,u,p,v,b,k=JSON.stringify(t[4].rtcp)+"",w=JSON.stringify(t[4].encodings)+"";return{c(){e=g("tr"),n=g("th"),n.textContent="rtcp",r=$(),o=g("td"),c=g("code"),i=h(k),a=$(),s=g("tr"),l=g("th"),l.textContent="encodings",u=$(),p=g("td"),v=g("code"),b=h(w)},m(t,m){f(t,e,m),d(e,n),d(e,r),d(e,o),d(o,c),d(c,i),f(t,a,m),f(t,s,m),d(s,l),d(s,u),d(s,p),d(p,v),d(v,b)},p(t,e){16&e&&k!==(k=JSON.stringify(t[4].rtcp)+"")&&y(i,k),16&e&&w!==(w=JSON.stringify(t[4].encodings)+"")&&y(b,w)},d(t){t&&m(e),t&&m(a),t&&m(s)}}}function xe(t){let e,n,r=t[1]&&ye(t);return{c(){r&&r.c(),e=v()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&W(r,1)):(r=ye(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),P())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function Se(t,e,n){let r,{sender:o}=e,{open:c=!1}=e,{mediaStream:i}=e,{onRemove:a=(()=>console.warn("no callback"))}=e;function s(t,e){ut("rts","replace track per sender"),console.info("replace track",{sender:e}),e.replaceTrack(t.getTracks()[0])}return T((()=>{const t=setInterval((()=>{n(4,r=o?.getParameters?.())}),500);return()=>clearInterval(t)})),t.$$set=t=>{"sender"in t&&n(1,o=t.sender),"open"in t&&n(0,c=t.open),"mediaStream"in t&&n(2,i=t.mediaStream),"onRemove"in t&&n(3,a=t.onRemove)},[c,o,i,a,r,s,()=>s(i,o),()=>a(o),function(){c=this.open,n(0,c)}]}const Te=class extends tt{constructor(t){super(),Z(this,t,Se,xe,c,{sender:1,open:0,mediaStream:2,onRemove:3})}},{Boolean:Ee}=V;function Re(t,e,n){const r=t.slice();return r[15]=e[n],r[16]=e,r[17]=n,r}function Ne(t,e,n){const r=t.slice();return r[18]=e[n],r}function Le(t){let e,n,r=t[1],o=[];for(let e=0;e<r.length;e+=1)o[e]=je(Re(t,r,e));const c=t=>z(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=v()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);f(t,e,r),n=!0},p(t,n){if(59&n){let i;for(r=t[1],i=0;i<r.length;i+=1){const c=Re(t,r,i);o[i]?(o[i].p(c,n),W(o[i],1)):(o[i]=je(c),o[i].c(),W(o[i],1),o[i].m(e.parentNode,e))}for(U(),i=r.length;i<o.length;i+=1)c(i);P()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)W(o[t]);n=!0}},o(t){o=o.filter(Ee);for(let t=0;t<o.length;t+=1)z(o[t]);n=!1},d(t){p(o,t),t&&m(e)}}}function Oe(t){let e,n,c,i,a,s,l,u,v,w,C,x,S,T,E,R,N,L,O,D,M,A,j,_,I,B,J,F,q,H,V,G,X,Z,tt,et,nt,rt,ot,ct,it,at=t[15].mid+"",st=t[15].currentDirection+"",lt=t[4].has(t[15]),ut=t[4].has(t[15]),dt=["sendrecv","sendonly","recvonly","inactive"],ft=[];for(let e=0;e<4;e+=1)ft[e]=De(Ne(t,dt,e));function mt(...e){return t[9](t[15],t[16],t[17],...e)}let pt=lt&&Me(t);function gt(){return t[10](t[15])}_=new Te({props:{sender:t[15].sender}}),F=new ke({props:{receiver:t[15].receiver}});let ht=ut&&Ae(t);function $t(){return t[12](t[15])}function vt(){return t[13](t[15])}return{c(){e=g("div"),n=g("table"),c=g("tr"),i=g("th"),i.textContent="mid",a=$(),s=g("td"),l=g("code"),u=h(at),v=$(),w=g("tr"),C=g("th"),C.textContent="direction",x=$(),S=g("td"),T=g("select");for(let t=0;t<4;t+=1)ft[t].c();E=$(),R=g("strong"),N=h("→ "),L=g("code"),O=h(st),D=$(),pt&&pt.c(),M=$(),A=g("hr"),j=$(),K(_.$$.fragment),I=$(),B=g("hr"),J=$(),K(F.$$.fragment),q=$(),H=g("div"),V=g("button"),V.textContent="replaceTrack",G=$(),X=g("button"),X.textContent="replaceTrack(null)",Z=$(),ht&&ht.c(),tt=$(),et=g("button"),et.textContent="stop",nt=$(),rt=g("button"),rt.textContent="removeTrack",k(i,"class","svelte-5ps5s4"),k(C,"class","svelte-5ps5s4"),k(n,"class","vertical"),k(V,"class","btn-small"),k(X,"class","btn-small"),k(et,"class","btn-small"),k(rt,"class","btn-small")},m(r,m){f(r,e,m),d(e,n),d(n,c),d(c,i),d(c,a),d(c,s),d(s,l),d(l,u),d(n,v),d(n,w),d(w,C),d(w,x),d(w,S),d(S,T);for(let t=0;t<4;t+=1)ft[t].m(T,null);d(S,E),d(S,R),d(R,N),d(R,L),d(L,O),d(n,D),pt&&pt.m(n,null),d(e,M),d(e,A),d(e,j),Q(_,e,null),d(e,I),d(e,B),d(e,J),Q(F,e,null),f(r,q,m),f(r,H,m),d(H,V),d(H,G),d(H,X),d(H,Z),ht&&ht.m(H,null),d(H,tt),d(H,et),d(H,nt),d(H,rt),ot=!0,ct||(it=[b(T,"change",mt),b(V,"click",(function(){o(t[5](t[15].sender))&&t[5](t[15].sender).apply(this,arguments)})),b(X,"click",gt),b(et,"click",$t),b(rt,"click",vt)],ct=!0)},p(e,r){if(t=e,(!ot||2&r)&&at!==(at=t[15].mid+"")&&y(u,at),2&r){let e;for(dt=["sendrecv","sendonly","recvonly","inactive"],e=0;e<4;e+=1){const n=Ne(t,dt,e);ft[e]?ft[e].p(n,r):(ft[e]=De(n),ft[e].c(),ft[e].m(T,null))}for(;e<4;e+=1)ft[e].d(1)}(!ot||2&r)&&st!==(st=t[15].currentDirection+"")&&y(O,st),2&r&&(lt=t[4].has(t[15])),lt?pt?(pt.p(t,r),2&r&&W(pt,1)):(pt=Me(t),pt.c(),W(pt,1),pt.m(n,null)):pt&&(U(),z(pt,1,1,(()=>{pt=null})),P());const o={};2&r&&(o.sender=t[15].sender),_.$set(o);const c={};2&r&&(c.receiver=t[15].receiver),F.$set(c),2&r&&(ut=t[4].has(t[15])),ut?ht?ht.p(t,r):(ht=Ae(t),ht.c(),ht.m(H,tt)):ht&&(ht.d(1),ht=null)},i(t){ot||(W(pt),W(_.$$.fragment,t),W(F.$$.fragment,t),ot=!0)},o(t){z(pt),z(_.$$.fragment,t),z(F.$$.fragment,t),ot=!1},d(t){t&&m(e),p(ft,t),pt&&pt.d(),Y(_),Y(F),t&&m(q),t&&m(H),ht&&ht.d(),ct=!1,r(it)}}}function De(t){let e,n,r,o;return{c(){e=g("option"),n=h(t[18]),e.__value=r=t[18],e.value=e.__value,e.selected=o=t[18]===t[15].currentDirection||"inactive"===t[18]&&null===t[15].currentDirection},m(t,r){f(t,e,r),d(e,n)},p(t,n){2&n&&o!==(o=t[18]===t[15].currentDirection||"inactive"===t[18]&&null===t[15].currentDirection)&&(e.selected=o)},d(t){t&&m(e)}}}function Me(t){let e,n,r,o,c,i;return c=new qt({props:{track:t[4].get(t[15])}}),{c(){e=g("tr"),n=g("th"),n.textContent="track",r=$(),o=g("td"),K(c.$$.fragment),k(n,"class","svelte-5ps5s4")},m(t,a){f(t,e,a),d(e,n),d(e,r),d(e,o),Q(c,o,null),i=!0},p(t,e){const n={};2&e&&(n.track=t[4].get(t[15])),c.$set(n)},i(t){i||(W(c.$$.fragment,t),i=!0)},o(t){z(c.$$.fragment,t),i=!1},d(t){t&&m(e),Y(c)}}}function Ae(t){let e,n,r;function o(){return t[11](t[15])}return{c(){e=g("button"),e.textContent="display track",k(e,"class","btn-small")},m(t,c){f(t,e,c),n||(r=b(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&m(e),n=!1,r()}}}function je(t){let e,n,r,o=(null!==t[15].mid||t[15].track,Oe(t));return{c(){e=g("div"),o&&o.c(),n=$(),k(e,"class","grid box svelte-5ps5s4")},m(t,c){f(t,e,c),o&&o.m(e,null),d(e,n),r=!0},p(t,r){null!==t[15].mid||t[15].track,o?(o.p(t,r),2&r&&W(o,1)):(o=Oe(t),o.c(),W(o,1),o.m(e,n))},i(t){r||(W(o),r=!0)},o(t){z(o),r=!1},d(t){t&&m(e),o&&o.d()}}}function _e(t){let e,n,o,c,i,a,s,l,u,p,h,v=t[1]&&Le(t);return{c(){e=g("details"),n=g("summary"),n.innerHTML="<h5>transceivers</h5>",o=$(),v&&v.c(),c=$(),i=g("button"),i.textContent="add video transceiver",a=$(),s=g("button"),s.textContent="update",k(s,"class","btn-small"),e.open=l=Boolean(t[2].showTransceivers)},m(r,l){f(r,e,l),d(e,n),d(e,o),v&&v.m(e,null),d(e,c),d(e,i),d(e,a),d(e,s),u=!0,p||(h=[b(i,"click",t[6]),b(s,"click",t[7])],p=!0)},p(t,[n]){t[1]?v?(v.p(t,n),2&n&&W(v,1)):(v=Le(t),v.c(),W(v,1),v.m(e,c)):v&&(U(),z(v,1,1,(()=>{v=null})),P()),(!u||4&n&&l!==(l=Boolean(t[2].showTransceivers)))&&(e.open=l)},i(t){u||(W(v),u=!0)},o(t){z(v),u=!1},d(t){t&&m(e),v&&v.d(),p=!1,r(h)}}}function Ie(t,e,n){let r,o;s(t,st,(t=>n(2,o=t)));let{peerconnection:c}=e,{streamSource:i}=e;const a=E();let l;const u=new Map;function d(){n(1,l=c&&c.getTransceivers())}return T((async()=>{const t=setInterval((()=>{r&&d()}),1e3);return await(A(),D),c.addEventListener("track",(({track:t,transceiver:e})=>{u.set(e,t),d()})),()=>clearInterval(t)})),t.$$set=t=>{"peerconnection"in t&&n(0,c=t.peerconnection),"streamSource"in t&&n(8,i=t.streamSource)},t.$$.update=()=>{1&t.$$.dirty&&(r=c&&c.getTransceivers())},[c,l,o,a,u,function(t){return()=>{const e=i().getTracks()[0];e&&t.replaceTrack(e)}},function(){c.addTransceiver("video"),r=c.getTransceivers(),d()},d,i,(t,e,r,{target:o})=>n(1,e[r].direction=o.value,l),t=>t.sender.replaceTrack(null),t=>a("track",u.get(t)),t=>t.stop(),t=>c.removeTrack(t.sender)]}const Be=class extends tt{constructor(t){super(),Z(this,t,Ie,_e,c,{peerconnection:0,streamSource:8})}};function Je(t){let e,n,r,o,c,i,a,s,l,u,p,v,x,S,T,E,R,N,L,O=t[4].join(", ")+"";return{c(){e=g("textarea"),n=$(),r=g("div"),o=g("table"),c=g("tr"),i=g("th"),i.textContent="mlines",a=$(),s=g("td"),l=g("code"),u=h(t[5]),p=$(),v=g("tr"),x=g("th"),x.textContent="directions",S=$(),T=g("td"),E=g("code"),R=h(O),k(e,"rows",t[1]),k(e,"name",t[2]),k(e,"class","svelte-1n5wbpe"),C(e,"hideSignaling",t[3]),k(o,"class","vertical"),k(r,"class","box")},m(m,g){f(m,e,g),w(e,t[0]),f(m,n,g),f(m,r,g),d(r,o),d(o,c),d(c,i),d(c,a),d(c,s),d(s,l),d(l,u),d(o,p),d(o,v),d(v,x),d(v,S),d(v,T),d(T,E),d(E,R),N||(L=b(e,"input",t[7]),N=!0)},p(t,n){2&n&&k(e,"rows",t[1]),4&n&&k(e,"name",t[2]),1&n&&w(e,t[0]),8&n&&C(e,"hideSignaling",t[3]),32&n&&y(u,t[5]),16&n&&O!==(O=t[4].join(", ")+"")&&y(R,O)},d(t){t&&m(e),t&&m(n),t&&m(r),N=!1,L()}}}function Fe(e){let n,r=!e[3]&&Je(e);return{c(){n=g("div"),r&&r.c()},m(t,e){f(t,n,e),r&&r.m(n,null)},p(t,[e]){t[3]?r&&(r.d(1),r=null):r?r.p(t,e):(r=Je(t),r.c(),r.m(n,null))},i:t,o:t,d(t){t&&m(n),r&&r.d()}}}function qe(t,e,n){let r,o,c,{value:i}=e,{rows:a}=e,{name:s}=e,{hideSignaling:l}=e;return t.$$set=t=>{"value"in t&&n(0,i=t.value),"rows"in t&&n(1,a=t.rows),"name"in t&&n(2,s=t.name),"hideSignaling"in t&&n(3,l=t.hideSignaling)},t.$$.update=()=>{1&t.$$.dirty&&n(6,r=i.split("\n")),64&t.$$.dirty&&n(5,o=r.filter((t=>t.startsWith("m="))).length),64&t.$$.dirty&&n(4,c=Array.from(r.filter((t=>t.startsWith("a=sendrecv")||t.startsWith("a=sendonly")||t.startsWith("a=recvonly")||t.startsWith("a=inactive"))),(t=>t?.slice(2))))},[i,a,s,l,c,o,r,function(){i=this.value,n(0,i)}]}const He=class extends tt{constructor(t){super(),Z(this,t,qe,Fe,c,{value:0,rows:1,name:2,hideSignaling:3})}};function Ue(t,e,n){const r=t.slice();return r[33]=e[n],r}function Pe(t,e,n){const r=t.slice();return r[36]=e[n],r[38]=n,r}function We(t){let e,n,r,o,c=(t[36].label||`micorophone ${t[38]}`)+"";function i(){return t[14](t[36])}return{c(){e=g("button"),n=h(c),k(e,"class","svelte-2jsuhx")},m(t,c){f(t,e,c),d(e,n),r||(o=b(e,"click",i),r=!0)},p(e,r){t=e,8&r[0]&&c!==(c=(t[36].label||`micorophone ${t[38]}`)+"")&&y(n,c)},d(t){t&&m(e),r=!1,o()}}}function ze(t){let e;return{c(){e=h("✔️")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}function Ve(t){let e,n,o,c,i,a,s,l,u,p,v,w,C,x,S,T=t[33].name+"",E=t[2]===t[33]&&ze();function R(){return t[19](t[33])}function N(){return t[20](t[33])}function L(){return t[21](t[33])}return{c(){e=g("tr"),n=g("td"),E&&E.c(),o=$(),c=g("td"),i=g("button"),a=h(T),s=$(),l=g("td"),u=g("button"),u.textContent="stop",p=$(),v=g("td"),w=g("button"),w.textContent="X",C=$(),k(i,"class","svelte-2jsuhx"),k(u,"class","svelte-2jsuhx"),k(w,"class","svelte-2jsuhx")},m(t,r){f(t,e,r),d(e,n),E&&E.m(n,null),d(e,o),d(e,c),d(c,i),d(i,a),d(e,s),d(e,l),d(l,u),d(e,p),d(e,v),d(v,w),d(e,C),x||(S=[b(i,"click",R),b(u,"click",N),b(w,"click",L)],x=!0)},p(e,r){(t=e)[2]===t[33]?E||(E=ze(),E.c(),E.m(n,null)):E&&(E.d(1),E=null),16&r[0]&&T!==(T=t[33].name+"")&&y(a,T)},d(t){t&&m(e),E&&E.d(),x=!1,r(S)}}}function Ge(e){let n,o,c,i,a,s,l,u,h,v,y,w,C,x,S,T,E,R,N,L,O,D=e[3],M=[];for(let t=0;t<D.length;t+=1)M[t]=We(Pe(e,D,t));let A=e[4],j=[];for(let t=0;t<A.length;t+=1)j[t]=Ve(Ue(e,A,t));return{c(){n=g("details"),o=g("summary"),o.innerHTML="<h5>audio</h5>",c=$(),i=g("canvas"),a=$(),s=g("nav");for(let t=0;t<M.length;t+=1)M[t].c();l=$(),u=g("audio"),h=g("track"),w=$(),C=g("button"),C.textContent="bars",x=$(),S=g("button"),S.textContent="waveform",T=$(),E=g("button"),E.textContent="volume",R=$(),N=g("table");for(let t=0;t<j.length;t+=1)j[t].c();k(h,"kind","captions"),k(u,"id","upstream"),u.autoplay=v=!1,u.controls=y=Boolean(e[2]),k(s,"class","svelte-2jsuhx"),k(C,"class","svelte-2jsuhx"),k(S,"class","svelte-2jsuhx"),k(E,"class","svelte-2jsuhx")},m(t,r){f(t,n,r),d(n,o),d(n,c),d(n,i),e[13](i),d(n,a),d(n,s);for(let t=0;t<M.length;t+=1)M[t].m(s,null);d(s,l),d(s,u),d(u,h),e[15](u),d(n,w),d(n,C),d(n,x),d(n,S),d(n,T),d(n,E),d(n,R),d(n,N);for(let t=0;t<j.length;t+=1)j[t].m(N,null);n.open=e[0],L||(O=[b(C,"click",e[16]),b(S,"click",e[17]),b(E,"click",e[18]),b(n,"toggle",e[22])],L=!0)},p(t,e){if(520&e[0]){let n;for(D=t[3],n=0;n<D.length;n+=1){const r=Pe(t,D,n);M[n]?M[n].p(r,e):(M[n]=We(r),M[n].c(),M[n].m(s,l))}for(;n<M.length;n+=1)M[n].d(1);M.length=D.length}if(4&e[0]&&y!==(y=Boolean(t[2]))&&(u.controls=y),7188&e[0]){let n;for(A=t[4],n=0;n<A.length;n+=1){const r=Ue(t,A,n);j[n]?j[n].p(r,e):(j[n]=Ve(r),j[n].c(),j[n].m(N,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=A.length}1&e[0]&&(n.open=t[0])},i:t,o:t,d(t){t&&m(n),e[13](null),p(M,t),e[15](null),p(j,t),L=!1,r(O)}}}function Xe(t,e,n){let{open:r}=e;const o=E();let c,i,a,s,l,u,d,f=[],m=[];function p(){u&&u.stop(),u=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Uint8Array(r);let c;function i(){t.getByteTimeDomainData(o),n.fillStyle="rgb(0, 0, 0)",n.fillRect(0,0,e.width,e.height),n.lineWidth=2,n.strokeStyle="rgb(255, 255, 255)",n.beginPath();let a=1*e.width/r,s=0;for(let t=0;t<r;t++){const r=o[t]/128*e.height/2;0===t?n.moveTo(s,r):n.lineTo(s,r),s+=a}n.lineTo(e.width,e.height/2),n.stroke(),c=requestAnimationFrame(i)}return{start(){void 0===c&&i()},stop(){cancelAnimationFrame(c),c=void 0}}}({analyser:l,canvas:a}),u.start()}function g(){u&&u.stop(),u=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Float32Array(r);let c;const{width:i,height:a}=e;function s(){t.getFloatFrequencyData(o),n.fillStyle="rgb(0, 0, 0)",n.fillRect(0,0,i,a);for(var e,l=i/r*2.5,u=0,d=0;d<r;d++)e=2*(o[d]+140),n.fillStyle="rgb("+Math.floor(e+100)+",50,50)",n.fillRect(u,a-e/2,l,e/2),u+=l+1;c=requestAnimationFrame(s)}return{start(){void 0===c&&s()},stop(){cancelAnimationFrame(c),c=void 0}}}({analyser:l,canvas:a}),u.start()}function h(){u&&u.stop(),u=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Uint8Array(r);let c;function i(){t.getByteTimeDomainData(o),n.fillStyle="rgba(0, 0, 0, 0.1)",n.fillRect(0,0,e.width,e.height),n.font="15px sans-serif",n.strokeStyle="rgb(255, 255, 255)";let a=0;n.lineWidth=5;for(let t=0;t<r;t++){const n=o[t]/128*e.height/2;n>a&&(a=n)}let s=2*(a-75),l=e.height-s;n.beginPath(),n.moveTo(0,l),n.lineTo(e.width,l),n.stroke(),n.fillStyle="rgb(100,255,100)",n.fillRect(0,e.height,e.width,-e.height+l),n.fillStyle="rgb(0,0,0)",n.fillText(String(s),e.width-40,e.height-10),c=requestAnimationFrame(i)}return{start(){void 0===c&&i()},stop(){cancelAnimationFrame(c),c=void 0}}}({analyser:l,canvas:a}),u.start()}async function $(){const t=await navigator.mediaDevices.enumerateDevices();n(3,f=t.filter((({kind:t})=>"audioinput"===t)))}async function v(t){const e=await async function(t){const e={audio:!t||{deviceId:t}};return await navigator.mediaDevices.getUserMedia(e)}(t);e.name=function(t){const e=t&&f.find((({deviceId:e})=>e===t));return e&&e.label}(t),b(e),n(4,m=[...m,e])}function b(t){n(2,i=t),n(1,c.srcObject=t,c),function(t){console.debug("disconnecting",d),d?.disconnect(l),d=void 0;const e=s.createMediaStreamSource(t);e.connect(l),d=e}(t),o("stream",t)}function k(t){t.getTracks().forEach((t=>t.stop())),o("stop",t)}function y(t){k(t),n(4,m=[...m.filter((e=>e!=t))]),i===t&&n(2,i=void 0)}return T((()=>{$();const t=()=>$();return navigator.mediaDevices.addEventListener("devicechange",t),s||(s=new AudioContext,l=s.createAnalyser(),l.fftSize=2048),h(),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}})),t.$$set=t=>{"open"in t&&n(0,r=t.open)},[r,c,i,f,m,a,p,g,h,v,b,k,y,function(t){N[t?"unshift":"push"]((()=>{a=t,n(5,a)}))},t=>v(t.deviceId),function(t){N[t?"unshift":"push"]((()=>{c=t,n(1,c)}))},()=>g(),()=>p(),()=>h(),t=>b(t),t=>k(t),t=>y(t),function(){r=this.open,n(0,r)}]}const Ke=class extends tt{constructor(t){super(),Z(this,t,Xe,Ge,c,{open:0},null,[-1,-1])}},{Boolean:Qe}=V;function Ye(t,e,n){const r=t.slice();return r[85]=e[n],r}function Ze(t,e,n){const r=t.slice();return r[88]=e[n],r}function tn(e){let n,r;return n=new de({props:{signalingClient:e[29]}}),{c(){K(n.$$.fragment)},m(t,e){Q(n,t,e),r=!0},p:t,i(t){r||(W(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(t){Y(n,t)}}}function en(e){let n,r,o,c,i;return r=new re({props:{open:!0}}),r.$on("stream",e[49]),r.$on("stop",e[50]),c=new Ke({props:{open:!1}}),c.$on("stream",e[51]),c.$on("stop",e[52]),{c(){n=g("article"),K(r.$$.fragment),o=$(),K(c.$$.fragment),k(n,"id","upstream"),k(n,"class","box")},m(t,e){f(t,n,e),Q(r,n,null),d(n,o),Q(c,n,null),i=!0},p:t,i(t){i||(W(r.$$.fragment,t),W(c.$$.fragment,t),i=!0)},o(t){z(r.$$.fragment,t),z(c.$$.fragment,t),i=!1},d(t){t&&m(n),Y(r),Y(c)}}}function nn(t){let e,n,r;return n=new ae({props:{stream:void 0}}),t[53](n),{c(){e=g("article"),K(n.$$.fragment),k(e,"id","downstream"),k(e,"class","box")},m(t,o){f(t,e,o),Q(n,e,null),r=!0},p(t,e){n.$set({})},i(t){r||(W(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(r){r&&m(e),t[53](null),Y(n)}}}function rn(t){let e,n;return e=new Vt({props:{stream:t[12]}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};4096&n[0]&&(r.stream=t[12]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function on(t){let e,n;return e=new Te({props:{sender:t[88],open:!0,mediaStream:t[12],onRemove:t[54]}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};512&n[0]&&(r.sender=t[88]),4096&n[0]&&(r.mediaStream=t[12]),128&n[0]&&(r.onRemove=t[54]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function cn(t){let e,n;return e=new ke({props:{receiver:t[85],open:!0}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};1024&n[0]&&(r.receiver=t[85]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function an(t){let e,n,o,c,i,a,s,l,u,p,v,k,y;return{c(){e=g("button"),n=h("replaceTrack"),c=$(),i=g("button"),a=g("strike"),a.textContent="removeStream",l=$(),u=g("button"),p=h("removeTrack"),e.disabled=o=!Boolean(t[12]),i.disabled=s=!Boolean(t[12]),u.disabled=v=!Boolean(t[12])},m(r,o){f(r,e,o),d(e,n),f(r,c,o),f(r,i,o),d(i,a),f(r,l,o),f(r,u,o),d(u,p),k||(y=[b(e,"click",t[56]),b(i,"click",t[57]),b(u,"click",t[58])],k=!0)},p(t,n){4096&n[0]&&o!==(o=!Boolean(t[12]))&&(e.disabled=o),4096&n[0]&&s!==(s=!Boolean(t[12]))&&(i.disabled=s),4096&n[0]&&v!==(v=!Boolean(t[12]))&&(u.disabled=v)},d(t){t&&m(e),t&&m(c),t&&m(i),t&&m(l),t&&m(u),k=!1,r(y)}}}function sn(t){let e,n,r,o,c,i,a,s=t[28].join(" ")+"";return{c(){e=g("tr"),n=g("th"),n.textContent="events:",r=$(),o=g("td"),c=g("code"),i=g("small"),a=h(s)},m(t,s){f(t,e,s),d(e,n),d(e,r),d(e,o),d(o,c),d(c,i),d(i,a)},p(t,e){268435456&e[0]&&s!==(s=t[28].join(" ")+"")&&y(a,s)},d(t){t&&m(e)}}}function ln(t){let e,n,r,o,c,i,a,s,l,u,p,k,y=t[25]&&un(t),w=t[17]&&dn(t),C=t[26]&&!t[5].isManual&&fn(t),x=t[5].isManual&&mn(t);return{c(){y&&y.c(),e=$(),n=g("label"),r=h("1.\n                    "),o=g("button"),c=h("create offer"),i=$(),w&&w.c(),a=$(),C&&C.c(),s=$(),x&&x.c(),l=v(),o.disabled=t[25]},m(m,g){y&&y.m(m,g),f(m,e,g),f(m,n,g),d(n,r),d(n,o),d(o,c),f(m,i,g),w&&w.m(m,g),f(m,a,g),C&&C.m(m,g),f(m,s,g),x&&x.m(m,g),f(m,l,g),u=!0,p||(k=b(o,"click",t[37]),p=!0)},p(t,n){t[25]?y?y.p(t,n):(y=un(t),y.c(),y.m(e.parentNode,e)):y&&(y.d(1),y=null),(!u||33554432&n[0])&&(o.disabled=t[25]),t[17]?w?(w.p(t,n),131072&n[0]&&W(w,1)):(w=dn(t),w.c(),W(w,1),w.m(a.parentNode,a)):w&&(U(),z(w,1,1,(()=>{w=null})),P()),t[26]&&!t[5].isManual?C?(C.p(t,n),67108896&n[0]&&W(C,1)):(C=fn(t),C.c(),W(C,1),C.m(s.parentNode,s)):C&&(U(),z(C,1,1,(()=>{C=null})),P()),t[5].isManual?x?(x.p(t,n),32&n[0]&&W(x,1)):(x=mn(t),x.c(),W(x,1),x.m(l.parentNode,l)):x&&(U(),z(x,1,1,(()=>{x=null})),P())},i(t){u||(W(w),W(C),W(x),u=!0)},o(t){z(w),z(C),z(x),u=!1},d(t){y&&y.d(t),t&&m(e),t&&m(n),t&&m(i),w&&w.d(t),t&&m(a),C&&C.d(t),t&&m(s),x&&x.d(t),t&&m(l),p=!1,k()}}}function un(e){let n,r,o,c,i;return{c(){n=g("label"),r=h("0.\n                        "),o=g("button"),o.textContent="start call"},m(t,a){f(t,n,a),d(n,r),d(n,o),c||(i=b(o,"click",e[36]),c=!0)},p:t,d(t){t&&m(n),c=!1,i()}}}function dn(t){let e,n,o,c,i,a,s,l,u,p,v,k,y,w,C,x;function S(e){t[65](e)}let T={hideSignaling:t[22],rows:20};return void 0!==t[17]&&(T.value=t[17]),n=new He({props:T}),N.push((()=>X(n,"value",S))),{c(){e=g("div"),K(n.$$.fragment),c=$(),i=g("br"),a=$(),s=g("label"),l=h("2.\n                            "),u=g("button"),p=h("setLocalDescription"),v=$(),k=g("button"),y=h("send offer"),u.disabled=t[25],k.disabled=t[25]},m(r,o){f(r,e,o),Q(n,e,null),d(e,c),d(e,i),d(e,a),d(e,s),d(s,l),d(s,u),d(u,p),d(s,v),d(s,k),d(k,y),w=!0,C||(x=[b(u,"click",t[66]),b(k,"click",t[39])],C=!0)},p(t,e){const r={};4194304&e[0]&&(r.hideSignaling=t[22]),!o&&131072&e[0]&&(o=!0,r.value=t[17],_((()=>o=!1))),n.$set(r),(!w||33554432&e[0])&&(u.disabled=t[25]),(!w||33554432&e[0])&&(k.disabled=t[25])},i(t){w||(W(n.$$.fragment,t),w=!0)},o(t){z(n.$$.fragment,t),w=!1},d(t){t&&m(e),Y(n),C=!1,r(x)}}}function fn(t){let e,n,r,o,c,i,a,s,l,u,p,v,k;function y(e){t[67](e)}let w={hideSignaling:t[22],rows:20};return void 0!==t[26]&&(w.value=t[26]),n=new He({props:w}),N.push((()=>X(n,"value",y))),{c(){e=g("div"),K(n.$$.fragment),o=$(),c=g("br"),i=$(),a=g("label"),s=h("5.\n                            "),l=g("button"),u=h("setRemoteDescription"),l.disabled=t[25]},m(r,m){f(r,e,m),Q(n,e,null),d(e,o),d(e,c),d(e,i),d(e,a),d(a,s),d(a,l),d(l,u),p=!0,v||(k=b(l,"click",t[68]),v=!0)},p(t,e){const o={};4194304&e[0]&&(o.hideSignaling=t[22]),!r&&67108864&e[0]&&(r=!0,o.value=t[26],_((()=>r=!1))),n.$set(o),(!p||33554432&e[0])&&(l.disabled=t[25])},i(t){p||(W(n.$$.fragment,t),p=!0)},o(t){z(n.$$.fragment,t),p=!1},d(t){t&&m(e),Y(n),v=!1,k()}}}function mn(t){let e,n,r,o,c,i,a,s,l,u,p,v,k,y,w;function C(e){t[69](e)}let x={hideSignaling:t[22],rows:20};return void 0!==t[20]&&(x.value=t[20]),o=new He({props:x}),N.push((()=>X(o,"value",C))),{c(){e=g("div"),n=g("strong"),n.textContent="MANUAL ANSWER HERE",r=$(),K(o.$$.fragment),i=$(),a=g("br"),s=$(),l=g("label"),u=h("5.\n                            "),p=g("button"),v=h("setRemoteDescription"),p.disabled=t[25]},m(c,m){f(c,e,m),d(e,n),d(e,r),Q(o,e,null),d(e,i),d(e,a),d(e,s),d(e,l),d(l,u),d(l,p),d(p,v),k=!0,y||(w=b(p,"click",t[70]),y=!0)},p(t,e){const n={};4194304&e[0]&&(n.hideSignaling=t[22]),!c&&1048576&e[0]&&(c=!0,n.value=t[20],_((()=>c=!1))),o.$set(n),(!k||33554432&e[0])&&(p.disabled=t[25])},i(t){k||(W(o.$$.fragment,t),k=!0)},o(t){z(o.$$.fragment,t),k=!1},d(t){t&&m(e),Y(o),y=!1,w()}}}function pn(t){let e,n,r,o,c=t[27]&&!t[5].isManual&&gn(t),i=t[5].isManual&&hn(t),a=t[18]&&$n(t);return{c(){c&&c.c(),e=$(),i&&i.c(),n=$(),a&&a.c(),r=v()},m(t,s){c&&c.m(t,s),f(t,e,s),i&&i.m(t,s),f(t,n,s),a&&a.m(t,s),f(t,r,s),o=!0},p(t,o){t[27]&&!t[5].isManual?c?(c.p(t,o),134217760&o[0]&&W(c,1)):(c=gn(t),c.c(),W(c,1),c.m(e.parentNode,e)):c&&(U(),z(c,1,1,(()=>{c=null})),P()),t[5].isManual?i?(i.p(t,o),32&o[0]&&W(i,1)):(i=hn(t),i.c(),W(i,1),i.m(n.parentNode,n)):i&&(U(),z(i,1,1,(()=>{i=null})),P()),t[18]?a?(a.p(t,o),262144&o[0]&&W(a,1)):(a=$n(t),a.c(),W(a,1),a.m(r.parentNode,r)):a&&(U(),z(a,1,1,(()=>{a=null})),P())},i(t){o||(W(c),W(i),W(a),o=!0)},o(t){z(c),z(i),z(a),o=!1},d(t){c&&c.d(t),t&&m(e),i&&i.d(t),t&&m(n),a&&a.d(t),t&&m(r)}}}function gn(t){let e,n,o,c,i,a,s,l,u,p,v,k,y,w,C,x;function S(e){t[71](e)}let T={hideSignaling:t[22],rows:20};return void 0!==t[27]&&(T.value=t[27]),n=new He({props:T}),N.push((()=>X(n,"value",S))),{c(){e=g("div"),K(n.$$.fragment),c=$(),i=g("br"),a=$(),s=g("label"),l=h("3.\n                            "),u=g("button"),p=h("setRemoteDescription"),v=$(),k=g("button"),y=h("create answer"),u.disabled=t[25],k.disabled=t[25]},m(r,o){f(r,e,o),Q(n,e,null),d(e,c),d(e,i),d(e,a),d(e,s),d(s,l),d(s,u),d(u,p),d(s,v),d(s,k),d(k,y),w=!0,C||(x=[b(u,"click",t[72]),b(k,"click",t[38])],C=!0)},p(t,e){const r={};4194304&e[0]&&(r.hideSignaling=t[22]),!o&&134217728&e[0]&&(o=!0,r.value=t[27],_((()=>o=!1))),n.$set(r),(!w||33554432&e[0])&&(u.disabled=t[25]),(!w||33554432&e[0])&&(k.disabled=t[25])},i(t){w||(W(n.$$.fragment,t),w=!0)},o(t){z(n.$$.fragment,t),w=!1},d(t){t&&m(e),Y(n),C=!1,r(x)}}}function hn(t){let e,n,o,c,i,a,s,l,u,p,v,k,y,w,C,x,S,T;function E(e){t[73](e)}let R={hideSignaling:t[22],rows:20};return void 0!==t[19]&&(R.value=t[19]),c=new He({props:R}),N.push((()=>X(c,"value",E))),{c(){e=g("div"),n=g("strong"),n.textContent="MANUAL OFFER HERE",o=$(),K(c.$$.fragment),a=$(),s=g("br"),l=$(),u=g("label"),p=h("3.\n                            "),v=g("button"),k=h("setRemoteDescription"),y=$(),w=g("button"),C=h("create answer"),v.disabled=t[25],w.disabled=t[25]},m(r,i){f(r,e,i),d(e,n),d(e,o),Q(c,e,null),d(e,a),d(e,s),d(e,l),d(e,u),d(u,p),d(u,v),d(v,k),d(u,y),d(u,w),d(w,C),x=!0,S||(T=[b(v,"click",t[74]),b(w,"click",t[38])],S=!0)},p(t,e){const n={};4194304&e[0]&&(n.hideSignaling=t[22]),!i&&524288&e[0]&&(i=!0,n.value=t[19],_((()=>i=!1))),c.$set(n),(!x||33554432&e[0])&&(v.disabled=t[25]),(!x||33554432&e[0])&&(w.disabled=t[25])},i(t){x||(W(c.$$.fragment,t),x=!0)},o(t){z(c.$$.fragment,t),x=!1},d(t){t&&m(e),Y(c),S=!1,r(T)}}}function $n(t){let e,n,o,c,i,a,s,l,u,p,v,k,y,w,C,x;function S(e){t[75](e)}let T={hideSignaling:t[22],rows:20};return void 0!==t[18]&&(T.value=t[18]),n=new He({props:T}),N.push((()=>X(n,"value",S))),{c(){e=g("div"),K(n.$$.fragment),c=$(),i=g("br"),a=$(),s=g("label"),l=h("4.\n                            "),u=g("button"),p=h("setLocalDescription"),v=$(),k=g("button"),y=h("send answer"),u.disabled=t[25],k.disabled=t[25]},m(r,o){f(r,e,o),Q(n,e,null),d(e,c),d(e,i),d(e,a),d(e,s),d(s,l),d(s,u),d(u,p),d(s,v),d(s,k),d(k,y),w=!0,C||(x=[b(u,"click",t[76]),b(k,"click",t[40])],C=!0)},p(t,e){const r={};4194304&e[0]&&(r.hideSignaling=t[22]),!o&&262144&e[0]&&(o=!0,r.value=t[18],_((()=>o=!1))),n.$set(r),(!w||33554432&e[0])&&(u.disabled=t[25]),(!w||33554432&e[0])&&(k.disabled=t[25])},i(t){w||(W(n.$$.fragment,t),w=!0)},o(t){z(n.$$.fragment,t),w=!1},d(t){t&&m(e),Y(n),C=!1,r(x)}}}function vn(t){let e,n,r;return{c(){e=g("textarea"),k(e,"rows","10"),k(e,"class","svelte-5zgp1y"),C(e,"hideSignaling",t[22])},m(o,c){f(o,e,c),w(e,t[24]),n||(r=b(e,"input",t[77]),n=!0)},p(t,n){16777216&n[0]&&w(e,t[24]),4194304&n[0]&&C(e,"hideSignaling",t[22])},d(t){t&&m(e),n=!1,r()}}}function bn(t){let e,n,r,o,c,i,a,s,l=JSON.stringify(t[23],null,4)+"";return{c(){e=g("label"),e.textContent="injected Candidates",n=$(),r=g("textarea"),o=$(),c=g("pre"),i=h(l),k(e,"for","injectedCandidates"),k(r,"name","injectedCandidates"),k(r,"rows","20"),k(r,"class","svelte-5zgp1y")},m(l,u){f(l,e,u),f(l,n,u),f(l,r,u),w(r,t[4]),f(l,o,u),f(l,c,u),d(c,i),a||(s=b(r,"input",t[78]),a=!0)},p(t,e){16&e[0]&&w(r,t[4]),8388608&e[0]&&l!==(l=JSON.stringify(t[23],null,4)+"")&&y(i,l)},d(t){t&&m(e),t&&m(n),t&&m(r),t&&m(o),t&&m(c),a=!1,s()}}}function kn(t){let e,n,o,c,i,a,s,l,u,v,w,C,x,S,T,E,R,N,L,O,D,M,A,j,_,I,B,J,F,q,H,V,G,X,Z,tt,et,nt,rt,ot,ct,it,at,st,lt,ut,dt,ft,mt,pt,gt,ht,$t,vt,bt,kt,yt,wt,Ct,xt,St,Tt,Et,Rt,Nt,Lt,Ot,Dt,Mt,At,jt,_t,It,Bt,Jt,Ft,qt,Ht,Ut,Pt,Wt,zt,Vt,Gt,Xt,Kt,Qt,Yt,Zt,te,ee,ne,re,oe=t[5].isRemote&&tn(t),ce=t[5].hasUpstream&&en(t),ie=t[5].hasDownstream&&nn(t),ae=t[12]&&rn(t),se="plan-b"===t[31].sdpSemantics&&function(t){let e;return{c(){e=g("span"),e.textContent="plan-b",k(e,"class","warning svelte-5zgp1y")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}(),le=t[9],ue=[];for(let e=0;e<le.length;e+=1)ue[e]=on(Ze(t,le,e));const de=t=>z(ue[t],1,1,(()=>{ue[t]=null}));let fe=t[10],me=[];for(let e=0;e<fe.length;e+=1)me[e]=cn(Ye(t,fe,e));const pe=t=>z(me[t],1,1,(()=>{me[t]=null}));let ge=t[8]&&an(t),he="unified-plan"===t[30]&&function(t){let e,n;return e=new Be({props:{peerconnection:t[7],streamSource:t[60]}}),e.$on("track",t[61]),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};128&n[0]&&(r.peerconnection=t[7]),4096&n[0]&&(r.streamSource=t[60]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}(t),$e=!t[21]&&sn(t),ve=t[0]&&ln(t),be=t[1]&&pn(t),ke=(t[24].length||t[5].isManual)&&vn(t),ye=t[5].isManual&&bn(t);return{c(){e=g("section"),n=g("h3"),o=h(t[2]),c=$(),i=g("small"),a=h("talking to "),s=h(t[3]),l=$(),oe&&oe.c(),u=$(),ce&&ce.c(),v=$(),ie&&ie.c(),w=$(),C=g("article"),x=g("small"),S=g("strong"),S.textContent="selected upstream",T=$(),ae&&ae.c(),E=$(),R=g("hr"),N=$(),L=g("details"),O=g("summary"),D=g("h4"),M=g("abbr"),A=h("peerconnection"),_=$(),se&&se.c(),I=$();for(let t=0;t<ue.length;t+=1)ue[t].c();B=$();for(let t=0;t<me.length;t+=1)me[t].c();F=$(),q=g("button"),H=h("addTrack"),G=$(),ge&&ge.c(),X=$(),Z=g("button"),Z.textContent="close",tt=$(),he&&he.c(),et=$(),nt=g("article"),rt=g("details"),ot=g("summary"),ot.innerHTML="<h4>signaling</h4>",ct=$(),it=g("div"),at=g("table"),st=g("tr"),lt=g("th"),lt.textContent="signaling:",ut=$(),dt=g("td"),ft=g("code"),mt=h(t[13]),pt=$(),gt=g("tr"),ht=g("th"),ht.textContent="connection:",$t=$(),vt=g("td"),bt=g("code"),kt=h(t[14]),yt=$(),wt=g("tr"),Ct=g("th"),Ct.textContent="iceGathering:",xt=$(),St=g("td"),Tt=g("code"),Et=h(t[16]),Rt=$(),Nt=g("tr"),Lt=g("th"),Lt.textContent="iceConnection:",Ot=$(),Dt=g("td"),Mt=g("code"),At=h(t[15]),jt=$(),$e&&$e.c(),_t=$(),It=g("div"),Bt=g("span"),Jt=g("label"),Ft=g("input"),qt=h("\n                        caller"),Ht=$(),Ut=g("label"),Pt=g("input"),Wt=h("\n                        receiver"),zt=$(),Vt=g("label"),Gt=g("input"),Xt=h("\n                        auto"),Kt=$(),ve&&ve.c(),Qt=$(),be&&be.c(),Yt=$(),ke&&ke.c(),Zt=$(),ye&&ye.c(),k(M,"title",j=JSON.stringify(t[11],null,4)),L.open=J="plan-b"==t[30],q.disabled=V=!Boolean(t[12]),k(Z,"class","btn-small"),k(C,"class","box"),k(at,"class","vertical"),k(it,"class","box"),k(Ft,"type","checkbox"),k(Pt,"type","checkbox"),k(Gt,"type","checkbox"),k(It,"class","box"),rt.open=te=!0,k(nt,"class","box")},m(r,m){f(r,e,m),d(e,n),d(n,o),d(n,c),d(n,i),d(i,a),d(i,s),d(e,l),oe&&oe.m(e,null),d(e,u),ce&&ce.m(e,null),d(e,v),ie&&ie.m(e,null),d(e,w),d(e,C),d(C,x),d(x,S),d(x,T),ae&&ae.m(x,null),d(C,E),d(C,R),d(C,N),d(C,L),d(L,O),d(O,D),d(D,M),d(M,A),d(O,_),se&&se.m(O,null),d(L,I);for(let t=0;t<ue.length;t+=1)ue[t].m(L,null);d(L,B);for(let t=0;t<me.length;t+=1)me[t].m(L,null);d(C,F),d(C,q),d(q,H),d(C,G),ge&&ge.m(C,null),d(C,X),d(C,Z),d(C,tt),he&&he.m(C,null),d(e,et),d(e,nt),d(nt,rt),d(rt,ot),d(rt,ct),d(rt,it),d(it,at),d(at,st),d(st,lt),d(st,ut),d(st,dt),d(dt,ft),d(ft,mt),d(at,pt),d(at,gt),d(gt,ht),d(gt,$t),d(gt,vt),d(vt,bt),d(bt,kt),d(at,yt),d(at,wt),d(wt,Ct),d(wt,xt),d(wt,St),d(St,Tt),d(Tt,Et),d(at,Rt),d(at,Nt),d(Nt,Lt),d(Nt,Ot),d(Nt,Dt),d(Dt,Mt),d(Mt,At),d(at,jt),$e&&$e.m(at,null),d(rt,_t),d(rt,It),d(It,Bt),d(Bt,Jt),d(Jt,Ft),Ft.checked=t[0],d(Jt,qt),d(Bt,Ht),d(Bt,Ut),d(Ut,Pt),Pt.checked=t[1],d(Ut,Wt),d(Bt,zt),d(Bt,Vt),d(Vt,Gt),Gt.checked=t[25],d(Vt,Xt),d(rt,Kt),ve&&ve.m(rt,null),d(rt,Qt),be&&be.m(rt,null),d(rt,Yt),ke&&ke.m(rt,null),d(rt,Zt),ye&&ye.m(rt,null),ee=!0,ne||(re=[b(q,"click",t[55]),b(Z,"click",t[59]),b(Ft,"change",t[62]),b(Pt,"change",t[63]),b(Gt,"change",t[64])],ne=!0)},p(t,n){if((!ee||4&n[0])&&y(o,t[2]),(!ee||8&n[0])&&y(s,t[3]),t[5].isRemote?oe?(oe.p(t,n),32&n[0]&&W(oe,1)):(oe=tn(t),oe.c(),W(oe,1),oe.m(e,u)):oe&&(U(),z(oe,1,1,(()=>{oe=null})),P()),t[5].hasUpstream?ce?(ce.p(t,n),32&n[0]&&W(ce,1)):(ce=en(t),ce.c(),W(ce,1),ce.m(e,v)):ce&&(U(),z(ce,1,1,(()=>{ce=null})),P()),t[5].hasDownstream?ie?(ie.p(t,n),32&n[0]&&W(ie,1)):(ie=nn(t),ie.c(),W(ie,1),ie.m(e,w)):ie&&(U(),z(ie,1,1,(()=>{ie=null})),P()),t[12]?ae?(ae.p(t,n),4096&n[0]&&W(ae,1)):(ae=rn(t),ae.c(),W(ae,1),ae.m(x,null)):ae&&(U(),z(ae,1,1,(()=>{ae=null})),P()),(!ee||2048&n[0]&&j!==(j=JSON.stringify(t[11],null,4)))&&k(M,"title",j),4736&n[0]){let e;for(le=t[9],e=0;e<le.length;e+=1){const r=Ze(t,le,e);ue[e]?(ue[e].p(r,n),W(ue[e],1)):(ue[e]=on(r),ue[e].c(),W(ue[e],1),ue[e].m(L,B))}for(U(),e=le.length;e<ue.length;e+=1)de(e);P()}if(1024&n[0]){let e;for(fe=t[10],e=0;e<fe.length;e+=1){const r=Ye(t,fe,e);me[e]?(me[e].p(r,n),W(me[e],1)):(me[e]=cn(r),me[e].c(),W(me[e],1),me[e].m(L,null))}for(U(),e=fe.length;e<me.length;e+=1)pe(e);P()}(!ee||4096&n[0]&&V!==(V=!Boolean(t[12])))&&(q.disabled=V),t[8]?ge?ge.p(t,n):(ge=an(t),ge.c(),ge.m(C,X)):ge&&(ge.d(1),ge=null),"unified-plan"===t[30]&&he.p(t,n),(!ee||8192&n[0])&&y(mt,t[13]),(!ee||16384&n[0])&&y(kt,t[14]),(!ee||65536&n[0])&&y(Et,t[16]),(!ee||32768&n[0])&&y(At,t[15]),t[21]?$e&&($e.d(1),$e=null):$e?$e.p(t,n):($e=sn(t),$e.c(),$e.m(at,null)),1&n[0]&&(Ft.checked=t[0]),2&n[0]&&(Pt.checked=t[1]),33554432&n[0]&&(Gt.checked=t[25]),t[0]?ve?(ve.p(t,n),1&n[0]&&W(ve,1)):(ve=ln(t),ve.c(),W(ve,1),ve.m(rt,Qt)):ve&&(U(),z(ve,1,1,(()=>{ve=null})),P()),t[1]?be?(be.p(t,n),2&n[0]&&W(be,1)):(be=pn(t),be.c(),W(be,1),be.m(rt,Yt)):be&&(U(),z(be,1,1,(()=>{be=null})),P()),t[24].length||t[5].isManual?ke?ke.p(t,n):(ke=vn(t),ke.c(),ke.m(rt,Zt)):ke&&(ke.d(1),ke=null),t[5].isManual?ye?ye.p(t,n):(ye=bn(t),ye.c(),ye.m(rt,null)):ye&&(ye.d(1),ye=null)},i(t){if(!ee){W(oe),W(ce),W(ie),W(ae);for(let t=0;t<le.length;t+=1)W(ue[t]);for(let t=0;t<fe.length;t+=1)W(me[t]);W(he),W(ve),W(be),ee=!0}},o(t){z(oe),z(ce),z(ie),z(ae),ue=ue.filter(Qe);for(let t=0;t<ue.length;t+=1)z(ue[t]);me=me.filter(Qe);for(let t=0;t<me.length;t+=1)z(me[t]);z(he),z(ve),z(be),ee=!1},d(t){t&&m(e),oe&&oe.d(),ce&&ce.d(),ie&&ie.d(),ae&&ae.d(),se&&se.d(),p(ue,t),p(me,t),ge&&ge.d(),he&&he.d(),$e&&$e.d(),ve&&ve.d(),be&&be.d(),ke&&ke.d(),ye&&ye.d(),ne=!1,r(re)}}}function yn(t,e,n){let r,o,c,i,a,l,u,d,f,m,p,g,h;s(t,st,(t=>n(5,f=t))),s(t,yt,(t=>n(79,m=t))),s(t,kt,(t=>n(46,p=t))),s(t,bt,(t=>n(47,g=t))),s(t,lt,(t=>n(48,h=t)));let{isCaller:$=!1}=e,{isReceiver:v=!1}=e,{name:b="unnamed participant"}=e,{recipient:k=null}=e;const y=new Et({from:b,to:k}),w=dt(b);let C,x,S,E,R,L=[],O=[],D="",M="",A="",j="",_="";Tt.addEventListener(`OfferTo:${b}`,(async({detail:t})=>{r&&(Z(Rt(t)),await X(),Y(Lt(I)),Q())})),Tt.addEventListener(`AnswerTo:${b}`,(async({detail:t})=>{r&&et(Rt(t))})),Tt.addEventListener(`CandidateTo:${b}`,(async({detail:t})=>{r&&await async function(t){f.showCandidateEvents&&w("ac","addIceCandidate"),await x.addIceCandidate(t)}(t)}));let I="",B="",J="",F=[],q="";const H=new URL(document.location.toString()).searchParams.get("sdpSemantics")??"unified-plan",U={sdpSemantics:H};function P(t){w("at","add track"),console.info("add track"),n(8,S=x.addTrack(t.getTracks()[0],t))}function W(t,e){w("rt","replace track"),console.info("replace track",{sender:e}),e.replaceTrack(t.getTracks()[0])}function z(){x.removeStream(R),n(8,S=void 0)}function V(){x.removeTrack(S),n(8,S=void 0)}async function G(){w("o","create offer");const t=await x.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!1});n(17,_=t.sdp)}async function X(){w("a","create answer");const t=await x.createAnswer();n(18,I=t.sdp)}function K(){const t=Nt(_);wt({from:b,offer:t}),f.isRemote&&y.sendOffer(t),Tt.dispatchEvent(new CustomEvent(`OfferTo:${k}`,{detail:t}))}function Q(){const t=Nt(I);Ct({from:b,answer:t}),f.isRemote&&y.sendAnswer(t),Tt.dispatchEvent(new CustomEvent(`AnswerTo:${k}`,{detail:t}))}async function Y(t){w("l","setLocalDescription"),console.debug("localDescription ->",t);const e=t;St({from:b}),x.setLocalDescription(e),tt(),St({from:k})}function Z(t){w("r","setRemoteDescription");const e=Nt(t);x.setRemoteDescription(e),tt(),St({from:k})}function tt(){f.isManual?(l||[]).forEach((t=>{t&&f.showCandidateEvents&&(w("ac","addIceCandidate"),x.addIceCandidate(t))})):(console.debug(m[k]),(m[k]||[]).forEach((t=>{t&&f.showCandidateEvents&&(w("ac","addIceCandidate"),x.addIceCandidate(t))})))}function et(t){w("r","setRemoteDescription");const e=Lt(t);x.setRemoteDescription(e),St({from:b})}function nt(t){if(t.stream)C.$set({stream:t.stream});else if(t.track){const e=new MediaStream([t.track]);C.$set({stream:e})}else console.error("can't use stream or track, nothing there",t)}return T((()=>{n(7,x=function(){const t=new RTCPeerConnection(U);return t.addEventListener("track",(t=>{w("pct","pc ontrack");const{track:e,streams:n,transceiver:r}=t,o=n[0]||new MediaStream([e]);console.info(`${b}.ontrack`,{track:e,streams:n,kind:e.kind,transceiver:r}),nt({stream:o,track:e}),e.addEventListener("ended",(()=>{w("te","track ended"),console.info(`${b} track ended`,{event:t})})),e.addEventListener("mute",(()=>{w("🔇","track muted"),console.info(`${b} track muted`,{event:t})})),e.addEventListener("unmute",(()=>{w("🔈","track unmuted"),console.info(`${b} track unmuted`,{event:t})})),o.addEventListener("addtrack",(()=>{w("add","stream track added")})),o.addEventListener("removetrack",(()=>{w("rem","stream track removed")}))})),t.addEventListener("icecandidate",(({candidate:t})=>{f.showCandidateEvents&&w("lc","create candidate"),n(45,F=[...F,t]),function(t){b&&t&&(xt({from:b,candidate:t}),f.isRemote&&y.sendCandidate(t),Tt.dispatchEvent(new CustomEvent(`CandidateTo:${k}`,{detail:t})))}(t)})),t.addEventListener("signalingstatechange",(()=>n(13,D=t.signalingState))),t.addEventListener("connectionstatechange",(()=>n(14,M=t.connectionState))),t.addEventListener("iceconnectionstatechange",(()=>n(15,A=t.iceConnectionState))),t.addEventListener("icegatheringstatechange",(({target:{iceGatheringState:t}})=>n(16,j=t))),t.addEventListener("negotiationneeded",(()=>w("nn","negotiation needed"))),t.addEventListener("addstream",(t=>{w("as","addstream"),console.warn("addstream",t)})),t.addEventListener("removestream",(t=>{w("rs","removestream"),console.warn("removestream",t)})),console.info(`setup RTCPeerConnection for ${b}`,U,t),t}()),yt.subscribe((({[k]:t})=>{t&&f.showCandidateEvents&&w("rc")})),f.hasCaller&&G();const t=()=>{n(9,L=x.getSenders()),n(10,O=x.getReceivers()),n(11,E=x.getConfiguration())};t();const e=setInterval((()=>{t()}),500);return()=>clearInterval(e)})),t.$$set=t=>{"isCaller"in t&&n(0,$=t.isCaller),"isReceiver"in t&&n(1,v=t.isReceiver),"name"in t&&n(2,b=t.name),"recipient"in t&&n(3,k=t.recipient)},t.$$.update=()=>{32&t.$$.dirty[0]&&n(25,r=f.autoSignal),4&t.$$.dirty[0]|131072&t.$$.dirty[1]&&n(28,o=h[b]||[]),8&t.$$.dirty[0]|65536&t.$$.dirty[1]&&n(27,c=Rt(g[k])),8&t.$$.dirty[0]|32768&t.$$.dirty[1]&&n(26,i=Rt(p[k])),16384&t.$$.dirty[1]&&n(24,a=JSON.stringify(F)),16&t.$$.dirty[0]&&n(23,l=((t,e)=>{try{return JSON.parse(t)}catch(e){return""!==t&&console.warn({parseError:e}),[]}})(q)),32&t.$$.dirty[0]&&n(22,u=f.hideSignaling),32&t.$$.dirty[0]&&n(21,d=f.hideEvents)},[$,v,b,k,q,f,C,x,S,L,O,E,R,D,M,A,j,_,I,B,J,d,u,l,a,r,i,c,o,y,H,U,P,W,z,V,async function(){await G(),Y(Nt(_)),K()},G,X,K,Q,Y,Z,et,nt,F,p,g,h,({detail:t})=>n(12,R=t),()=>n(12,R=void 0),({detail:t})=>n(12,R=t),()=>n(12,R=void 0),function(t){N[t?"unshift":"push"]((()=>{C=t,n(6,C)}))},t=>x.removeTrack(t),()=>P(R),()=>W(R,S),()=>z(),()=>V(),()=>x.close(),()=>R,({detail:t})=>nt({track:t}),function(){$=this.checked,n(0,$)},function(){v=this.checked,n(1,v)},function(){r=this.checked,n(25,r),n(5,f)},function(t){_=t,n(17,_)},()=>Y(Nt(_)),function(t){i=t,n(26,i),n(46,p),n(3,k)},()=>et(i),function(t){J=t,n(20,J)},()=>et(J),function(t){c=t,n(27,c),n(47,g),n(3,k)},()=>Z(c),function(t){B=t,n(19,B)},()=>Z(B),function(t){I=t,n(18,I)},()=>Y(Lt(I)),function(){a=this.value,n(24,a),n(45,F)},function(){q=this.value,n(4,q)}]}const wn=class extends tt{constructor(t){super(),Z(this,t,yn,kn,c,{isCaller:0,isReceiver:1,name:2,recipient:3},null,[-1,-1,-1])}};function Cn(t,e,n){const r=t.slice();return r[6]=e[n].name,r[7]=e[n].event,r[8]=e[n].timestamp,r}function xn(t){let e,n,r,o,c,i,a,s,l,u,p,v,b,w=t[8]+"",C=t[6]+"",x=t[7]+"";return{c(){e=g("tr"),n=g("td"),r=g("code"),o=h(w),c=$(),i=g("th"),a=h(C),s=h(":"),l=$(),u=g("td"),p=g("code"),v=h(x),b=$(),k(r,"class","timestamp svelte-m6pkof")},m(t,m){f(t,e,m),d(e,n),d(n,r),d(r,o),d(e,c),d(e,i),d(i,a),d(i,s),d(e,l),d(e,u),d(u,p),d(p,v),d(e,b)},p(t,e){4&e&&w!==(w=t[8]+"")&&y(o,w),4&e&&C!==(C=t[6]+"")&&y(a,C),4&e&&x!==(x=t[7]+"")&&y(v,x)},d(t){t&&m(e)}}}function Sn(e){let n,r,o,c,i,a,s,l,u,h,v=e[2],y=[];for(let t=0;t<v.length;t+=1)y[t]=xn(Cn(e,v,t));return{c(){n=g("section"),r=g("h3"),r.innerHTML="Event Log <small>please open\n            <code>about://webrtc-internals</code></small>",o=$(),c=g("div"),i=g("table");for(let t=0;t<y.length;t+=1)y[t].c();a=$(),s=g("label"),l=g("input"),k(i,"class","vertical svelte-m6pkof"),k(c,"class","box svelte-m6pkof"),k(l,"type","text"),k(l,"name","filterTerm"),k(l,"id","filterTerm"),k(l,"placeholder","filter"),k(l,"class","svelte-m6pkof"),k(s,"for","filterTerm"),k(n,"id","EventLog")},m(t,m){f(t,n,m),d(n,r),d(n,o),d(n,c),d(c,i);for(let t=0;t<y.length;t+=1)y[t].m(i,null);e[4](c),d(n,a),d(n,s),d(s,l),w(l,e[0]),u||(h=b(l,"input",e[5]),u=!0)},p(t,[e]){if(4&e){let n;for(v=t[2],n=0;n<v.length;n+=1){const r=Cn(t,v,n);y[n]?y[n].p(r,e):(y[n]=xn(r),y[n].c(),y[n].m(i,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=v.length}1&e&&l.value!==t[0]&&w(l,t[0])},i:t,o:t,d(t){t&&m(n),p(y,t),e[4](null),u=!1,h()}}}function Tn(t,e,n){let r,o,c;s(t,ot,(t=>n(3,o=t)));let i="";return T((()=>{ot.subscribe((()=>{n(1,c.scrollTop=c.scrollHeight,c)}))})),t.$$.update=()=>{9&t.$$.dirty&&n(2,r=i&&i.length?o.filter((({event:t,short:e,name:n})=>t?.match(i)||n?.match(i)||e?.includes(i))):o)},[i,c,r,o,function(t){N[t?"unshift":"push"]((()=>{c=t,n(1,c)}))},function(){i=this.value,n(0,i)}]}const En=class extends tt{constructor(t){super(),Z(this,t,Tn,Sn,c,{})}};function Rn(t){let e,n;return e=new wn({props:{name:"alice",isCaller:"true",recipient:"bob"}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Nn(t){let e,n;return e=new wn({props:{name:"bob",isReceiver:"true",recipient:"alice"}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ln(t){let e,n;return e=new En({}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function On(t){let e,n,r,o,c,i,a,s,l,u;c=new vt({});let p=t[0].hasCaller&&Rn(),h=t[0].hasReceiver&&Nn(),v=!t[0].hideEvents&&Ln();return{c(){e=g("div"),n=g("h1"),n.textContent="WebRTC Demo",r=$(),o=g("aside"),K(c.$$.fragment),i=$(),a=g("main"),p&&p.c(),s=$(),h&&h.c(),l=$(),v&&v.c(),k(o,"class","svelte-if8jgd"),k(a,"class","svelte-if8jgd"),k(e,"class","svelte-if8jgd")},m(t,m){f(t,e,m),d(e,n),d(e,r),d(e,o),Q(c,o,null),d(e,i),d(e,a),p&&p.m(a,null),d(a,s),h&&h.m(a,null),d(a,l),v&&v.m(a,null),u=!0},p(t,[e]){t[0].hasCaller?p?1&e&&W(p,1):(p=Rn(),p.c(),W(p,1),p.m(a,s)):p&&(U(),z(p,1,1,(()=>{p=null})),P()),t[0].hasReceiver?h?1&e&&W(h,1):(h=Nn(),h.c(),W(h,1),h.m(a,l)):h&&(U(),z(h,1,1,(()=>{h=null})),P()),t[0].hideEvents?v&&(U(),z(v,1,1,(()=>{v=null})),P()):v?1&e&&W(v,1):(v=Ln(),v.c(),W(v,1),v.m(a,null))},i(t){u||(W(c.$$.fragment,t),W(p),W(h),W(v),u=!0)},o(t){z(c.$$.fragment,t),z(p),z(h),z(v),u=!1},d(t){t&&m(e),Y(c),p&&p.d(),h&&h.d(),v&&v.d()}}}function Dn(t,e,n){let r;return s(t,st,(t=>n(0,r=t))),[r]}const Mn=class extends tt{constructor(t){super(),Z(this,t,Dn,On,c,{})}};function An(t){let e,n;return e=new Mn({}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function jn(t){let e,n,r,o,c,i,a;return r=new Ke({}),i=new re({}),{c(){e=g("section"),n=g("article"),K(r.$$.fragment),o=$(),c=g("article"),K(i.$$.fragment),k(n,"class","box"),k(c,"class","box")},m(t,s){f(t,e,s),d(e,n),Q(r,n,null),d(e,o),d(e,c),Q(i,c,null),a=!0},i(t){a||(W(r.$$.fragment,t),W(i.$$.fragment,t),a=!0)},o(t){z(r.$$.fragment,t),z(i.$$.fragment,t),a=!1},d(t){t&&m(e),Y(r),Y(i)}}}function _n(t){let e,n,r,o;const c=[jn,An],i=[];function a(t,e){return t[0].audioVisOnly?0:1}return e=a(t),n=i[e]=c[e](t),{c(){n.c(),r=v()},m(t,n){i[e].m(t,n),f(t,r,n),o=!0},p(t,[o]){let s=e;e=a(t),e!==s&&(U(),z(i[s],1,1,(()=>{i[s]=null})),P(),n=i[e],n||(n=i[e]=c[e](t),n.c()),W(n,1),n.m(r.parentNode,r))},i(t){o||(W(n),o=!0)},o(t){z(n),o=!1},d(t){i[e].d(t),t&&m(r)}}}function In(t,e,n){let r;return s(t,st,(t=>n(0,r=t))),[r]}const Bn=new class extends tt{constructor(t){super(),Z(this,t,In,_n,c,{})}}({target:document.body,props:{}});window.app=Bn})();