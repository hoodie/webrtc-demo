(()=>{"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t){return 0===Object.keys(t).length}function a(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function l(t,e,n){t.$$.on_destroy.push(a(e,n))}new Set;let s,u=!1;function d(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function v(){return h(" ")}function $(){return h("")}function b(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function k(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function x(t,e,n){t.classList[n?"add":"remove"](e)}function C(t){s=t}function S(){if(!s)throw new Error("Function called outside component initialization");return s}function T(t){S().$$.on_mount.push(t)}function E(){const t=S();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}new Set;const R=[],N=[],O=[],L=[],D=Promise.resolve();let _=!1;function M(){_||(_=!0,D.then(J))}function A(t){O.push(t)}function j(t){L.push(t)}let I=!1;const B=new Set;function J(){if(!I){I=!0;do{for(let t=0;t<R.length;t+=1){const e=R[t];C(e),F(e.$$)}for(C(null),R.length=0;N.length;)N.pop()();for(let t=0;t<O.length;t+=1){const e=O[t];B.has(e)||(B.add(e),e())}O.length=0}while(R.length);for(;L.length;)L.pop()();_=!1,I=!1,B.clear()}}function F(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const P=new Set;let q;function U(){q={r:0,c:[],p:q}}function H(){q.r||r(q.c),q=q.p}function W(t,e){t&&t.i&&(P.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(P.has(t))return;P.add(t),q.c.push((()=>{P.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const V="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;let G;function X(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function K(t){t&&t.c()}function Q(t,n,i,c){const{fragment:a,on_mount:l,on_destroy:s,after_update:u}=t.$$;a&&a.m(n,i),c||A((()=>{const n=l.map(e).filter(o);s?s.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(A)}function Y(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,o,i,c,a,l,d,f=[-1]){const p=s;C(e);const g=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:o.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:o.target||p.$$.root};d&&d(g.root);let h=!1;if(g.ctx=i?i(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return g.ctx&&a(g.ctx[t],g.ctx[t]=o)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](o),h&&function(t,e){-1===t.$$.dirty[0]&&(R.push(t),M(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],g.update(),h=!0,r(g.before_update),g.fragment=!!c&&c(g.ctx),o.target){if(o.hydrate){u=!0;const t=(v=o.target,Array.from(v.childNodes));g.fragment&&g.fragment.l(t),t.forEach(m)}else g.fragment&&g.fragment.c();o.intro&&W(e.$$.fragment),Q(e,o.target,o.anchor,o.customElement),u=!1,J()}var v;C(p)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(G=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(o);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){r(this.$$.on_disconnect)}$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class tt{$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function nt(e,n=t){let r;const o=new Set;function c(t){if(i(e,t)&&(e=t,r)){const t=!et.length;for(const t of o)t[1](),et.push(t,e);if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(i,a=t){const l=[i,a];return o.add(l),1===o.size&&(r=n(c)||t),i(e),()=>{o.delete(l),0===o.size&&(r(),r=null)}}}}function rt(e,n,i){const c=!Array.isArray(e),l=c?[e]:e,s=n.length<2;return{subscribe:nt(i,(e=>{let i=!1;const u=[];let d=0,f=t;const m=()=>{if(d)return;f();const r=n(c?u[0]:u,e);s?e(r):f=o(r)?r:t},p=l.map(((t,e)=>a(t,(t=>{u[e]=t,d&=~(1<<e),i&&m()}),(()=>{d|=1<<e}))));return i=!0,m(),function(){r(p),f()}})).subscribe}}const ot=nt([]),it=t=>{try{return!0===JSON.parse(t)}catch{return!1}},ct=nt((()=>{const t=Object.fromEntries(new URLSearchParams(location.search).entries()),e={role:t.role||"both",stream:t.stream||"both",autoSignal:it(t.autoSignal),audioVisOnly:it(t.audioVisOnly),manual:it(t.manual),remote:it(t.remote),hideSignaling:it(t.hideSignaling),hideEvents:it(t.hideEvents),showCandidateEvents:it(t.showCandidateEvents),showTransceivers:it(t.showTransceivers??!0)};return Object.entries(e).map((([t,e])=>({key:t,value:e})))})()),at=rt(ct,(t=>`${window.origin}${window.location.pathname}?${(t=>{const e=new URLSearchParams;for(let[n,r]of t)e.set(n,r);return e.toString()})(t.map((({key:t,value:e})=>[t,e])))}`)),lt=rt(ct,(t=>{const e=Object.fromEntries(t.map((({key:t,value:e})=>[t,e])));let{role:n,stream:r,manual:o,remote:i,hideSignaling:c,hideEvents:a,showTransceivers:l,autoSignal:s,showCandidateEvents:u}=e;const d="recv"!==n,f="call"!==n&&"send"!==n||!1,m="down"!==r||!1,p="up"!==r||!1,g=o&&"no"!==o||!1,h=i&&"no"!==i||!1,v=d?"bob":"alice",$=f?"bob":"alice";return{...e,role:n,stream:r,manual:o,remote:i,hasCaller:d,hasReceiver:f,hasUpstream:m,hasDownstream:p,autoSignal:s,isManual:g,isRemote:h,hideSignaling:c,hideEvents:a,showTransceivers:l,showCandidateEvents:u,to:v,from:$}})),st=nt({});function ut(t,e,n){const r={name:t,short:e,event:n,timestamp:(new Date).toISOString().split("T")[1]};ot.update((t=>[...t,r])),st.update((n=>({...n,[t]:[...n[t]||[],e]})))}const dt=t=>(e,n)=>ut(t,e,n);function ft(t,e,n){const r=t.slice();return r[4]=e[n].key,r[5]=e[n].value,r[6]=e,r[7]=n,r}function mt(t){let e,n,r,o,i,c,a,l=t[4]+"";function s(){t[3].call(i,t[6],t[7])}return{c(){e=g("td"),n=h(l),r=v(),o=g("td"),i=g("input"),y(i,"type","text")},m(l,u){f(l,e,u),d(e,n),f(l,r,u),f(l,o,u),d(o,i),w(i,t[5]),c||(a=b(i,"input",s),c=!0)},p(e,r){t=e,1&r&&l!==(l=t[4]+"")&&k(n,l),1&r&&i.value!==t[5]&&w(i,t[5])},d(t){t&&m(e),t&&m(r),t&&m(o),c=!1,a()}}}function pt(t){let e,n,r,o,i,c,a,l,s,u=t[4]+"";function p(){t[2].call(r,t[6],t[7])}return{c(){e=g("td"),n=g("label"),r=g("input"),i=v(),c=h(u),y(r,"type","checkbox"),y(r,"id",o=t[4]),y(n,"for",a=t[4]),y(e,"colspan","2")},m(o,a){f(o,e,a),d(e,n),d(n,r),r.checked=t[5],d(n,i),d(n,c),l||(s=b(r,"change",p),l=!0)},p(e,i){t=e,1&i&&o!==(o=t[4])&&y(r,"id",o),1&i&&(r.checked=t[5]),1&i&&u!==(u=t[4]+"")&&k(c,u),1&i&&a!==(a=t[4])&&y(n,"for",a)},d(t){t&&m(e),l=!1,s()}}}function gt(t){let e,n;function r(t,e){return"boolean"==typeof t[5]?pt:mt}let o=r(t),i=o(t);return{c(){e=g("tr"),i.c(),n=v()},m(t,r){f(t,e,r),i.m(e,null),d(e,n)},p(t,c){o===(o=r(t))&&i?i.p(t,c):(i.d(1),i=o(t),i&&(i.c(),i.m(e,n)))},d(t){t&&m(e),i.d()}}}function ht(e){let n,r,o,i,c,a,l,s,u,$,b=e[0],w=[];for(let t=0;t<b.length;t+=1)w[t]=gt(ft(e,b,t));return{c(){n=g("details"),r=g("summary"),r.textContent="Config",o=v(),i=g("div"),c=g("table");for(let t=0;t<w.length;t+=1)w[t].c();a=v(),l=g("code"),s=g("pre"),u=g("a"),$=h(e[1]),y(r,"class","svelte-rc03x9"),y(u,"href",e[1]),y(n,"class","svelte-rc03x9")},m(t,e){f(t,n,e),d(n,r),d(n,o),d(n,i),d(i,c);for(let t=0;t<w.length;t+=1)w[t].m(c,null);d(i,a),d(i,l),d(l,s),d(s,u),d(u,$)},p(t,[e]){if(1&e){let n;for(b=t[0],n=0;n<b.length;n+=1){const r=ft(t,b,n);w[n]?w[n].p(r,e):(w[n]=gt(r),w[n].c(),w[n].m(c,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=b.length}2&e&&k($,t[1]),2&e&&y(u,"href",t[1])},i:t,o:t,d(t){t&&m(n),p(w,t)}}}function vt(t,e,n){let r,o;return l(t,ct,(t=>n(0,r=t))),l(t,at,(t=>n(1,o=t))),[r,o,function(t,e){t[e].value=this.checked,ct.set(r)},function(t,e){t[e].value=this.value,ct.set(r)}]}const $t=class extends tt{constructor(t){super(),Z(this,t,vt,ht,i,{})}},bt=nt({}),yt=nt({}),kt=nt({});function wt({from:t,offer:e}){bt.update((n=>({...n,[t]:e})))}function xt({from:t,answer:e}){yt.update((n=>({...n,[t]:e})))}function Ct({from:t,candidate:e}){kt.update((n=>{const r=n[t]||[];return{...n,[t]:[...r,e]}}))}function St({from:t}){kt.update((e=>({...e,[t]:[]})))}const Tt=new EventTarget;class Et{to;from;socket;constructor({to:t,from:e}){this.to=t,this.from=e}connect({url:t}){const e=new WebSocket(t);e.onopen=()=>{this.socket=e,this.socket.onmessage=this.received.bind(this)}}received({data:t}){const e=JSON.parse(t),{[this.to]:n,type:r}=e;console.debug("its for me!",n);const o=this.to;switch(r){case"offer":wt({from:o,offer:n});break;case"answer":xt({from:o,answer:n});break;case"candidate":Ct({from:o,candidate:new RTCIceCandidate(n)})}}sendOffer(t){if(t){const e={[this.from]:t,type:"offer"};this.send(e)}}sendAnswer(t){if(t){const e={[this.from]:t,type:"answer"};this.send(e)}}sendCandidate(t){if(t){const e={[this.from]:t,type:"candidate"};this.send(e)}}send(t){if(this.socket){const e=JSON.stringify(t);this.socket.send(e)}}toString(){return`[Signaling Server calling ${this.from} → ${this.to}]`}}const Rt=t=>"string"==typeof t?JSON.parse(t).sdp:"object"==typeof t?t.sdp:void 0,Nt=t=>({type:"offer",sdp:t}),Ot=t=>({type:"answer",sdp:t});function Lt(t){let e,n,r=JSON.stringify(t[2],null,4)+"";return{c(){e=g("code"),n=h(r)},m(t,r){f(t,e,r),d(e,n)},p(t,e){4&e&&r!==(r=JSON.stringify(t[2],null,4)+"")&&k(n,r)},d(t){t&&m(e)}}}function Dt(t){let e,n=t[0]&&_t(t);return{c(){e=g("strong"),n&&n.c()},m(t,r){f(t,e,r),n&&n.m(e,null)},p(t,r){t[0]?n?n.p(t,r):(n=_t(t),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(t){t&&m(e),n&&n.d()}}}function _t(t){let e,n=JSON.stringify(t[2]())+"";return{c(){e=h(n)},m(t,n){f(t,e,n)},p(t,r){4&r&&n!==(n=JSON.stringify(t[2]())+"")&&k(e,n)},d(t){t&&m(e)}}}function Mt(e){let n,r,o,i,c,a,l;function s(t,e){return"function"==typeof t[2]?Dt:Lt}let u=s(e),p=u(e);return{c(){n=g("details"),r=g("summary"),o=h(e[1]),i=v(),c=g("pre"),p.c()},m(t,s){f(t,n,s),d(n,r),d(r,o),d(n,i),d(n,c),p.m(c,null),n.open=e[3],a||(l=b(n,"toggle",e[4]),a=!0)},p(t,[e]){2&e&&k(o,t[1]),u===(u=s(t))&&p?p.p(t,e):(p.d(1),p=u(t),p&&(p.c(),p.m(c,null))),8&e&&(n.open=t[3])},i:t,o:t,d(t){t&&m(n),p.d(),a=!1,l()}}}function At(t,e,n){let{open:r}=e,{summary:o="???"}=e,{data:i}=e,c=Boolean(i)&&r;return t.$$set=t=>{"open"in t&&n(0,r=t.open),"summary"in t&&n(1,o=t.summary),"data"in t&&n(2,i=t.data)},[r,o,i,c,function(){c=this.open,n(3,c)}]}const jt=class extends tt{constructor(t){super(),Z(this,t,At,Mt,i,{open:0,summary:1,data:2})}};function It(t){let e,n,r,o,i,c,a,l,s,u,p,$=t[0].constructor.name+"",b=t[0].readyState+"",y=t[0].muted?"muted":"unmuted",w=JSON.stringify({id:t[0].id,settings:t[0].getSettings(),constraints:t[0].getConstraints()},null,4)+"",x=t[2]&&Bt(t);return{c(){e=g("details"),n=g("summary"),r=h($),o=v(),x&&x.c(),i=h("\n            | "),c=h(b),a=h("\n            | "),l=h(y),s=v(),u=g("pre"),p=h(w)},m(t,m){f(t,e,m),d(e,n),d(n,r),d(n,o),x&&x.m(n,null),d(n,i),d(n,c),d(n,a),d(n,l),d(e,s),d(e,u),d(u,p)},p(t,e){1&e&&$!==($=t[0].constructor.name+"")&&k(r,$),t[2]?x?x.p(t,e):(x=Bt(t),x.c(),x.m(n,i)):x&&(x.d(1),x=null),1&e&&b!==(b=t[0].readyState+"")&&k(c,b),1&e&&y!==(y=t[0].muted?"muted":"unmuted")&&k(l,y),1&e&&w!==(w=JSON.stringify({id:t[0].id,settings:t[0].getSettings(),constraints:t[0].getConstraints()},null,4)+"")&&k(p,w)},d(t){t&&m(e),x&&x.d()}}}function Bt(t){let e,n,r,o;return{c(){e=h("| "),n=h(t[2]),r=h("x"),o=h(t[1])},m(t,i){f(t,e,i),f(t,n,i),f(t,r,i),f(t,o,i)},p(t,e){4&e&&k(n,t[2]),2&e&&k(o,t[1])},d(t){t&&m(e),t&&m(n),t&&m(r),t&&m(o)}}}function Jt(e){let n,r=e[0]&&It(e);return{c(){r&&r.c(),n=$()},m(t,e){r&&r.m(t,e),f(t,n,e)},p(t,[e]){t[0]?r?r.p(t,e):(r=It(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&m(n)}}}function Ft(t,e,n){let r,o,{track:i}=e;return t.$$set=t=>{"track"in t&&n(0,i=t.track)},t.$$.update=()=>{1&t.$$.dirty&&n(2,r=null==i?void 0:i.getSettings().width),1&t.$$.dirty&&n(1,o=null==i?void 0:i.getSettings().height)},[i,o,r]}const Pt=class extends tt{constructor(t){super(),Z(this,t,Ft,Jt,i,{track:0})}};function qt(t,e,n){const r=t.slice();return r[2]=e[n],r}function Ut(t){let e,n,r,o,i,c,a=t[0].constructor.name+"",l=t[1]?"active":"inactive",s=t[0].getTracks(),u=[];for(let e=0;e<s.length;e+=1)u[e]=Ht(qt(t,s,e));const d=t=>z(u[t],1,1,(()=>{u[t]=null}));return{c(){e=h(a),n=h("\n    ("),r=h(l),o=h(")\n    ");for(let t=0;t<u.length;t+=1)u[t].c();i=$()},m(t,a){f(t,e,a),f(t,n,a),f(t,r,a),f(t,o,a);for(let e=0;e<u.length;e+=1)u[e].m(t,a);f(t,i,a),c=!0},p(t,n){if((!c||1&n)&&a!==(a=t[0].constructor.name+"")&&k(e,a),(!c||2&n)&&l!==(l=t[1]?"active":"inactive")&&k(r,l),1&n){let e;for(s=t[0].getTracks(),e=0;e<s.length;e+=1){const r=qt(t,s,e);u[e]?(u[e].p(r,n),W(u[e],1)):(u[e]=Ht(r),u[e].c(),W(u[e],1),u[e].m(i.parentNode,i))}for(U(),e=s.length;e<u.length;e+=1)d(e);H()}},i(t){if(!c){for(let t=0;t<s.length;t+=1)W(u[t]);c=!0}},o(t){u=u.filter(Boolean);for(let t=0;t<u.length;t+=1)z(u[t]);c=!1},d(t){t&&m(e),t&&m(n),t&&m(r),t&&m(o),p(u,t),t&&m(i)}}}function Ht(t){let e,n;return e=new Pt({props:{track:t[2]}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.track=t[2]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Wt(t){let e,n,r=t[0]&&Ut(t);return{c(){r&&r.c(),e=$()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&W(r,1)):(r=Ut(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),H())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function zt(t,e,n){let{stream:r}=e,o=null==r?void 0:r.active;return T((()=>{const t=setInterval((()=>{n(1,o=null==r?void 0:r.active)}),500);return()=>clearInterval(t)})),t.$$set=t=>{"stream"in t&&n(0,r=t.stream)},[r,o]}const Vt=class extends tt{constructor(t){super(),Z(this,t,zt,Wt,i,{stream:0})}};function Gt(t,e,n){const r=t.slice();return r[25]=e[n],r}function Xt(t,e,n){const r=t.slice();return r[28]=e[n],r[30]=n,r}function Kt(t){let e,n,r,o,i,c=(t[28].label||`camera ${t[30]}`)+"";function a(){return t[13](t[28])}return{c(){e=g("button"),n=h(c),r=v(),y(e,"class","svelte-vk2oy1")},m(t,c){f(t,e,c),d(e,n),d(e,r),o||(i=b(e,"click",a),o=!0)},p(e,r){t=e,4&r&&c!==(c=(t[28].label||`camera ${t[30]}`)+"")&&k(n,c)},d(t){t&&m(e),o=!1,i()}}}function Qt(t){let e;return{c(){e=h("✔️")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}function Yt(t){let e;return{c(){e=h("(canvas)")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}function Zt(t){let e,n,o,i,c,a,l,s,u,p,$,w,x,C,S,T,E,R=t[25].name+"",N=t[4](t[25]),O=t[0]===t[25]&&Qt();function L(){return t[14](t[25])}function D(){return t[15](t[25])}function _(){return t[16](t[25])}let M=N&&Yt();return{c(){e=g("tr"),n=g("td"),O&&O.c(),o=v(),i=g("td"),c=g("button"),a=h(R),l=v(),s=g("td"),u=g("button"),u.textContent="stop",p=v(),$=g("td"),w=g("button"),w.textContent="X",x=v(),C=g("td"),M&&M.c(),S=v(),y(c,"class","svelte-vk2oy1"),y(u,"class","svelte-vk2oy1"),y(w,"class","svelte-vk2oy1")},m(t,r){f(t,e,r),d(e,n),O&&O.m(n,null),d(e,o),d(e,i),d(i,c),d(c,a),d(e,l),d(e,s),d(s,u),d(e,p),d(e,$),d($,w),d(e,x),d(e,C),M&&M.m(C,null),d(e,S),T||(E=[b(c,"click",L),b(u,"click",D),b(w,"click",_)],T=!0)},p(e,r){(t=e)[0]===t[25]?O||(O=Qt(),O.c(),O.m(n,null)):O&&(O.d(1),O=null),8&r&&R!==(R=t[25].name+"")&&k(a,R),8&r&&(N=t[4](t[25])),N?M||(M=Yt(),M.c(),M.m(C,null)):M&&(M.d(1),M=null)},d(t){t&&m(e),O&&O.d(),M&&M.d(),T=!1,r(E)}}}function te(t){let e,n,r,o;return r=new Vt({props:{stream:t[0]}}),{c(){e=g("h5"),e.textContent="current stream",n=v(),K(r.$$.fragment)},m(t,i){f(t,e,i),f(t,n,i),Q(r,t,i),o=!0},p(t,e){const n={};1&e&&(n.stream=t[0]),r.$set(n)},i(t){o||(W(r.$$.fragment,t),o=!0)},o(t){z(r.$$.fragment,t),o=!1},d(t){t&&m(e),t&&m(n),Y(r,t)}}}function ee(t){let e,n,o,i,c,a,l,s,u,h,k,w,x,C,S,T,E,R,N=t[2],O=[];for(let e=0;e<N.length;e+=1)O[e]=Kt(Xt(t,N,e));let L=t[3],D=[];for(let e=0;e<L.length;e+=1)D[e]=Zt(Gt(t,L,e));let _=t[0]&&te(t);return{c(){e=g("h5"),e.textContent="upstream",n=v(),o=g("video"),o.innerHTML='<track kind="captions"/>',i=v(),c=g("nav"),a=g("button"),a.textContent="default",l=v(),s=g("button"),s.textContent="noise",u=v(),h=g("br"),k=v();for(let t=0;t<O.length;t+=1)O[t].c();w=v(),x=g("table");for(let t=0;t<D.length;t+=1)D[t].c();C=v(),_&&_.c(),S=$(),y(o,"id","upstream"),o.autoplay="true",y(o,"class","svelte-vk2oy1"),y(a,"class","svelte-vk2oy1"),y(s,"class","svelte-vk2oy1"),y(c,"class","svelte-vk2oy1")},m(r,m){f(r,e,m),f(r,n,m),f(r,o,m),t[10](o),f(r,i,m),f(r,c,m),d(c,a),d(c,l),d(c,s),d(c,u),d(c,h),d(c,k);for(let t=0;t<O.length;t+=1)O[t].m(c,null);f(r,w,m),f(r,x,m);for(let t=0;t<D.length;t+=1)D[t].m(x,null);f(r,C,m),_&&_.m(r,m),f(r,S,m),T=!0,E||(R=[b(a,"click",t[11]),b(s,"click",t[12])],E=!0)},p(t,[e]){if(68&e){let n;for(N=t[2],n=0;n<N.length;n+=1){const r=Xt(t,N,n);O[n]?O[n].p(r,e):(O[n]=Kt(r),O[n].c(),O[n].m(c,null))}for(;n<O.length;n+=1)O[n].d(1);O.length=N.length}if(921&e){let n;for(L=t[3],n=0;n<L.length;n+=1){const r=Gt(t,L,n);D[n]?D[n].p(r,e):(D[n]=Zt(r),D[n].c(),D[n].m(x,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=L.length}t[0]?_?(_.p(t,e),1&e&&W(_,1)):(_=te(t),_.c(),W(_,1),_.m(S.parentNode,S)):_&&(U(),z(_,1,1,(()=>{_=null})),H())},i(t){T||(W(_),T=!0)},o(t){z(_),T=!1},d(a){a&&m(e),a&&m(n),a&&m(o),t[10](null),a&&m(i),a&&m(c),p(O,a),a&&m(w),a&&m(x),p(D,a),a&&m(C),_&&_.d(a),a&&m(S),E=!1,r(R)}}}function ne(t,e,n){let r,o,i;var c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{l(r.next(t))}catch(t){i(t)}}function a(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,a)}l((r=r.apply(t,e||[])).next())}))};const a=E();let l,s,u=[],d=[];function f(){return c(this,void 0,void 0,(function*(){const t=yield function(){let t=Object.assign(document.createElement("canvas"),{width:400,height:300}),e=t.getContext("2d");e.fillRect(0,0,t.width,t.height);let n=e.getImageData(0,0,t.width,t.height);return requestAnimationFrame((function t(){for(var r=0;r<n.data.length;r++)n.data[r++]=n.data[r++]=n.data[r++]=255*Math.random();e.putImageData(n,0,0),requestAnimationFrame(t)})),t.captureStream(60)}();t.name="noise feed",p(t),n(3,d=[...d,t])}))}function m(t){return c(this,void 0,void 0,(function*(){const e=yield function(t){return c(this,void 0,void 0,(function*(){const e={video:!t||{deviceId:t}};return yield navigator.mediaDevices.getUserMedia(e)}))}(t);e.name=t?function(t){const e=t&&u.find((({deviceId:e})=>e===t));return e&&e.label}(t):"default webcam",p(e),n(3,d=[...d,e])}))}function p(t){n(0,s=t),n(1,l.srcObject=t,l),a("stream",t)}function g(t){t.getTracks().forEach((t=>t.stop())),a("stop",t)}function h(t){g(t),n(3,d=[...d.filter((e=>e!=t))]),s===t&&n(0,s=void 0)}function v(){return c(this,void 0,void 0,(function*(){const t=yield navigator.mediaDevices.enumerateDevices();n(2,u=t.filter((({kind:t})=>"videoinput"===t)))}))}return T((()=>{v();const t=()=>v();return navigator.mediaDevices.addEventListener("devicechange",t),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}})),t.$$.update=()=>{1&t.$$.dirty&&(r=null==s?void 0:s.getTracks()[0]),1&t.$$.dirty&&(o=null==s?void 0:s.constructor.name),1&t.$$.dirty&&(i=null==s?void 0:s.getTracks()[0])},[s,l,u,d,t=>"CanvasCaptureMediaStream"===(null==t?void 0:t.constructor.name)||"CanvasCaptureMediaStreamTrack"===(null==t?void 0:t.getTracks()[0].constructor.name),f,m,p,g,h,function(t){N[t?"unshift":"push"]((()=>{l=t,n(1,l)}))},()=>m(),()=>f(),t=>m(t.deviceId),t=>p(t),t=>g(t),t=>h(t)]}const re=class extends tt{constructor(t){super(),Z(this,t,ne,ee,i,{})}};function oe(t){let e,n,r,o;return e=new jt({props:{summary:"settings",data:t[1].getSettings(),open:!1}}),r=new jt({props:{summary:"constraints",data:t[1].getConstraints(),open:!1}}),{c(){K(e.$$.fragment),n=v(),K(r.$$.fragment)},m(t,i){Q(e,t,i),f(t,n,i),Q(r,t,i),o=!0},p(t,n){const o={};2&n&&(o.data=t[1].getSettings()),e.$set(o);const i={};2&n&&(i.data=t[1].getConstraints()),r.$set(i)},i(t){o||(W(e.$$.fragment,t),W(r.$$.fragment,t),o=!0)},o(t){z(e.$$.fragment,t),z(r.$$.fragment,t),o=!1},d(t){Y(e,t),t&&m(n),Y(r,t)}}}function ie(t){let e,n,r,o,i,c,a,l=t[1]&&oe(t);return{c(){e=g("h5"),e.textContent="downstream",n=v(),r=g("video"),r.innerHTML='<track kind="captions"/>',i=v(),l&&l.c(),c=$(),r.autoplay=o=!0},m(o,s){f(o,e,s),f(o,n,s),f(o,r,s),t[3](r),f(o,i,s),l&&l.m(o,s),f(o,c,s),a=!0},p(t,[e]){t[1]?l?(l.p(t,e),2&e&&W(l,1)):(l=oe(t),l.c(),W(l,1),l.m(c.parentNode,c)):l&&(U(),z(l,1,1,(()=>{l=null})),H())},i(t){a||(W(l),a=!0)},o(t){z(l),a=!1},d(o){o&&m(e),o&&m(n),o&&m(r),t[3](null),o&&m(i),l&&l.d(o),o&&m(c)}}}function ce(t,e,n){let r,o,{stream:i}=e;return t.$$set=t=>{"stream"in t&&n(2,i=t.stream)},t.$$.update=()=>{4&t.$$.dirty&&n(1,r=i&&i.getTracks()[0]),5&t.$$.dirty&&o&&n(0,o.srcObject=i,o)},[o,r,i,function(t){N[t?"unshift":"push"]((()=>{o=t,n(0,o),n(2,i)}))}]}const ae=class extends tt{constructor(t){super(),Z(this,t,ce,ie,i,{stream:2})}};function le(e){let n,o,i,c,a,l,s;return{c(){n=g("form"),o=g("input"),i=v(),c=g("code"),a=h(e[0]),y(o,"size","90"),y(o,"placeholder","ws url")},m(t,r){var u;f(t,n,r),d(n,o),w(o,e[1]),f(t,i,r),f(t,c,r),d(c,a),l||(s=[b(o,"input",e[2]),b(n,"submit",(u=se,function(t){return t.preventDefault(),u.call(this,t)}))],l=!0)},p(t,[e]){2&e&&o.value!==t[1]&&w(o,t[1]),1&e&&k(a,t[0])},i:t,o:t,d(t){t&&m(n),t&&m(i),t&&m(c),l=!1,r(s)}}}function se(){}function ue(t,e,n){let r,{signalingClient:o}=e;return t.$$set=t=>{"signalingClient"in t&&n(0,o=t.signalingClient)},t.$$.update=()=>{3&t.$$.dirty&&(o.connect({url:r}),window.client=o)},n(1,r=`wss://${window.location.host}/signaling/test`),[o,r,function(){r=this.value,n(1,r)}]}const de=class extends tt{constructor(t){super(),Z(this,t,ue,le,i,{signalingClient:0})}};function fe(t){let e,n,r,o,i,c=t[0].state+"";return o=new jt({props:{summary:"iceTransport",open:!1,data:t[1]}}),{c(){e=h("state: "),n=h(c),r=v(),K(o.$$.fragment)},m(t,c){f(t,e,c),f(t,n,c),f(t,r,c),Q(o,t,c),i=!0},p(t,e){(!i||1&e)&&c!==(c=t[0].state+"")&&k(n,c);const r={};1&e&&(r.data=t[1]),o.$set(r)},i(t){i||(W(o.$$.fragment,t),i=!0)},o(t){z(o.$$.fragment,t),i=!1},d(t){t&&m(e),t&&m(n),t&&m(r),Y(o,t)}}}function me(t){let e,n,r=t[0]&&fe(t);return{c(){r&&r.c(),e=$()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&W(r,1)):(r=fe(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),H())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function pe(t,e,n){let{transport:r}=e;return t.$$set=t=>{"transport"in t&&n(0,r=t.transport)},[r,()=>({role:r.iceTransport.role,component:r.iceTransport.component,state:r.iceTransport.state,gatheringState:r.iceTransport.gatheringState})]}const ge=class extends tt{constructor(t){super(),Z(this,t,pe,me,i,{transport:0})}};function he(t){let e,n,r,o,i,c,a=t[0]&&ve(t);return{c(){e=g("details"),n=g("summary"),n.textContent="Receiver",r=v(),a&&a.c()},m(l,s){f(l,e,s),d(e,n),d(e,r),a&&a.m(e,null),e.open=t[0],o=!0,i||(c=b(e,"toggle",t[5]),i=!0)},p(t,n){t[0]?a?(a.p(t,n),1&n&&W(a,1)):(a=ve(t),a.c(),W(a,1),a.m(e,null)):a&&(U(),z(a,1,1,(()=>{a=null})),H()),1&n&&(e.open=t[0])},i(t){o||(W(a),o=!0)},o(t){z(a),o=!1},d(t){t&&m(e),a&&a.d(),i=!1,c()}}}function ve(t){let e,n,r,o,i,c,a,l,s,u,p,$,b,w,x,C,S,T,E,R,N,O,L,D,_,M,A,j,I,B,J,F,P,q=JSON.stringify(t[4])+"",U=JSON.stringify(t[3])+"";return c=new Pt({props:{track:t[1].track}}),$=new jt({props:{summary:"verbose",data:t[2],open:!1}}),T=new ge({props:{transport:t[1].transport}}),{c(){e=g("table"),n=g("tr"),r=g("th"),r.textContent="track",o=v(),i=g("td"),K(c.$$.fragment),a=v(),l=g("tr"),s=g("th"),s.textContent="parameters",u=v(),p=g("td"),K($.$$.fragment),b=v(),w=g("tr"),x=g("th"),x.textContent="transport",C=v(),S=g("td"),K(T.$$.fragment),E=v(),R=g("tr"),N=g("th"),N.textContent="ssrcs",O=v(),L=g("td"),D=g("code"),_=h(q),M=v(),A=g("tr"),j=g("th"),j.textContent="csrcs",I=v(),B=g("td"),J=g("code"),F=h(U),y(e,"class","vertical")},m(t,m){f(t,e,m),d(e,n),d(n,r),d(n,o),d(n,i),Q(c,i,null),d(e,a),d(e,l),d(l,s),d(l,u),d(l,p),Q($,p,null),d(e,b),d(e,w),d(w,x),d(w,C),d(w,S),Q(T,S,null),d(e,E),d(e,R),d(R,N),d(R,O),d(R,L),d(L,D),d(D,_),d(e,M),d(e,A),d(A,j),d(A,I),d(A,B),d(B,J),d(J,F),P=!0},p(t,e){const n={};2&e&&(n.track=t[1].track),c.$set(n);const r={};4&e&&(r.data=t[2]),$.$set(r);const o={};2&e&&(o.transport=t[1].transport),T.$set(o),(!P||16&e)&&q!==(q=JSON.stringify(t[4])+"")&&k(_,q),(!P||8&e)&&U!==(U=JSON.stringify(t[3])+"")&&k(F,U)},i(t){P||(W(c.$$.fragment,t),W($.$$.fragment,t),W(T.$$.fragment,t),P=!0)},o(t){z(c.$$.fragment,t),z($.$$.fragment,t),z(T.$$.fragment,t),P=!1},d(t){t&&m(e),Y(c),Y($),Y(T)}}}function $e(t){let e,n,r=t[1]&&he(t);return{c(){r&&r.c(),e=$()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&W(r,1)):(r=he(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),H())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function be(t,e,n){let r,o,i,{receiver:c}=e,{open:a=!1}=e;return T((()=>{const t=setInterval((()=>{var t;n(2,r=null===(t=null==c?void 0:c.getParameters)||void 0===t?void 0:t.call(c)),n(3,o=c.getContributingSources()),n(4,i=c.getSynchronizationSources())}),500);return()=>clearInterval(t)})),t.$$set=t=>{"receiver"in t&&n(1,c=t.receiver),"open"in t&&n(0,a=t.open)},[a,c,r,o,i,function(){a=this.open,n(0,a)}]}const ye=class extends tt{constructor(t){super(),Z(this,t,be,$e,i,{receiver:1,open:0})}};function ke(t){let e,n,r,o,i,c,a=t[0]&&we(t);return{c(){e=g("details"),n=g("summary"),n.textContent="Sender",r=v(),a&&a.c()},m(l,s){f(l,e,s),d(e,n),d(e,r),a&&a.m(e,null),e.open=t[0],o=!0,i||(c=b(e,"toggle",t[8]),i=!0)},p(t,n){t[0]?a?(a.p(t,n),1&n&&W(a,1)):(a=we(t),a.c(),W(a,1),a.m(e,null)):a&&(U(),z(a,1,1,(()=>{a=null})),H()),1&n&&(e.open=t[0])},i(t){o||(W(a),o=!0)},o(t){z(a),o=!1},d(t){t&&m(e),a&&a.d(),i=!1,c()}}}function we(t){let e,n,o,i,c,a,l,s,u,p,$,k,w,x,C,S,T,E,R,N,O,L,D,_,M,A,j,I;a=new Pt({props:{track:t[1].track}}),k=new jt({props:{summary:"verbose",data:t[4],open:!1}}),E=new ge({props:{transport:t[1].transport}});let B=t[4]&&xe(t);return{c(){e=g("table"),n=g("tr"),o=g("th"),o.textContent="track",i=v(),c=g("td"),K(a.$$.fragment),l=v(),s=g("tr"),u=g("th"),u.textContent="parameters",p=v(),$=g("td"),K(k.$$.fragment),w=v(),x=g("tr"),C=g("th"),C.textContent="transport",S=v(),T=g("td"),K(E.$$.fragment),R=v(),B&&B.c(),N=v(),O=g("button"),L=h("replaceTrack"),_=v(),M=g("button"),M.textContent="remove",y(e,"class","vertical"),y(O,"class","btn-small"),O.disabled=D=!Boolean(t[2]),y(M,"class","btn-small")},m(r,m){f(r,e,m),d(e,n),d(n,o),d(n,i),d(n,c),Q(a,c,null),d(e,l),d(e,s),d(s,u),d(s,p),d(s,$),Q(k,$,null),d(e,w),d(e,x),d(x,C),d(x,S),d(x,T),Q(E,T,null),d(e,R),B&&B.m(e,null),f(r,N,m),f(r,O,m),d(O,L),f(r,_,m),f(r,M,m),A=!0,j||(I=[b(O,"click",t[6]),b(M,"click",t[7])],j=!0)},p(t,n){const r={};2&n&&(r.track=t[1].track),a.$set(r);const o={};16&n&&(o.data=t[4]),k.$set(o);const i={};2&n&&(i.transport=t[1].transport),E.$set(i),t[4]?B?B.p(t,n):(B=xe(t),B.c(),B.m(e,null)):B&&(B.d(1),B=null),(!A||4&n&&D!==(D=!Boolean(t[2])))&&(O.disabled=D)},i(t){A||(W(a.$$.fragment,t),W(k.$$.fragment,t),W(E.$$.fragment,t),A=!0)},o(t){z(a.$$.fragment,t),z(k.$$.fragment,t),z(E.$$.fragment,t),A=!1},d(t){t&&m(e),Y(a),Y(k),Y(E),B&&B.d(),t&&m(N),t&&m(O),t&&m(_),t&&m(M),j=!1,r(I)}}}function xe(t){let e,n,r,o,i,c,a,l,s,u,p,$,b,y=JSON.stringify(t[4].rtcp)+"",w=JSON.stringify(t[4].encodings)+"";return{c(){e=g("tr"),n=g("th"),n.textContent="rtcp",r=v(),o=g("td"),i=g("code"),c=h(y),a=v(),l=g("tr"),s=g("th"),s.textContent="encodings",u=v(),p=g("td"),$=g("code"),b=h(w)},m(t,m){f(t,e,m),d(e,n),d(e,r),d(e,o),d(o,i),d(i,c),f(t,a,m),f(t,l,m),d(l,s),d(l,u),d(l,p),d(p,$),d($,b)},p(t,e){16&e&&y!==(y=JSON.stringify(t[4].rtcp)+"")&&k(c,y),16&e&&w!==(w=JSON.stringify(t[4].encodings)+"")&&k(b,w)},d(t){t&&m(e),t&&m(a),t&&m(l)}}}function Ce(t){let e,n,r=t[1]&&ke(t);return{c(){r&&r.c(),e=$()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&W(r,1)):(r=ke(t),r.c(),W(r,1),r.m(e.parentNode,e)):r&&(U(),z(r,1,1,(()=>{r=null})),H())},i(t){n||(W(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&m(e)}}}function Se(t,e,n){let r,{sender:o}=e,{open:i=!1}=e,{mediaStream:c}=e,{onRemove:a=(()=>console.warn("no callback"))}=e;function l(t,e){ut("rts","replace track per sender"),console.info("replace track",{sender:e}),e.replaceTrack(t.getTracks()[0])}return T((()=>{const t=setInterval((()=>{var t;n(4,r=null===(t=null==o?void 0:o.getParameters)||void 0===t?void 0:t.call(o))}),500);return()=>clearInterval(t)})),t.$$set=t=>{"sender"in t&&n(1,o=t.sender),"open"in t&&n(0,i=t.open),"mediaStream"in t&&n(2,c=t.mediaStream),"onRemove"in t&&n(3,a=t.onRemove)},[i,o,c,a,r,l,()=>l(c,o),()=>a(o),function(){i=this.open,n(0,i)}]}const Te=class extends tt{constructor(t){super(),Z(this,t,Se,Ce,i,{sender:1,open:0,mediaStream:2,onRemove:3})}},{Boolean:Ee}=V;function Re(t,e,n){const r=t.slice();return r[17]=e[n],r[18]=e,r[19]=n,r}function Ne(t,e,n){const r=t.slice();return r[20]=e[n],r}function Oe(t){let e,n,r=t[1],o=[];for(let e=0;e<r.length;e+=1)o[e]=Ae(Re(t,r,e));const i=t=>z(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=$()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);f(t,e,r),n=!0},p(t,n){if(59&n){let c;for(r=t[1],c=0;c<r.length;c+=1){const i=Re(t,r,c);o[c]?(o[c].p(i,n),W(o[c],1)):(o[c]=Ae(i),o[c].c(),W(o[c],1),o[c].m(e.parentNode,e))}for(U(),c=r.length;c<o.length;c+=1)i(c);H()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)W(o[t]);n=!0}},o(t){o=o.filter(Ee);for(let t=0;t<o.length;t+=1)z(o[t]);n=!1},d(t){p(o,t),t&&m(e)}}}function Le(t){let e,n,i,c,a,l,s,u,$,w,x,C,S,T,E,R,N,O,L,D,_,M,A,j,I,B,J,F,P,q,V,G,X,Z,tt,et,nt,rt,ot,it,ct,at=t[17].mid+"",lt=t[17].currentDirection+"",st=t[4].has(t[17]),ut=t[4].has(t[17]),dt=["sendrecv","sendonly","recvonly","inactive"],ft=[];for(let e=0;e<4;e+=1)ft[e]=De(Ne(t,dt,e));function mt(...e){return t[9](t[17],t[18],t[19],...e)}let pt=st&&_e(t);function gt(){return t[10](t[17])}j=new Te({props:{sender:t[17].sender}}),F=new ye({props:{receiver:t[17].receiver}});let ht=ut&&Me(t);function vt(){return t[12](t[17])}function $t(){return t[13](t[17])}return{c(){e=g("div"),n=g("table"),i=g("tr"),c=g("th"),c.textContent="mid",a=v(),l=g("td"),s=g("code"),u=h(at),$=v(),w=g("tr"),x=g("th"),x.textContent="direction",C=v(),S=g("td"),T=g("select");for(let t=0;t<4;t+=1)ft[t].c();E=v(),R=g("strong"),N=h("→ "),O=g("code"),L=h(lt),D=v(),pt&&pt.c(),_=v(),M=g("hr"),A=v(),K(j.$$.fragment),I=v(),B=g("hr"),J=v(),K(F.$$.fragment),P=v(),q=g("div"),V=g("button"),V.textContent="replaceTrack",G=v(),X=g("button"),X.textContent="replaceTrack(null)",Z=v(),ht&&ht.c(),tt=v(),et=g("button"),et.textContent="stop",nt=v(),rt=g("button"),rt.textContent="removeTrack",y(c,"class","svelte-5ps5s4"),y(x,"class","svelte-5ps5s4"),y(n,"class","vertical"),y(V,"class","btn-small"),y(X,"class","btn-small"),y(et,"class","btn-small"),y(rt,"class","btn-small")},m(r,m){f(r,e,m),d(e,n),d(n,i),d(i,c),d(i,a),d(i,l),d(l,s),d(s,u),d(n,$),d(n,w),d(w,x),d(w,C),d(w,S),d(S,T);for(let t=0;t<4;t+=1)ft[t].m(T,null);d(S,E),d(S,R),d(R,N),d(R,O),d(O,L),d(n,D),pt&&pt.m(n,null),d(e,_),d(e,M),d(e,A),Q(j,e,null),d(e,I),d(e,B),d(e,J),Q(F,e,null),f(r,P,m),f(r,q,m),d(q,V),d(q,G),d(q,X),d(q,Z),ht&&ht.m(q,null),d(q,tt),d(q,et),d(q,nt),d(q,rt),ot=!0,it||(ct=[b(T,"change",mt),b(V,"click",(function(){o(t[5](t[17].sender))&&t[5](t[17].sender).apply(this,arguments)})),b(X,"click",gt),b(et,"click",vt),b(rt,"click",$t)],it=!0)},p(e,r){if(t=e,(!ot||2&r)&&at!==(at=t[17].mid+"")&&k(u,at),2&r){let e;for(dt=["sendrecv","sendonly","recvonly","inactive"],e=0;e<4;e+=1){const n=Ne(t,dt,e);ft[e]?ft[e].p(n,r):(ft[e]=De(n),ft[e].c(),ft[e].m(T,null))}for(;e<4;e+=1)ft[e].d(1)}(!ot||2&r)&&lt!==(lt=t[17].currentDirection+"")&&k(L,lt),2&r&&(st=t[4].has(t[17])),st?pt?(pt.p(t,r),2&r&&W(pt,1)):(pt=_e(t),pt.c(),W(pt,1),pt.m(n,null)):pt&&(U(),z(pt,1,1,(()=>{pt=null})),H());const o={};2&r&&(o.sender=t[17].sender),j.$set(o);const i={};2&r&&(i.receiver=t[17].receiver),F.$set(i),2&r&&(ut=t[4].has(t[17])),ut?ht?ht.p(t,r):(ht=Me(t),ht.c(),ht.m(q,tt)):ht&&(ht.d(1),ht=null)},i(t){ot||(W(pt),W(j.$$.fragment,t),W(F.$$.fragment,t),ot=!0)},o(t){z(pt),z(j.$$.fragment,t),z(F.$$.fragment,t),ot=!1},d(t){t&&m(e),p(ft,t),pt&&pt.d(),Y(j),Y(F),t&&m(P),t&&m(q),ht&&ht.d(),it=!1,r(ct)}}}function De(t){let e,n,r,o;return{c(){e=g("option"),n=h(t[20]),e.__value=r=t[20],e.value=e.__value,e.selected=o=t[20]===t[17].currentDirection||"inactive"===t[20]&&null===t[17].currentDirection},m(t,r){f(t,e,r),d(e,n)},p(t,n){2&n&&o!==(o=t[20]===t[17].currentDirection||"inactive"===t[20]&&null===t[17].currentDirection)&&(e.selected=o)},d(t){t&&m(e)}}}function _e(t){let e,n,r,o,i,c;return i=new Pt({props:{track:t[4].get(t[17])}}),{c(){e=g("tr"),n=g("th"),n.textContent="track",r=v(),o=g("td"),K(i.$$.fragment),y(n,"class","svelte-5ps5s4")},m(t,a){f(t,e,a),d(e,n),d(e,r),d(e,o),Q(i,o,null),c=!0},p(t,e){const n={};2&e&&(n.track=t[4].get(t[17])),i.$set(n)},i(t){c||(W(i.$$.fragment,t),c=!0)},o(t){z(i.$$.fragment,t),c=!1},d(t){t&&m(e),Y(i)}}}function Me(t){let e,n,r;function o(){return t[11](t[17])}return{c(){e=g("button"),e.textContent="display track",y(e,"class","btn-small")},m(t,i){f(t,e,i),n||(r=b(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&m(e),n=!1,r()}}}function Ae(t){let e,n,r,o=(null!==t[17].mid||t[17].track,Le(t));return{c(){e=g("div"),o&&o.c(),n=v(),y(e,"class","grid box svelte-5ps5s4")},m(t,i){f(t,e,i),o&&o.m(e,null),d(e,n),r=!0},p(t,r){null!==t[17].mid||t[17].track,o?(o.p(t,r),2&r&&W(o,1)):(o=Le(t),o.c(),W(o,1),o.m(e,n))},i(t){r||(W(o),r=!0)},o(t){z(o),r=!1},d(t){t&&m(e),o&&o.d()}}}function je(t){let e,n,o,i,c,a,l,s,u,p,h,$=t[1]&&Oe(t);return{c(){e=g("details"),n=g("summary"),n.innerHTML="<h5>transceivers</h5>",o=v(),$&&$.c(),i=v(),c=g("button"),c.textContent="add video transceiver",a=v(),l=g("button"),l.textContent="update",y(l,"class","btn-small"),e.open=s=Boolean(t[2].showTransceivers)},m(r,s){f(r,e,s),d(e,n),d(e,o),$&&$.m(e,null),d(e,i),d(e,c),d(e,a),d(e,l),u=!0,p||(h=[b(c,"click",t[6]),b(l,"click",t[7])],p=!0)},p(t,[n]){t[1]?$?($.p(t,n),2&n&&W($,1)):($=Oe(t),$.c(),W($,1),$.m(e,i)):$&&(U(),z($,1,1,(()=>{$=null})),H()),(!u||4&n&&s!==(s=Boolean(t[2].showTransceivers)))&&(e.open=s)},i(t){u||(W($),u=!0)},o(t){z($),u=!1},d(t){t&&m(e),$&&$.d(),p=!1,r(h)}}}function Ie(t,e,n){let r,o;l(t,lt,(t=>n(2,o=t)));var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{l(r.next(t))}catch(t){i(t)}}function a(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,a)}l((r=r.apply(t,e||[])).next())}))};let{peerconnection:c}=e,{streamSource:a}=e;const s=E();let u;const d=new Map;function f(){n(1,u=c&&c.getTransceivers())}return T((()=>i(void 0,void 0,void 0,(function*(){const t=setInterval((()=>{r&&f()}),1e3);return yield(M(),D),c.addEventListener("track",(({track:t,transceiver:e,streams:n})=>{n[0]||new MediaStream([t]),d.set(e,t),f()})),()=>clearInterval(t)})))),t.$$set=t=>{"peerconnection"in t&&n(0,c=t.peerconnection),"streamSource"in t&&n(8,a=t.streamSource)},t.$$.update=()=>{1&t.$$.dirty&&(r=c&&c.getTransceivers())},[c,u,o,s,d,function(t){return()=>{const e=a().getTracks()[0];e&&t.replaceTrack(e)}},function(){c.addTransceiver("video"),r=c.getTransceivers(),f()},f,a,(t,e,r,{target:o})=>n(1,e[r].direction=o.value,u),t=>t.sender.replaceTrack(null),t=>s("track",d.get(t)),t=>t.stop(),t=>c.removeTrack(t.sender)]}const Be=class extends tt{constructor(t){super(),Z(this,t,Ie,je,i,{peerconnection:0,streamSource:8})}};function Je(t){let e,n,r,o,i,c,a,l,s,u,p,$,C,S,T,E,R,N,O,L=t[4].join(", ")+"";return{c(){e=g("textarea"),n=v(),r=g("div"),o=g("table"),i=g("tr"),c=g("th"),c.textContent="mlines",a=v(),l=g("td"),s=g("code"),u=h(t[5]),p=v(),$=g("tr"),C=g("th"),C.textContent="directions",S=v(),T=g("td"),E=g("code"),R=h(L),y(e,"rows",t[1]),y(e,"name",t[2]),y(e,"class","svelte-1n5wbpe"),x(e,"hideSignaling",t[3]),y(o,"class","vertical"),y(r,"class","box")},m(m,g){f(m,e,g),w(e,t[0]),f(m,n,g),f(m,r,g),d(r,o),d(o,i),d(i,c),d(i,a),d(i,l),d(l,s),d(s,u),d(o,p),d(o,$),d($,C),d($,S),d($,T),d(T,E),d(E,R),N||(O=b(e,"input",t[7]),N=!0)},p(t,n){2&n&&y(e,"rows",t[1]),4&n&&y(e,"name",t[2]),1&n&&w(e,t[0]),8&n&&x(e,"hideSignaling",t[3]),32&n&&k(u,t[5]),16&n&&L!==(L=t[4].join(", ")+"")&&k(R,L)},d(t){t&&m(e),t&&m(n),t&&m(r),N=!1,O()}}}function Fe(e){let n,r=!e[3]&&Je(e);return{c(){n=g("div"),r&&r.c()},m(t,e){f(t,n,e),r&&r.m(n,null)},p(t,[e]){t[3]?r&&(r.d(1),r=null):r?r.p(t,e):(r=Je(t),r.c(),r.m(n,null))},i:t,o:t,d(t){t&&m(n),r&&r.d()}}}function Pe(t,e,n){let r,o,i,{value:c}=e,{rows:a}=e,{name:l}=e,{hideSignaling:s}=e;return t.$$set=t=>{"value"in t&&n(0,c=t.value),"rows"in t&&n(1,a=t.rows),"name"in t&&n(2,l=t.name),"hideSignaling"in t&&n(3,s=t.hideSignaling)},t.$$.update=()=>{1&t.$$.dirty&&n(6,r=c.split("\n")),64&t.$$.dirty&&n(5,o=r.filter((t=>t.startsWith("m="))).length),64&t.$$.dirty&&n(4,i=Array.from(r.filter((t=>t.startsWith("a=sendrecv")||t.startsWith("a=sendonly")||t.startsWith("a=recvonly")||t.startsWith("a=inactive"))),(t=>null==t?void 0:t.slice(2))))},[c,a,l,s,i,o,r,function(){c=this.value,n(0,c)}]}const qe=class extends tt{constructor(t){super(),Z(this,t,Pe,Fe,i,{value:0,rows:1,name:2,hideSignaling:3})}},{Boolean:Ue}=V;function He(t,e,n){const r=t.slice();return r[85]=e[n],r}function We(t,e,n){const r=t.slice();return r[88]=e[n],r}function ze(e){let n,r;return n=new de({props:{signalingClient:e[29]}}),{c(){K(n.$$.fragment)},m(t,e){Q(n,t,e),r=!0},p:t,i(t){r||(W(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(t){Y(n,t)}}}function Ve(e){let n,r,o;return r=new re({}),r.$on("stream",e[49]),r.$on("stop",e[50]),{c(){n=g("article"),K(r.$$.fragment),y(n,"id","upstream"),y(n,"class","box")},m(t,e){f(t,n,e),Q(r,n,null),o=!0},p:t,i(t){o||(W(r.$$.fragment,t),o=!0)},o(t){z(r.$$.fragment,t),o=!1},d(t){t&&m(n),Y(r)}}}function Ge(t){let e,n,r;return n=new ae({props:{stream:void 0}}),t[51](n),{c(){e=g("article"),K(n.$$.fragment),y(e,"id","downstream"),y(e,"class","box")},m(t,o){f(t,e,o),Q(n,e,null),r=!0},p(t,e){n.$set({})},i(t){r||(W(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(r){r&&m(e),t[51](null),Y(n)}}}function Xe(t){let e,n;return e=new Te({props:{sender:t[88],open:!0,mediaStream:t[12],onRemove:t[52]}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};512&n[0]&&(r.sender=t[88]),4096&n[0]&&(r.mediaStream=t[12]),128&n[0]&&(r.onRemove=t[52]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ke(t){let e,n;return e=new ye({props:{receiver:t[85],open:!0}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};1024&n[0]&&(r.receiver=t[85]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Qe(t){let e,n,o,i,c,a,l,s,u,p,$,y,k;return{c(){e=g("button"),n=h("replaceTrack"),i=v(),c=g("button"),a=g("strike"),a.textContent="removeStream",s=v(),u=g("button"),p=h("removeTrack"),e.disabled=o=!Boolean(t[12]),c.disabled=l=!Boolean(t[12]),u.disabled=$=!Boolean(t[12])},m(r,o){f(r,e,o),d(e,n),f(r,i,o),f(r,c,o),d(c,a),f(r,s,o),f(r,u,o),d(u,p),y||(k=[b(e,"click",t[54]),b(c,"click",t[55]),b(u,"click",t[56])],y=!0)},p(t,n){4096&n[0]&&o!==(o=!Boolean(t[12]))&&(e.disabled=o),4096&n[0]&&l!==(l=!Boolean(t[12]))&&(c.disabled=l),4096&n[0]&&$!==($=!Boolean(t[12]))&&(u.disabled=$)},d(t){t&&m(e),t&&m(i),t&&m(c),t&&m(s),t&&m(u),y=!1,r(k)}}}function Ye(t){let e,n,r,o,i=t[12].name+"";return{c(){e=g("small"),n=g("code"),r=g("pre"),o=h(i)},m(t,i){f(t,e,i),d(e,n),d(n,r),d(r,o)},p(t,e){4096&e[0]&&i!==(i=t[12].name+"")&&k(o,i)},d(t){t&&m(e)}}}function Ze(t){let e,n,r,o,i,c,a,l=t[28].join(" ")+"";return{c(){e=g("tr"),n=g("th"),n.textContent="events:",r=v(),o=g("td"),i=g("code"),c=g("small"),a=h(l)},m(t,l){f(t,e,l),d(e,n),d(e,r),d(e,o),d(o,i),d(i,c),d(c,a)},p(t,e){268435456&e[0]&&l!==(l=t[28].join(" ")+"")&&k(a,l)},d(t){t&&m(e)}}}function tn(t){let e,n,r,o,i,c,a,l,s,u,p,y,k=t[25]&&en(t),w=t[17]&&nn(t),x=t[26]&&!t[5].isManual&&rn(t),C=t[5].isManual&&on(t);return{c(){k&&k.c(),e=v(),n=g("label"),r=h("1.\n                    "),o=g("button"),i=h("create offer"),c=v(),w&&w.c(),a=v(),x&&x.c(),l=v(),C&&C.c(),s=$(),o.disabled=t[25]},m(m,g){k&&k.m(m,g),f(m,e,g),f(m,n,g),d(n,r),d(n,o),d(o,i),f(m,c,g),w&&w.m(m,g),f(m,a,g),x&&x.m(m,g),f(m,l,g),C&&C.m(m,g),f(m,s,g),u=!0,p||(y=b(o,"click",t[37]),p=!0)},p(t,n){t[25]?k?k.p(t,n):(k=en(t),k.c(),k.m(e.parentNode,e)):k&&(k.d(1),k=null),(!u||33554432&n[0])&&(o.disabled=t[25]),t[17]?w?(w.p(t,n),131072&n[0]&&W(w,1)):(w=nn(t),w.c(),W(w,1),w.m(a.parentNode,a)):w&&(U(),z(w,1,1,(()=>{w=null})),H()),t[26]&&!t[5].isManual?x?(x.p(t,n),67108896&n[0]&&W(x,1)):(x=rn(t),x.c(),W(x,1),x.m(l.parentNode,l)):x&&(U(),z(x,1,1,(()=>{x=null})),H()),t[5].isManual?C?(C.p(t,n),32&n[0]&&W(C,1)):(C=on(t),C.c(),W(C,1),C.m(s.parentNode,s)):C&&(U(),z(C,1,1,(()=>{C=null})),H())},i(t){u||(W(w),W(x),W(C),u=!0)},o(t){z(w),z(x),z(C),u=!1},d(t){k&&k.d(t),t&&m(e),t&&m(n),t&&m(c),w&&w.d(t),t&&m(a),x&&x.d(t),t&&m(l),C&&C.d(t),t&&m(s),p=!1,y()}}}function en(e){let n,r,o,i,c;return{c(){n=g("label"),r=h("0.\n                        "),o=g("button"),o.textContent="start call"},m(t,a){f(t,n,a),d(n,r),d(n,o),i||(c=b(o,"click",e[36]),i=!0)},p:t,d(t){t&&m(n),i=!1,c()}}}function nn(t){let e,n,o,i,c,a,l,s,u,p,$,y,k,w,x,C;function S(e){t[63](e)}let T={hideSignaling:t[22],rows:20};return void 0!==t[17]&&(T.value=t[17]),n=new qe({props:T}),N.push((()=>X(n,"value",S))),{c(){e=g("div"),K(n.$$.fragment),i=v(),c=g("br"),a=v(),l=g("label"),s=h("2.\n                            "),u=g("button"),p=h("setLocalDescription"),$=v(),y=g("button"),k=h("send offer"),u.disabled=t[25],y.disabled=t[25]},m(r,o){f(r,e,o),Q(n,e,null),d(e,i),d(e,c),d(e,a),d(e,l),d(l,s),d(l,u),d(u,p),d(l,$),d(l,y),d(y,k),w=!0,x||(C=[b(u,"click",t[64]),b(y,"click",t[39])],x=!0)},p(t,e){const r={};4194304&e[0]&&(r.hideSignaling=t[22]),!o&&131072&e[0]&&(o=!0,r.value=t[17],j((()=>o=!1))),n.$set(r),(!w||33554432&e[0])&&(u.disabled=t[25]),(!w||33554432&e[0])&&(y.disabled=t[25])},i(t){w||(W(n.$$.fragment,t),w=!0)},o(t){z(n.$$.fragment,t),w=!1},d(t){t&&m(e),Y(n),x=!1,r(C)}}}function rn(t){let e,n,r,o,i,c,a,l,s,u,p,$,y;function k(e){t[65](e)}let w={hideSignaling:t[22],rows:20};return void 0!==t[26]&&(w.value=t[26]),n=new qe({props:w}),N.push((()=>X(n,"value",k))),{c(){e=g("div"),K(n.$$.fragment),o=v(),i=g("br"),c=v(),a=g("label"),l=h("5.\n                            "),s=g("button"),u=h("setRemoteDescription"),s.disabled=t[25]},m(r,m){f(r,e,m),Q(n,e,null),d(e,o),d(e,i),d(e,c),d(e,a),d(a,l),d(a,s),d(s,u),p=!0,$||(y=b(s,"click",t[66]),$=!0)},p(t,e){const o={};4194304&e[0]&&(o.hideSignaling=t[22]),!r&&67108864&e[0]&&(r=!0,o.value=t[26],j((()=>r=!1))),n.$set(o),(!p||33554432&e[0])&&(s.disabled=t[25])},i(t){p||(W(n.$$.fragment,t),p=!0)},o(t){z(n.$$.fragment,t),p=!1},d(t){t&&m(e),Y(n),$=!1,y()}}}function on(t){let e,n,r,o,i,c,a,l,s,u,p,$,y,k,w;function x(e){t[67](e)}let C={hideSignaling:t[22],rows:20};return void 0!==t[20]&&(C.value=t[20]),o=new qe({props:C}),N.push((()=>X(o,"value",x))),{c(){e=g("div"),n=g("strong"),n.textContent="MANUAL ANSWER HERE",r=v(),K(o.$$.fragment),c=v(),a=g("br"),l=v(),s=g("label"),u=h("5.\n                            "),p=g("button"),$=h("setRemoteDescription"),p.disabled=t[25]},m(i,m){f(i,e,m),d(e,n),d(e,r),Q(o,e,null),d(e,c),d(e,a),d(e,l),d(e,s),d(s,u),d(s,p),d(p,$),y=!0,k||(w=b(p,"click",t[68]),k=!0)},p(t,e){const n={};4194304&e[0]&&(n.hideSignaling=t[22]),!i&&1048576&e[0]&&(i=!0,n.value=t[20],j((()=>i=!1))),o.$set(n),(!y||33554432&e[0])&&(p.disabled=t[25])},i(t){y||(W(o.$$.fragment,t),y=!0)},o(t){z(o.$$.fragment,t),y=!1},d(t){t&&m(e),Y(o),k=!1,w()}}}function cn(t){let e,n,r,o,i=t[27]&&!t[5].isManual&&an(t),c=t[5].isManual&&ln(t),a=t[18]&&t[27]&&sn(t);return{c(){i&&i.c(),e=v(),c&&c.c(),n=v(),a&&a.c(),r=$()},m(t,l){i&&i.m(t,l),f(t,e,l),c&&c.m(t,l),f(t,n,l),a&&a.m(t,l),f(t,r,l),o=!0},p(t,o){t[27]&&!t[5].isManual?i?(i.p(t,o),134217760&o[0]&&W(i,1)):(i=an(t),i.c(),W(i,1),i.m(e.parentNode,e)):i&&(U(),z(i,1,1,(()=>{i=null})),H()),t[5].isManual?c?(c.p(t,o),32&o[0]&&W(c,1)):(c=ln(t),c.c(),W(c,1),c.m(n.parentNode,n)):c&&(U(),z(c,1,1,(()=>{c=null})),H()),t[18]&&t[27]?a?(a.p(t,o),134479872&o[0]&&W(a,1)):(a=sn(t),a.c(),W(a,1),a.m(r.parentNode,r)):a&&(U(),z(a,1,1,(()=>{a=null})),H())},i(t){o||(W(i),W(c),W(a),o=!0)},o(t){z(i),z(c),z(a),o=!1},d(t){i&&i.d(t),t&&m(e),c&&c.d(t),t&&m(n),a&&a.d(t),t&&m(r)}}}function an(t){let e,n,o,i,c,a,l,s,u,p,$,y,k,w,x,C;function S(e){t[69](e)}let T={hideSignaling:t[22],rows:20};return void 0!==t[27]&&(T.value=t[27]),n=new qe({props:T}),N.push((()=>X(n,"value",S))),{c(){e=g("div"),K(n.$$.fragment),i=v(),c=g("br"),a=v(),l=g("label"),s=h("3.\n                            "),u=g("button"),p=h("setRemoteDescription"),$=v(),y=g("button"),k=h("create answer"),u.disabled=t[25],y.disabled=t[25]},m(r,o){f(r,e,o),Q(n,e,null),d(e,i),d(e,c),d(e,a),d(e,l),d(l,s),d(l,u),d(u,p),d(l,$),d(l,y),d(y,k),w=!0,x||(C=[b(u,"click",t[70]),b(y,"click",t[38])],x=!0)},p(t,e){const r={};4194304&e[0]&&(r.hideSignaling=t[22]),!o&&134217728&e[0]&&(o=!0,r.value=t[27],j((()=>o=!1))),n.$set(r),(!w||33554432&e[0])&&(u.disabled=t[25]),(!w||33554432&e[0])&&(y.disabled=t[25])},i(t){w||(W(n.$$.fragment,t),w=!0)},o(t){z(n.$$.fragment,t),w=!1},d(t){t&&m(e),Y(n),x=!1,r(C)}}}function ln(t){let e,n,o,i,c,a,l,s,u,p,$,y,k,w,x,C,S,T;function E(e){t[71](e)}let R={hideSignaling:t[22],rows:20};return void 0!==t[19]&&(R.value=t[19]),i=new qe({props:R}),N.push((()=>X(i,"value",E))),{c(){e=g("div"),n=g("strong"),n.textContent="MANUAL OFFER HERE",o=v(),K(i.$$.fragment),a=v(),l=g("br"),s=v(),u=g("label"),p=h("3.\n                            "),$=g("button"),y=h("setRemoteDescription"),k=v(),w=g("button"),x=h("create answer"),$.disabled=t[25],w.disabled=t[25]},m(r,c){f(r,e,c),d(e,n),d(e,o),Q(i,e,null),d(e,a),d(e,l),d(e,s),d(e,u),d(u,p),d(u,$),d($,y),d(u,k),d(u,w),d(w,x),C=!0,S||(T=[b($,"click",t[72]),b(w,"click",t[38])],S=!0)},p(t,e){const n={};4194304&e[0]&&(n.hideSignaling=t[22]),!c&&524288&e[0]&&(c=!0,n.value=t[19],j((()=>c=!1))),i.$set(n),(!C||33554432&e[0])&&($.disabled=t[25]),(!C||33554432&e[0])&&(w.disabled=t[25])},i(t){C||(W(i.$$.fragment,t),C=!0)},o(t){z(i.$$.fragment,t),C=!1},d(t){t&&m(e),Y(i),S=!1,r(T)}}}function sn(t){let e,n,o,i,c,a,l,s,u,p,$,y,k,w,x,C;function S(e){t[73](e)}let T={hideSignaling:t[22],rows:20};return void 0!==t[18]&&(T.value=t[18]),n=new qe({props:T}),N.push((()=>X(n,"value",S))),{c(){e=g("div"),K(n.$$.fragment),i=v(),c=g("br"),a=v(),l=g("label"),s=h("4.\n                            "),u=g("button"),p=h("setLocalDescription"),$=v(),y=g("button"),k=h("send answer"),u.disabled=t[25],y.disabled=t[25]},m(r,o){f(r,e,o),Q(n,e,null),d(e,i),d(e,c),d(e,a),d(e,l),d(l,s),d(l,u),d(u,p),d(l,$),d(l,y),d(y,k),w=!0,x||(C=[b(u,"click",t[74]),b(y,"click",t[40])],x=!0)},p(t,e){const r={};4194304&e[0]&&(r.hideSignaling=t[22]),!o&&262144&e[0]&&(o=!0,r.value=t[18],j((()=>o=!1))),n.$set(r),(!w||33554432&e[0])&&(u.disabled=t[25]),(!w||33554432&e[0])&&(y.disabled=t[25])},i(t){w||(W(n.$$.fragment,t),w=!0)},o(t){z(n.$$.fragment,t),w=!1},d(t){t&&m(e),Y(n),x=!1,r(C)}}}function un(t){let e,n,r;return{c(){e=g("textarea"),y(e,"rows","10"),y(e,"class","svelte-5zgp1y"),x(e,"hideSignaling",t[22])},m(o,i){f(o,e,i),w(e,t[24]),n||(r=b(e,"input",t[75]),n=!0)},p(t,n){16777216&n[0]&&w(e,t[24]),4194304&n[0]&&x(e,"hideSignaling",t[22])},d(t){t&&m(e),n=!1,r()}}}function dn(t){let e,n,r,o,i,c,a,l,s=JSON.stringify(t[23],null,4)+"";return{c(){e=g("label"),e.textContent="injected Candidates",n=v(),r=g("textarea"),o=v(),i=g("pre"),c=h(s),y(e,"for","injectedCandidates"),y(r,"name","injectedCandidates"),y(r,"rows","20"),y(r,"class","svelte-5zgp1y")},m(s,u){f(s,e,u),f(s,n,u),f(s,r,u),w(r,t[4]),f(s,o,u),f(s,i,u),d(i,c),a||(l=b(r,"input",t[76]),a=!0)},p(t,e){16&e[0]&&w(r,t[4]),8388608&e[0]&&s!==(s=JSON.stringify(t[23],null,4)+"")&&k(c,s)},d(t){t&&m(e),t&&m(n),t&&m(r),t&&m(o),t&&m(i),a=!1,l()}}}function fn(t){let e,n,o,i,c,a,l,s,u,$,w,x,C,S,T,E,R,N,O,L,D,_,M,A,j,I,B,J,F,P,q,V,G,X,Z,tt,et,nt,rt,ot,it,ct,at,lt,st,ut,dt,ft,mt,pt,gt,ht,vt,$t,bt,yt,kt,wt,xt,Ct,St,Tt,Et,Rt,Nt,Ot,Lt,Dt,_t,Mt,At,jt,It,Bt,Jt,Ft,Pt,qt,Ut,Ht,Wt,zt,Vt,Gt,Xt,Kt,Qt,Yt=t[5].isRemote&&ze(t),Zt=t[5].hasUpstream&&Ve(t),te=t[5].hasDownstream&&Ge(t),ee="plan-b"===t[31].sdpSemantics&&function(t){let e;return{c(){e=g("span"),e.textContent="plan-b",y(e,"class","warning svelte-5zgp1y")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}(),ne=t[9],re=[];for(let e=0;e<ne.length;e+=1)re[e]=Xe(We(t,ne,e));const oe=t=>z(re[t],1,1,(()=>{re[t]=null}));let ie=t[10],ce=[];for(let e=0;e<ie.length;e+=1)ce[e]=Ke(He(t,ie,e));const ae=t=>z(ce[t],1,1,(()=>{ce[t]=null}));let le=t[8]&&Qe(t),se=t[12]&&t[12].name&&Ye(t),ue="unified-plan"===t[30]&&function(t){let e,n;return e=new Be({props:{peerconnection:t[7],streamSource:t[58]}}),e.$on("track",t[59]),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};128&n[0]&&(r.peerconnection=t[7]),4096&n[0]&&(r.streamSource=t[58]),e.$set(r)},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}(t),de=!t[21]&&Ze(t),fe=t[0]&&tn(t),me=t[1]&&cn(t),pe=(t[24].length||t[5].isManual)&&un(t),ge=t[5].isManual&&dn(t);return{c(){e=g("section"),n=g("h3"),o=h(t[2]),i=v(),c=g("small"),a=h("talking to "),l=h(t[3]),s=v(),Yt&&Yt.c(),u=v(),Zt&&Zt.c(),$=v(),te&&te.c(),w=v(),x=g("article"),C=g("details"),S=g("summary"),T=g("h4"),E=g("abbr"),R=h("peerconnection"),O=v(),ee&&ee.c(),L=v();for(let t=0;t<re.length;t+=1)re[t].c();D=v();for(let t=0;t<ce.length;t+=1)ce[t].c();M=v(),A=g("button"),j=h("addTrack"),B=v(),le&&le.c(),J=v(),F=g("button"),F.textContent="close",P=v(),se&&se.c(),q=v(),ue&&ue.c(),V=v(),G=g("article"),X=g("details"),Z=g("summary"),Z.innerHTML="<h4>signaling</h4>",tt=v(),et=g("div"),nt=g("table"),rt=g("tr"),ot=g("th"),ot.textContent="signaling:",it=v(),ct=g("td"),at=g("code"),lt=h(t[13]),st=v(),ut=g("tr"),dt=g("th"),dt.textContent="connection:",ft=v(),mt=g("td"),pt=g("code"),gt=h(t[14]),ht=v(),vt=g("tr"),$t=g("th"),$t.textContent="iceGathering:",bt=v(),yt=g("td"),kt=g("code"),wt=h(t[16]),xt=v(),Ct=g("tr"),St=g("th"),St.textContent="iceConnection:",Tt=v(),Et=g("td"),Rt=g("code"),Nt=h(t[15]),Ot=v(),de&&de.c(),Lt=v(),Dt=g("div"),_t=g("span"),Mt=g("label"),At=g("input"),jt=h("\n                        caller"),It=v(),Bt=g("label"),Jt=g("input"),Ft=h("\n                        receiver"),Pt=v(),qt=g("label"),Ut=g("input"),Ht=h("\n                        auto"),Wt=v(),fe&&fe.c(),zt=v(),me&&me.c(),Vt=v(),pe&&pe.c(),Gt=v(),ge&&ge.c(),y(E,"title",N=JSON.stringify(t[11],null,4)),C.open=_="plan-b"==t[30],A.disabled=I=!Boolean(t[12]),y(F,"class","btn-small"),y(x,"class","box"),y(nt,"class","vertical"),y(et,"class","box"),y(At,"type","checkbox"),y(Jt,"type","checkbox"),y(Ut,"type","checkbox"),y(Dt,"class","box"),X.open="true",y(G,"class","box")},m(r,m){f(r,e,m),d(e,n),d(n,o),d(n,i),d(n,c),d(c,a),d(c,l),d(e,s),Yt&&Yt.m(e,null),d(e,u),Zt&&Zt.m(e,null),d(e,$),te&&te.m(e,null),d(e,w),d(e,x),d(x,C),d(C,S),d(S,T),d(T,E),d(E,R),d(S,O),ee&&ee.m(S,null),d(C,L);for(let t=0;t<re.length;t+=1)re[t].m(C,null);d(C,D);for(let t=0;t<ce.length;t+=1)ce[t].m(C,null);d(x,M),d(x,A),d(A,j),d(x,B),le&&le.m(x,null),d(x,J),d(x,F),d(x,P),se&&se.m(x,null),d(x,q),ue&&ue.m(x,null),d(e,V),d(e,G),d(G,X),d(X,Z),d(X,tt),d(X,et),d(et,nt),d(nt,rt),d(rt,ot),d(rt,it),d(rt,ct),d(ct,at),d(at,lt),d(nt,st),d(nt,ut),d(ut,dt),d(ut,ft),d(ut,mt),d(mt,pt),d(pt,gt),d(nt,ht),d(nt,vt),d(vt,$t),d(vt,bt),d(vt,yt),d(yt,kt),d(kt,wt),d(nt,xt),d(nt,Ct),d(Ct,St),d(Ct,Tt),d(Ct,Et),d(Et,Rt),d(Rt,Nt),d(nt,Ot),de&&de.m(nt,null),d(X,Lt),d(X,Dt),d(Dt,_t),d(_t,Mt),d(Mt,At),At.checked=t[0],d(Mt,jt),d(_t,It),d(_t,Bt),d(Bt,Jt),Jt.checked=t[1],d(Bt,Ft),d(_t,Pt),d(_t,qt),d(qt,Ut),Ut.checked=t[25],d(qt,Ht),d(X,Wt),fe&&fe.m(X,null),d(X,zt),me&&me.m(X,null),d(X,Vt),pe&&pe.m(X,null),d(X,Gt),ge&&ge.m(X,null),Xt=!0,Kt||(Qt=[b(A,"click",t[53]),b(F,"click",t[57]),b(At,"change",t[60]),b(Jt,"change",t[61]),b(Ut,"change",t[62])],Kt=!0)},p(t,n){if((!Xt||4&n[0])&&k(o,t[2]),(!Xt||8&n[0])&&k(l,t[3]),t[5].isRemote?Yt?(Yt.p(t,n),32&n[0]&&W(Yt,1)):(Yt=ze(t),Yt.c(),W(Yt,1),Yt.m(e,u)):Yt&&(U(),z(Yt,1,1,(()=>{Yt=null})),H()),t[5].hasUpstream?Zt?(Zt.p(t,n),32&n[0]&&W(Zt,1)):(Zt=Ve(t),Zt.c(),W(Zt,1),Zt.m(e,$)):Zt&&(U(),z(Zt,1,1,(()=>{Zt=null})),H()),t[5].hasDownstream?te?(te.p(t,n),32&n[0]&&W(te,1)):(te=Ge(t),te.c(),W(te,1),te.m(e,w)):te&&(U(),z(te,1,1,(()=>{te=null})),H()),(!Xt||2048&n[0]&&N!==(N=JSON.stringify(t[11],null,4)))&&y(E,"title",N),4736&n[0]){let e;for(ne=t[9],e=0;e<ne.length;e+=1){const r=We(t,ne,e);re[e]?(re[e].p(r,n),W(re[e],1)):(re[e]=Xe(r),re[e].c(),W(re[e],1),re[e].m(C,D))}for(U(),e=ne.length;e<re.length;e+=1)oe(e);H()}if(1024&n[0]){let e;for(ie=t[10],e=0;e<ie.length;e+=1){const r=He(t,ie,e);ce[e]?(ce[e].p(r,n),W(ce[e],1)):(ce[e]=Ke(r),ce[e].c(),W(ce[e],1),ce[e].m(C,null))}for(U(),e=ie.length;e<ce.length;e+=1)ae(e);H()}(!Xt||4096&n[0]&&I!==(I=!Boolean(t[12])))&&(A.disabled=I),t[8]?le?le.p(t,n):(le=Qe(t),le.c(),le.m(x,J)):le&&(le.d(1),le=null),t[12]&&t[12].name?se?se.p(t,n):(se=Ye(t),se.c(),se.m(x,q)):se&&(se.d(1),se=null),"unified-plan"===t[30]&&ue.p(t,n),(!Xt||8192&n[0])&&k(lt,t[13]),(!Xt||16384&n[0])&&k(gt,t[14]),(!Xt||65536&n[0])&&k(wt,t[16]),(!Xt||32768&n[0])&&k(Nt,t[15]),t[21]?de&&(de.d(1),de=null):de?de.p(t,n):(de=Ze(t),de.c(),de.m(nt,null)),1&n[0]&&(At.checked=t[0]),2&n[0]&&(Jt.checked=t[1]),33554432&n[0]&&(Ut.checked=t[25]),t[0]?fe?(fe.p(t,n),1&n[0]&&W(fe,1)):(fe=tn(t),fe.c(),W(fe,1),fe.m(X,zt)):fe&&(U(),z(fe,1,1,(()=>{fe=null})),H()),t[1]?me?(me.p(t,n),2&n[0]&&W(me,1)):(me=cn(t),me.c(),W(me,1),me.m(X,Vt)):me&&(U(),z(me,1,1,(()=>{me=null})),H()),t[24].length||t[5].isManual?pe?pe.p(t,n):(pe=un(t),pe.c(),pe.m(X,Gt)):pe&&(pe.d(1),pe=null),t[5].isManual?ge?ge.p(t,n):(ge=dn(t),ge.c(),ge.m(X,null)):ge&&(ge.d(1),ge=null)},i(t){if(!Xt){W(Yt),W(Zt),W(te);for(let t=0;t<ne.length;t+=1)W(re[t]);for(let t=0;t<ie.length;t+=1)W(ce[t]);W(ue),W(fe),W(me),Xt=!0}},o(t){z(Yt),z(Zt),z(te),re=re.filter(Ue);for(let t=0;t<re.length;t+=1)z(re[t]);ce=ce.filter(Ue);for(let t=0;t<ce.length;t+=1)z(ce[t]);z(ue),z(fe),z(me),Xt=!1},d(t){t&&m(e),Yt&&Yt.d(),Zt&&Zt.d(),te&&te.d(),ee&&ee.d(),p(re,t),p(ce,t),le&&le.d(),se&&se.d(),ue&&ue.d(),de&&de.d(),fe&&fe.d(),me&&me.d(),pe&&pe.d(),ge&&ge.d(),Kt=!1,r(Qt)}}}function mn(t,e,n){let r,o,i,c,a,s,u,d,f,m,p,g,h;l(t,lt,(t=>n(5,f=t))),l(t,kt,(t=>n(78,m=t))),l(t,yt,(t=>n(46,p=t))),l(t,bt,(t=>n(47,g=t))),l(t,st,(t=>n(48,h=t)));var v,$=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{l(r.next(t))}catch(t){i(t)}}function a(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,a)}l((r=r.apply(t,e||[])).next())}))};let{isCaller:b=!1}=e,{isReceiver:y=!1}=e,{name:k="unnamed participant"}=e,{recipient:w=null}=e;const x=new Et({from:k,to:w}),C=dt(k);let S,E,R,O,L,D=[],_=[],M="",A="",j="",I="",B="";Tt.addEventListener(`OfferTo:${k}`,(({detail:t})=>$(void 0,void 0,void 0,(function*(){r&&(et(Rt(t)),yield Q(),tt(Ot(J)),Z())})))),Tt.addEventListener(`AnswerTo:${k}`,(({detail:t})=>$(void 0,void 0,void 0,(function*(){r&&rt(Rt(t))})))),Tt.addEventListener(`CandidateTo:${k}`,(({detail:t})=>$(void 0,void 0,void 0,(function*(){r&&(yield function(t){return $(this,void 0,void 0,(function*(){f.showCandidateEvents&&C("ac","addIceCandidate"),yield E.addIceCandidate(t)}))}(t))}))));let J="",F="",P="",q=[],U="";const H=null!==(v=new URL(document.location.toString()).searchParams.get("sdpSemantics"))&&void 0!==v?v:"unified-plan",W={sdpSemantics:H};function z(t){C("at","add track"),console.info("add track"),n(8,R=E.addTrack(t.getTracks()[0],t))}function V(t,e){C("rt","replace track"),console.info("replace track",{sender:e}),e.replaceTrack(t.getTracks()[0])}function G(){E.removeStream(L),n(8,R=void 0)}function X(){E.removeTrack(R),n(8,R=void 0)}function K(){return $(this,void 0,void 0,(function*(){C("o","create offer");const t=yield E.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!1});n(17,B=t.sdp)}))}function Q(){return $(this,void 0,void 0,(function*(){C("a","create answer");const t=yield E.createAnswer();n(18,J=t.sdp)}))}function Y(){const t=Nt(B);wt({from:k,offer:t}),f.isRemote&&x.sendOffer(t),Tt.dispatchEvent(new CustomEvent(`OfferTo:${w}`,{detail:t}))}function Z(){const t=Nt(J);xt({from:k,answer:t}),f.isRemote&&x.sendAnswer(t),Tt.dispatchEvent(new CustomEvent(`AnswerTo:${w}`,{detail:t}))}function tt(t){return $(this,void 0,void 0,(function*(){C("l","setLocalDescription"),console.debug("localDescription ->",t);const e=t;St({from:k}),E.setLocalDescription(e),nt(),St({from:w})}))}function et(t){C("r","setRemoteDescription");const e=Nt(t);E.setRemoteDescription(e),nt(),St({from:w})}function nt(){f.isManual?(s||[]).forEach((t=>{t&&f.showCandidateEvents&&(C("ac","addIceCandidate"),E.addIceCandidate(t))})):(console.debug(m[w]),(m[w]||[]).forEach((t=>{t&&f.showCandidateEvents&&(C("ac","addIceCandidate"),E.addIceCandidate(t))})))}function rt(t){C("r","setRemoteDescription");const e=Ot(t);E.setRemoteDescription(e),St({from:k})}function ot(t){if(t.stream)S.$set({stream:t.stream});else if(t.track){const e=new MediaStream([t.track]);S.$set({stream:e})}else console.error("can't use stream or track, nothing there",t)}return T((()=>{n(7,E=function(){const t=new RTCPeerConnection(W);return t.addEventListener("track",(t=>{C("pct","pc ontrack");const{track:e,streams:n,transceiver:r}=t,o=n[0]||new MediaStream([e]);console.info(`${k}.ontrack`,{track:e,streams:n,kind:e.kind,transceiver:r}),ot({stream:o,track:e}),e.addEventListener("ended",(()=>{C("te","track ended"),console.info(`${k} track ended`,{event:t})})),e.addEventListener("mute",(()=>{C("🔇","track muted"),console.info(`${k} track muted`,{event:t})})),e.addEventListener("unmute",(()=>{C("🔈","track unmuted"),console.info(`${k} track unmuted`,{event:t})})),o.addEventListener("addtrack",(()=>{C("add","stream track added")})),o.addEventListener("removetrack",(()=>{C("rem","stream track removed")}))})),t.addEventListener("icecandidate",(({candidate:t})=>{f.showCandidateEvents&&C("lc","create candidate"),n(45,q=[...q,t]),function(t){k&&t&&(Ct({from:k,candidate:t}),f.isRemote&&x.sendCandidate(t),Tt.dispatchEvent(new CustomEvent(`CandidateTo:${w}`,{detail:t})))}(t)})),t.addEventListener("signalingstatechange",(()=>n(13,M=t.signalingState))),t.addEventListener("connectionstatechange",(()=>n(14,A=t.connectionState))),t.addEventListener("iceconnectionstatechange",(()=>n(15,j=t.iceConnectionState))),t.addEventListener("icegatheringstatechange",(({target:{iceGatheringState:t}})=>n(16,I=t))),t.addEventListener("negotiationneeded",(()=>C("nn","negotiation needed"))),t.addEventListener("addstream",(t=>{C("as","addstream"),console.warn("addstream",t)})),t.addEventListener("removestream",(t=>{C("rs","removestream"),console.warn("removestream",t)})),console.info(`setup RTCPeerConnection for ${k}`,W,t),t}()),kt.subscribe((({[w]:t})=>{t&&f.showCandidateEvents&&C("rc")})),f.hasCaller&&K();const t=()=>{n(9,D=E.getSenders()),n(10,_=E.getReceivers()),n(11,O=E.getConfiguration())};t();const e=setInterval((()=>{t()}),500);return()=>clearInterval(e)})),t.$$set=t=>{"isCaller"in t&&n(0,b=t.isCaller),"isReceiver"in t&&n(1,y=t.isReceiver),"name"in t&&n(2,k=t.name),"recipient"in t&&n(3,w=t.recipient)},t.$$.update=()=>{32&t.$$.dirty[0]&&n(25,r=f.autoSignal),4&t.$$.dirty[0]|131072&t.$$.dirty[1]&&n(28,o=h[k]||[]),8&t.$$.dirty[0]|65536&t.$$.dirty[1]&&n(27,i=Rt(g[w])),8&t.$$.dirty[0]|32768&t.$$.dirty[1]&&n(26,c=Rt(p[w])),16384&t.$$.dirty[1]&&n(24,a=JSON.stringify(q)),16&t.$$.dirty[0]&&n(23,s=(t=>{try{return JSON.parse(t)}catch(e){return""!==t&&console.warn({parseError:e}),[]}})(U)),32&t.$$.dirty[0]&&n(22,u=f.hideSignaling),32&t.$$.dirty[0]&&n(21,d=f.hideEvents)},[b,y,k,w,U,f,S,E,R,D,_,O,L,M,A,j,I,B,J,F,P,d,u,s,a,r,c,i,o,x,H,W,z,V,G,X,function(){return $(this,void 0,void 0,(function*(){yield K(),tt(Nt(B)),Y()}))},K,Q,Y,Z,tt,et,rt,ot,q,p,g,h,({detail:t})=>n(12,L=t),()=>n(12,L=void 0),function(t){N[t?"unshift":"push"]((()=>{S=t,n(6,S)}))},t=>E.removeTrack(t),()=>z(L),()=>V(L,R),()=>G(),()=>X(),()=>E.close(),()=>L,({detail:t})=>ot({track:t}),function(){b=this.checked,n(0,b)},function(){y=this.checked,n(1,y)},function(){r=this.checked,n(25,r),n(5,f)},function(t){B=t,n(17,B)},()=>tt(Nt(B)),function(t){c=t,n(26,c),n(46,p),n(3,w)},()=>rt(c),function(t){P=t,n(20,P)},()=>rt(P),function(t){i=t,n(27,i),n(47,g),n(3,w)},()=>et(i),function(t){F=t,n(19,F)},()=>et(F),function(t){J=t,n(18,J)},()=>tt(Ot(J)),function(){a=this.value,n(24,a),n(45,q)},function(){U=this.value,n(4,U)}]}const pn=class extends tt{constructor(t){super(),Z(this,t,mn,fn,i,{isCaller:0,isReceiver:1,name:2,recipient:3},null,[-1,-1,-1])}};function gn(t,e,n){const r=t.slice();return r[6]=e[n].name,r[7]=e[n].event,r[8]=e[n].timestamp,r}function hn(t){let e,n,r,o,i,c,a,l,s,u,p,$,b,w=t[8]+"",x=t[6]+"",C=t[7]+"";return{c(){e=g("tr"),n=g("td"),r=g("code"),o=h(w),i=v(),c=g("th"),a=h(x),l=h(":"),s=v(),u=g("td"),p=g("code"),$=h(C),b=v(),y(r,"class","timestamp svelte-m6pkof")},m(t,m){f(t,e,m),d(e,n),d(n,r),d(r,o),d(e,i),d(e,c),d(c,a),d(c,l),d(e,s),d(e,u),d(u,p),d(p,$),d(e,b)},p(t,e){4&e&&w!==(w=t[8]+"")&&k(o,w),4&e&&x!==(x=t[6]+"")&&k(a,x),4&e&&C!==(C=t[7]+"")&&k($,C)},d(t){t&&m(e)}}}function vn(e){let n,r,o,i,c,a,l,s,u,h,$=e[2],k=[];for(let t=0;t<$.length;t+=1)k[t]=hn(gn(e,$,t));return{c(){n=g("section"),r=g("h3"),r.innerHTML="Event Log <small>please open\n            <code>about://webrtc-internals</code></small>",o=v(),i=g("div"),c=g("table");for(let t=0;t<k.length;t+=1)k[t].c();a=v(),l=g("label"),s=g("input"),y(c,"class","vertical svelte-m6pkof"),y(i,"class","box svelte-m6pkof"),y(s,"type","text"),y(s,"name","filterTerm"),y(s,"id","filterTerm"),y(s,"placeholder","filter"),y(s,"class","svelte-m6pkof"),y(l,"for","filterTerm"),y(n,"id","EventLog")},m(t,m){f(t,n,m),d(n,r),d(n,o),d(n,i),d(i,c);for(let t=0;t<k.length;t+=1)k[t].m(c,null);e[4](i),d(n,a),d(n,l),d(l,s),w(s,e[0]),u||(h=b(s,"input",e[5]),u=!0)},p(t,[e]){if(4&e){let n;for($=t[2],n=0;n<$.length;n+=1){const r=gn(t,$,n);k[n]?k[n].p(r,e):(k[n]=hn(r),k[n].c(),k[n].m(c,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=$.length}1&e&&s.value!==t[0]&&w(s,t[0])},i:t,o:t,d(t){t&&m(n),p(k,t),e[4](null),u=!1,h()}}}function $n(t,e,n){let r,o,i;l(t,ot,(t=>n(3,o=t)));let c="";return T((()=>{ot.subscribe((()=>{n(1,i.scrollTop=i.scrollHeight,i)}))})),t.$$.update=()=>{9&t.$$.dirty&&n(2,r=c&&c.length?o.filter((({event:t,short:e,name:n})=>(null==t?void 0:t.match(c))||(null==n?void 0:n.match(c))||(null==e?void 0:e.includes(c)))):o)},[c,i,r,o,function(t){N[t?"unshift":"push"]((()=>{i=t,n(1,i)}))},function(){c=this.value,n(0,c)}]}const bn=class extends tt{constructor(t){super(),Z(this,t,$n,vn,i,{})}};function yn(t){let e,n;return e=new pn({props:{name:"alice",isCaller:"true",recipient:"bob"}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function kn(t){let e,n;return e=new pn({props:{name:"bob",isReceiver:"true",recipient:"alice"}}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function wn(t){let e,n;return e=new bn({}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function xn(t){let e,n,r,o,i,c,a,l,s,u;i=new $t({});let p=t[0].hasCaller&&yn(),h=t[0].hasReceiver&&kn(),$=!t[0].hideEvents&&wn();return{c(){e=g("div"),n=g("h1"),n.textContent="WebRTC Demo",r=v(),o=g("aside"),K(i.$$.fragment),c=v(),a=g("main"),p&&p.c(),l=v(),h&&h.c(),s=v(),$&&$.c(),y(o,"class","svelte-if8jgd"),y(a,"class","svelte-if8jgd"),y(e,"class","svelte-if8jgd")},m(t,m){f(t,e,m),d(e,n),d(e,r),d(e,o),Q(i,o,null),d(e,c),d(e,a),p&&p.m(a,null),d(a,l),h&&h.m(a,null),d(a,s),$&&$.m(a,null),u=!0},p(t,[e]){t[0].hasCaller?p?1&e&&W(p,1):(p=yn(),p.c(),W(p,1),p.m(a,l)):p&&(U(),z(p,1,1,(()=>{p=null})),H()),t[0].hasReceiver?h?1&e&&W(h,1):(h=kn(),h.c(),W(h,1),h.m(a,s)):h&&(U(),z(h,1,1,(()=>{h=null})),H()),t[0].hideEvents?$&&(U(),z($,1,1,(()=>{$=null})),H()):$?1&e&&W($,1):($=wn(),$.c(),W($,1),$.m(a,null))},i(t){u||(W(i.$$.fragment,t),W(p),W(h),W($),u=!0)},o(t){z(i.$$.fragment,t),z(p),z(h),z($),u=!1},d(t){t&&m(e),Y(i),p&&p.d(),h&&h.d(),$&&$.d()}}}function Cn(t,e,n){let r;return l(t,lt,(t=>n(0,r=t))),[r]}const Sn=class extends tt{constructor(t){super(),Z(this,t,Cn,xn,i,{})}};function Tn(t,e,n){const r=t.slice();return r[33]=e[n],r}function En(t,e,n){const r=t.slice();return r[36]=e[n],r[38]=n,r}function Rn(t){let e,n,r,o,i=(t[36].label||`micorophone ${t[38]}`)+"";function c(){return t[13](t[36])}return{c(){e=g("button"),n=h(i),y(e,"class","svelte-2jsuhx")},m(t,i){f(t,e,i),d(e,n),r||(o=b(e,"click",c),r=!0)},p(e,r){t=e,4&r[0]&&i!==(i=(t[36].label||`micorophone ${t[38]}`)+"")&&k(n,i)},d(t){t&&m(e),r=!1,o()}}}function Nn(t){let e;return{c(){e=h("✔️")},m(t,n){f(t,e,n)},d(t){t&&m(e)}}}function On(t){let e,n,o,i,c,a,l,s,u,p,$,w,x,C,S,T=t[33].name+"",E=t[1]===t[33]&&Nn();function R(){return t[18](t[33])}function N(){return t[19](t[33])}function O(){return t[20](t[33])}return{c(){e=g("tr"),n=g("td"),E&&E.c(),o=v(),i=g("td"),c=g("button"),a=h(T),l=v(),s=g("td"),u=g("button"),u.textContent="stop",p=v(),$=g("td"),w=g("button"),w.textContent="X",x=v(),y(c,"class","svelte-2jsuhx"),y(u,"class","svelte-2jsuhx"),y(w,"class","svelte-2jsuhx")},m(t,r){f(t,e,r),d(e,n),E&&E.m(n,null),d(e,o),d(e,i),d(i,c),d(c,a),d(e,l),d(e,s),d(s,u),d(e,p),d(e,$),d($,w),d(e,x),C||(S=[b(c,"click",R),b(u,"click",N),b(w,"click",O)],C=!0)},p(e,r){(t=e)[1]===t[33]?E||(E=Nn(),E.c(),E.m(n,null)):E&&(E.d(1),E=null),8&r[0]&&T!==(T=t[33].name+"")&&k(a,T)},d(t){t&&m(e),E&&E.d(),C=!1,r(S)}}}function Ln(e){let n,o,i,c,a,l,s,u,h,$,k,w,x,C,S,T,E,R,N,O,L=e[2],D=[];for(let t=0;t<L.length;t+=1)D[t]=Rn(En(e,L,t));let _=e[3],M=[];for(let t=0;t<_.length;t+=1)M[t]=On(Tn(e,_,t));return{c(){n=g("h5"),n.textContent="audio devices",o=v(),i=g("canvas"),c=v(),a=g("nav");for(let t=0;t<D.length;t+=1)D[t].c();l=v(),s=g("audio"),u=g("track"),k=v(),w=g("button"),w.textContent="bars",x=v(),C=g("button"),C.textContent="waveform",S=v(),T=g("button"),T.textContent="volume",E=v(),R=g("table");for(let t=0;t<M.length;t+=1)M[t].c();y(u,"kind","captions"),y(s,"id","upstream"),s.autoplay=h=!1,s.controls=$=Boolean(e[1]),y(a,"class","svelte-2jsuhx"),y(w,"class","svelte-2jsuhx"),y(C,"class","svelte-2jsuhx"),y(T,"class","svelte-2jsuhx")},m(t,r){f(t,n,r),f(t,o,r),f(t,i,r),e[12](i),f(t,c,r),f(t,a,r);for(let t=0;t<D.length;t+=1)D[t].m(a,null);d(a,l),d(a,s),d(s,u),e[14](s),f(t,k,r),f(t,w,r),f(t,x,r),f(t,C,r),f(t,S,r),f(t,T,r),f(t,E,r),f(t,R,r);for(let t=0;t<M.length;t+=1)M[t].m(R,null);N||(O=[b(w,"click",e[15]),b(C,"click",e[16]),b(T,"click",e[17])],N=!0)},p(t,e){if(260&e[0]){let n;for(L=t[2],n=0;n<L.length;n+=1){const r=En(t,L,n);D[n]?D[n].p(r,e):(D[n]=Rn(r),D[n].c(),D[n].m(a,l))}for(;n<D.length;n+=1)D[n].d(1);D.length=L.length}if(2&e[0]&&$!==($=Boolean(t[1]))&&(s.controls=$),3594&e[0]){let n;for(_=t[3],n=0;n<_.length;n+=1){const r=Tn(t,_,n);M[n]?M[n].p(r,e):(M[n]=On(r),M[n].c(),M[n].m(R,null))}for(;n<M.length;n+=1)M[n].d(1);M.length=_.length}},i:t,o:t,d(t){t&&m(n),t&&m(o),t&&m(i),e[12](null),t&&m(c),t&&m(a),p(D,t),e[14](null),t&&m(k),t&&m(w),t&&m(x),t&&m(C),t&&m(S),t&&m(T),t&&m(E),t&&m(R),p(M,t),N=!1,r(O)}}}function Dn(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{l(r.next(t))}catch(t){i(t)}}function a(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,a)}l((r=r.apply(t,e||[])).next())}))};const o=E();let i,c,a,l,s,u,d,f=[],m=[];function p(){u&&u.stop(),u=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Uint8Array(r);let i;function c(){t.getByteTimeDomainData(o),n.fillStyle="rgb(0, 0, 0)",n.fillRect(0,0,e.width,e.height),n.lineWidth=2,n.strokeStyle="rgb(255, 255, 255)",n.beginPath();let a=1*e.width/r,l=0;for(let t=0;t<r;t++){const r=o[t]/128*e.height/2;0===t?n.moveTo(l,r):n.lineTo(l,r),l+=a}n.lineTo(e.width,e.height/2),n.stroke(),i=requestAnimationFrame(c)}return{start(){void 0===i&&c()},stop(){cancelAnimationFrame(i),i=void 0}}}({analyser:s,canvas:a}),u.start()}function g(){u&&u.stop(),u=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Float32Array(r);let i;const{width:c,height:a}=e;function l(){t.getFloatFrequencyData(o),n.fillStyle="rgb(0, 0, 0)",n.fillRect(0,0,c,a);for(var e,s=c/r*2.5,u=0,d=0;d<r;d++)e=2*(o[d]+140),n.fillStyle="rgb("+Math.floor(e+100)+",50,50)",n.fillRect(u,a-e/2,s,e/2),u+=s+1;i=requestAnimationFrame(l)}return{start(){void 0===i&&l()},stop(){cancelAnimationFrame(i),i=void 0}}}({analyser:s,canvas:a}),u.start()}function h(){u&&u.stop(),u=function({analyser:t,canvas:e}){console.log("creating renderer",{analyser:t,canvas:e});const n=e.getContext("2d"),r=t.frequencyBinCount,o=new Uint8Array(r);let i;function c(){t.getByteTimeDomainData(o),n.fillStyle="rgba(0, 0, 0, 0.1)",n.fillRect(0,0,e.width,e.height),n.font="15px sans-serif",n.strokeStyle="rgb(255, 255, 255)";let a=0;n.lineWidth=5;for(let t=0;t<r;t++){const n=o[t]/128*e.height/2;n>a&&(a=n)}let l=2*(a-75),s=e.height-l;n.beginPath(),n.moveTo(0,s),n.lineTo(e.width,s),n.stroke(),n.fillStyle="rgb(100,255,100)",n.fillRect(0,e.height,e.width,-e.height+s),n.fillStyle="rgb(0,0,0)",n.fillText(String(l),e.width-40,e.height-10),i=requestAnimationFrame(c)}return{start(){void 0===i&&c()},stop(){cancelAnimationFrame(i),i=void 0}}}({analyser:s,canvas:a}),u.start()}function v(){return r(this,void 0,void 0,(function*(){const t=yield navigator.mediaDevices.enumerateDevices();n(2,f=t.filter((({kind:t})=>"audioinput"===t)))}))}function $(t){return r(this,void 0,void 0,(function*(){const e=yield function(t){return r(this,void 0,void 0,(function*(){const e={audio:!t||{deviceId:t}};return yield navigator.mediaDevices.getUserMedia(e)}))}(t);e.name=function(t){const e=t&&f.find((({deviceId:e})=>e===t));return e&&e.label}(t),b(e),n(3,m=[...m,e])}))}function b(t){n(1,c=t),n(0,i.srcObject=t,i),function(t){console.debug("disconnecting",d),null==d||d.disconnect(s),d=void 0;const e=l.createMediaStreamSource(t);e.connect(s),d=e}(t),o("stream",t)}function y(t){t.getTracks().forEach((t=>t.stop())),o("stop",t)}function k(t){y(t),n(3,m=[...m.filter((e=>e!=t))]),c===t&&n(1,c=void 0)}return T((()=>{v();const t=()=>v();return navigator.mediaDevices.addEventListener("devicechange",t),l||(l=new AudioContext,s=l.createAnalyser(),s.fftSize=2048),h(),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}})),[i,c,f,m,a,p,g,h,$,b,y,k,function(t){N[t?"unshift":"push"]((()=>{a=t,n(4,a)}))},t=>$(t.deviceId),function(t){N[t?"unshift":"push"]((()=>{i=t,n(0,i)}))},()=>g(),()=>p(),()=>h(),t=>b(t),t=>y(t),t=>k(t)]}const _n=class extends tt{constructor(t){super(),Z(this,t,Dn,Ln,i,{},null,[-1,-1])}};function Mn(t){let e,n;return e=new Sn({}),{c(){K(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},i(t){n||(W(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function An(t){let e,n,r,o,i,c,a;return r=new _n({}),c=new re({}),{c(){e=g("section"),n=g("article"),K(r.$$.fragment),o=v(),i=g("article"),K(c.$$.fragment),y(n,"class","box"),y(i,"class","box")},m(t,l){f(t,e,l),d(e,n),Q(r,n,null),d(e,o),d(e,i),Q(c,i,null),a=!0},i(t){a||(W(r.$$.fragment,t),W(c.$$.fragment,t),a=!0)},o(t){z(r.$$.fragment,t),z(c.$$.fragment,t),a=!1},d(t){t&&m(e),Y(r),Y(c)}}}function jn(t){let e,n,r,o;const i=[An,Mn],c=[];function a(t,e){return t[0].audioVisOnly?0:1}return e=a(t),n=c[e]=i[e](t),{c(){n.c(),r=$()},m(t,n){c[e].m(t,n),f(t,r,n),o=!0},p(t,[o]){let l=e;e=a(t),e!==l&&(U(),z(c[l],1,1,(()=>{c[l]=null})),H(),n=c[e],n||(n=c[e]=i[e](t),n.c()),W(n,1),n.m(r.parentNode,r))},i(t){o||(W(n),o=!0)},o(t){z(n),o=!1},d(t){c[e].d(t),t&&m(r)}}}function In(t,e,n){let r;return l(t,lt,(t=>n(0,r=t))),[r]}const Bn=new class extends tt{constructor(t){super(),Z(this,t,In,jn,i,{})}}({target:document.body,props:{}});window.app=Bn})();